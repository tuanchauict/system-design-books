<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Distributed Cache System Design Interview Guide</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div><div class="flex flex-col gap-2 md:gap-4"><div class="flex flex-col"><h6 class="MuiTypography-root MuiTypography-h6 mui-zfm63x">Common Problems</h6><h1 class="MuiTypography-root MuiTypography-h2 mui-161snwm">Design a Distributed, In-Memory Cache</h1></div><div class="flex flex-col md:flex-row gap-2 md:items-center justify-between"><div class="flex flex-col lg:flex-row gap-4 md:items-center"><a target="_blank" rel="noopener noreferrer" class="flex flex-row gap-2 items-center" href="https://www.linkedin.com/in/evan-king-40072280/" style="text-decoration: none;"><img class="rounded-full" src="https://hellointerview-files.s3.us-west-2.amazonaws.com/public-media/evan-headshot.png" alt="Evan King" width="40" height="40"><div class="flex flex-col"><div class="flex flex-row gap-2 items-center"><p class="MuiTypography-root MuiTypography-body2 mui-ltrqv0">Evan King</p><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeInherit mui-70s7oy" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="LinkedInIcon"><path d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93h2.79M6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37h2.77z"></path></svg></div><span class="MuiTypography-root MuiTypography-caption mui-1eozzb8">Ex-Meta Staff Engineer</span></div></a><div class="flex flex-row gap-4 md:gap-8 items-center"><div class="flex flex-row gap-1 items-center" aria-label="Difficulty"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-5 h-5 text-gray-500"><path stroke-linecap="round" stroke-linejoin="round" d="M15.362 5.214A8.252 8.252 0 0 1 12 21 8.25 8.25 0 0 1 6.038 7.047 8.287 8.287 0 0 0 9 9.601a8.983 8.983 0 0 1 3.361-6.867 8.21 8.21 0 0 0 3 2.48Z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M12 18a3.75 3.75 0 0 0 .495-7.468 5.99 5.99 0 0 0-1.925 3.547 5.975 5.975 0 0 1-2.133-1.001A3.75 3.75 0 0 0 12 18Z"></path></svg><p class="MuiTypography-root MuiTypography-body2 mui-su24yt">medium</p></div><div class="flex flex-row gap-1 items-center" aria-label="Average time allowed in interview"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-5 h-5 text-gray-500"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"></path></svg><p class="MuiTypography-root MuiTypography-body2 mui-1pb8xyp">35 min</p></div></div></div><a class="MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-disableElevation MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-disableElevation mui-1c7cv5a" tabindex="0" href="/practice/system-design/start/distributed-cache" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-5 h-5 mr-1"><path stroke-linecap="round" stroke-linejoin="round" d="M15.042 21.672 13.684 16.6m0 0-2.51 2.225.569-9.47 5.227 7.917-3.286-.672ZM12 2.25V4.5m5.834.166-1.591 1.591M20.25 10.5H18M7.757 14.743l-1.59 1.59M6 10.5H3.75m4.007-4.243-1.59-1.59"></path></svg>Practice this problem<span class="MuiTouchRipple-root mui-w0pj6f"></span></a></div></div><hr class="MuiDivider-root MuiDivider-fullWidth mui-1rvhejo"></div>
<h2 class="MuiTypography-root MuiTypography-h3 mui-1rzqq5q" id="understanding-the-problem">Understanding the Problem</h2>
<div class="my-6"><div class="MuiBox-root mui-1fz7ihe"><div class="MuiBox-root mui-79elbk"><div style="overflow: hidden; max-height: 300px;"><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag"><strong>ðŸ’¾ What is a Distributed Cache?</strong>
A distributed cache is a system that stores data as key-value pairs in memory across multiple machines in a network. Unlike single-node caches that are limited by the resources of one machine, distributed caches scale horizontally across many nodes to handle massive workloads. The cache cluster works together to partition and replicate data, ensuring high availability and fault tolerance when individual nodes fail.</div></div></div></div></div>
<h3 class="MuiTypography-root MuiTypography-h4 mui-hkpafq" id="functional-requirements"><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover mui-pvpazu" href="https://www.hellointerview.com/learn/system-design/in-a-hurry/delivery#1-functional-requirements-1" target="_blank" rel="noopener noreferrer" style="color: rgb(99, 115, 129); cursor: pointer; font-weight: 600; text-decoration: underline;">Functional Requirements</a></h3>
<div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag"><strong>Core Requirements</strong></div>
<ol style="list-style: outside decimal;">
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">Users should be able to <span class="MuiBox-root mui-1vu004u">set</span>, <span class="MuiBox-root mui-1vu004u">get</span>, and <span class="MuiBox-root mui-1vu004u">delete</span> key-value pairs.</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">Users should be able to configure the expiration time for key-value pairs.</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">Data should be evicted according to Least Recently Used (LRU) policy.</div></li>
</ol>
<div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag"><strong>Below the line (out of scope)</strong></div>
<ul class="MuiList-root MuiList-padding mui-sedpvs">
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">Users should be able to configure the cache size.</div></li>
</ul>
<div class="my-6"><div class="MuiBox-root mui-1ygn9bx"><div class="MuiBox-root mui-14185gn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-6 h-6 heroicon-sw-2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"></path></svg></div><div class="MuiBox-root mui-79elbk"><div style="overflow: hidden; max-height: 300px;"><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">We opted for an LRU eviction policy, but you'll want to ask your interviewer what they're looking for if they weren't explicitly upfront. There are, of course, other eviction policies you could implement, like LFU, FIFO, and custom policies.</div></div></div></div></div>
<h3 class="MuiTypography-root MuiTypography-h4 mui-hkpafq" id="non-functional-requirements"><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover mui-pvpazu" href="https://www.hellointerview.com/learn/system-design/in-a-hurry/delivery#2-non-functional-requirements-1" target="_blank" rel="noopener noreferrer" style="color: rgb(99, 115, 129); cursor: pointer; font-weight: 600; text-decoration: underline;">Non-Functional Requirements</a></h3>
<div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">At this point in the interview, you should ask the interviewer what sort of scale we are expecting. This will have a big impact on your design, starting with how you define the non-functional requirements.</div>
<div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">If I were your interviewer, I would say we need to store up to 1TB of data and expect to handle a peak of up to 100k requests per second.</div>
<div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag"><strong>Core Requirements</strong></div>
<ol style="list-style: outside decimal;">
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">The system should be highly available. Eventual consistency is acceptable.</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">The system should support low latency operations (&lt; 10ms for get and set requests).</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">The system should be scalable to support the expected 1TB of data and 100k requests per second.</div></li>
</ol>
<div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag"><strong>Below the line (out of scope)</strong></div>
<ul class="MuiList-root MuiList-padding mui-sedpvs">
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">Durability (data persistence across restarts)</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">Strong consistency guarantees</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">Complex querying capabilities</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">Transaction support</div></li>
</ul>
<div class="my-6"><div class="MuiBox-root mui-1147lff"><div class="MuiBox-root mui-zvu67g"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-6 h-6 heroicon-sw-2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"></path></svg></div><div class="MuiBox-root mui-79elbk"><div style="overflow: hidden; max-height: 300px;"><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Note that I'm making quite a few strong assumptions about what we care about here. Make sure you're confirming this with your interviewer. Chances are you've used a cache before, so you know the plethora of potential trade-offs. Some interviewers might care about durability, for example, just ask.</div></div></div></div></div>
<div><h2 class="MuiTypography-root MuiTypography-h3 mui-1rzqq5q" id="the-set-up">The Set Up</h2><h3 class="MuiTypography-root MuiTypography-h4 mui-hkpafq" id="planning-the-approach">Planning the Approach</h3><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">For a problem like this, you need to show flexibility when choosing the right path through the <a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover mui-pvpazu" href="https://www.hellointerview.com/learn/system-design/in-a-hurry/delivery" target="_blank" rel="noopener noreferrer" style="color: rgb(99, 115, 129); cursor: pointer; font-weight: 600; text-decoration: underline;">Hello Interview Delivery Framework.</a> In fact, this is a famous question that is asked very differently by different interviewers at different companies. Some are looking for more low-level design, even code in some instances. Others are more focused on how the system should be architected and scaled.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">In this breakdown, we'll follow the most common path (and the one I take when I ask this question) where we balance low-level design with a high-level design that is scalable and handles the expected load.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">I'm going to opt for documenting the core entities and the API, but in an actual interview I would not spend a lot of time on these two sections, recognizing they're largely trivial. I'd either skip them, or rush through them to spend time on my high-level design and deep dives.</div><h3 class="MuiTypography-root MuiTypography-h4 mui-hkpafq" id="defining-the-core-entities"><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover mui-pvpazu" href="https://www.hellointerview.com/learn/system-design/in-a-hurry/delivery#core-entities-2-minutes" target="_blank" rel="noopener noreferrer" style="color: rgb(99, 115, 129); cursor: pointer; font-weight: 600; text-decoration: underline;">Defining the Core Entities</a></h3><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">The core entities are right there in front of our face! We're building a cache that stores key-value pairs, so our entities are <span class="MuiBox-root mui-1vu004u">keys</span> and <span class="MuiBox-root mui-1vu004u">values</span>.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">In other words, the data we need to persist (in memory) are the keys and their associated values.</div><h3 class="MuiTypography-root MuiTypography-h4 mui-hkpafq" id="the-api"><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover mui-pvpazu" href="https://www.hellointerview.com/learn/system-design/in-a-hurry/delivery#4-api-or-system-interface" target="_blank" rel="noopener noreferrer" style="color: rgb(99, 115, 129); cursor: pointer; font-weight: 600; text-decoration: underline;">The API</a></h3><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">According to our functional requirements, we have three key operations that we'll need to expose via an API: <span class="MuiBox-root mui-1vu004u">set</span>, <span class="MuiBox-root mui-1vu004u">get</span>, and <span class="MuiBox-root mui-1vu004u">delete</span>.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">These should each be rather straightforward, so we can breeze through this.</div><div class="my-6"><div class="MuiBox-root mui-1147lff"><div class="MuiBox-root mui-zvu67g"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-6 h-6 heroicon-sw-2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"></path></svg></div><div class="MuiBox-root mui-79elbk"><div style="overflow: hidden; max-height: 300px;"><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Identifying where to spend more and less time in a system design interview based on where the challenges are is an important skill to have. Spending time on simple, auxiliary, or otherwise less important parts of the system is a recipe for running out of time.</div></div></div></div></div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Setting a key-value pair:</div><pre><div class="MuiBox-root mui-xnilmx"><div class="MuiBox-root mui-v2ritd"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-4 h-4  cursor-pointer" aria-label="Copy"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"></path></svg></div><div style="background: rgb(250, 250, 250); color: rgb(56, 58, 66); font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0px; overflow: auto; border-radius: 0.375rem; border: none;"><code font-size="18" style="white-space: pre;"><span>POST /:key
</span>{
  "value": "..."
}</code></div></div></pre><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Getting a key-value pair:</div><pre><div class="MuiBox-root mui-xnilmx"><div class="MuiBox-root mui-v2ritd"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-4 h-4  cursor-pointer" aria-label="Copy"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"></path></svg></div><div style="background: rgb(250, 250, 250); color: rgb(56, 58, 66); font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0px; overflow: auto; border-radius: 0.375rem; border: none;"><code font-size="18" style="white-space: pre;"><span>GET /:key -&gt; {value: "..."}</span></code></div></div></pre><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Deleting a key-value pair:</div><pre><div class="MuiBox-root mui-xnilmx"><div class="MuiBox-root mui-v2ritd"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-4 h-4  cursor-pointer" aria-label="Copy"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"></path></svg></div><div style="background: rgb(250, 250, 250); color: rgb(56, 58, 66); font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0px; overflow: auto; border-radius: 0.375rem; border: none;"><code font-size="18" style="white-space: pre;"><span>DELETE /:key</span></code></div></div></pre><h2 class="MuiTypography-root MuiTypography-h3 mui-1rzqq5q" id="high-level-design"><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover mui-pvpazu" href="https://www.hellointerview.com/learn/system-design/in-a-hurry/delivery#high-level-design-10-15-minutes-1" target="_blank" rel="noopener noreferrer" style="color: rgb(99, 115, 129); cursor: pointer; font-weight: 600; text-decoration: underline;">High-Level Design</a></h2><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">We start by building an MVP that works to satisfy the core functional requirements. This doesn't need to scale or be perfect. It's just a foundation for us to build upon later. We will walk through each functional requirement, making sure each is satisfied by the high-level design.</div><h3 class="MuiTypography-root MuiTypography-h4 mui-hkpafq" id="1-users-should-be-able-to-set-get-and-delete-key-value-pairs">1) Users should be able to set, get, and delete key-value pairs</h3><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Let's start with the absolute basics. No fancy distributed systems yet - just a working cache that handles <span class="MuiBox-root mui-1vu004u">gets</span>, <span class="MuiBox-root mui-1vu004u">sets</span>, and <span class="MuiBox-root mui-1vu004u">deletes</span>.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">At its core, a cache is just a hash table. Every programming language has one: Python's dict, Java's HashMap, Go's map. They're perfect for this because they give us <span class="MuiBox-root mui-1vu004u">O(1)</span> lookups and inserts.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Your interviewer may ask you to sketch out some pseudocode. Here is what that might look like:</div><pre><div class="MuiBox-root mui-xnilmx"><div class="MuiBox-root mui-v2ritd"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-4 h-4  cursor-pointer" aria-label="Copy"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"></path></svg></div><div style="background: rgb(250, 250, 250); color: rgb(56, 58, 66); font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0px; overflow: auto; border-radius: 0.375rem; border: none;"><code font-size="18" style="white-space: pre;"><span class="token" style="color: rgb(166, 38, 164);">class</span><span> </span><span class="token" style="color: rgb(183, 107, 1);">Cache</span><span class="token" style="color: rgb(56, 58, 66);">:</span><span>
</span><span>    data </span><span class="token" style="color: rgb(64, 120, 242);">=</span><span> </span><span class="token" style="color: rgb(56, 58, 66);">{</span><span class="token" style="color: rgb(56, 58, 66);">}</span><span>  </span><span class="token" style="color: rgb(160, 161, 167); font-style: italic;"># Simple hash table</span><span>
</span>
<span>    get</span><span class="token" style="color: rgb(56, 58, 66);">(</span><span>key</span><span class="token" style="color: rgb(56, 58, 66);">)</span><span class="token" style="color: rgb(56, 58, 66);">:</span><span>
</span><span>        </span><span class="token" style="color: rgb(166, 38, 164);">return</span><span> self</span><span class="token" style="color: rgb(56, 58, 66);">.</span><span>data</span><span class="token" style="color: rgb(56, 58, 66);">[</span><span>key</span><span class="token" style="color: rgb(56, 58, 66);">]</span><span>
</span>
<span>    </span><span class="token" style="color: rgb(80, 161, 79);">set</span><span class="token" style="color: rgb(56, 58, 66);">(</span><span>key</span><span class="token" style="color: rgb(56, 58, 66);">,</span><span> value</span><span class="token" style="color: rgb(56, 58, 66);">)</span><span class="token" style="color: rgb(56, 58, 66);">:</span><span>
</span><span>        self</span><span class="token" style="color: rgb(56, 58, 66);">.</span><span>data</span><span class="token" style="color: rgb(56, 58, 66);">[</span><span>key</span><span class="token" style="color: rgb(56, 58, 66);">]</span><span> </span><span class="token" style="color: rgb(64, 120, 242);">=</span><span> value
</span>
<span>    delete</span><span class="token" style="color: rgb(56, 58, 66);">(</span><span>key</span><span class="token" style="color: rgb(56, 58, 66);">)</span><span class="token" style="color: rgb(56, 58, 66);">:</span><span>
</span><span>        delete self</span><span class="token" style="color: rgb(56, 58, 66);">.</span><span>data</span><span class="token" style="color: rgb(56, 58, 66);">[</span><span>key</span><span class="token" style="color: rgb(56, 58, 66);">]</span></code></div></div></pre><div class="my-6"><div class="MuiBox-root mui-o9fqh4"><div class="MuiBox-root mui-3t6lyr"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-6 h-6 heroicon-sw-2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"></path></svg></div><div class="MuiBox-root mui-79elbk"><div style="overflow: hidden; max-height: 300px;"><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">When asked to write pseudocode in a design interview, don't worry about the syntax. Just focus on the logic. You'll note that I don't handle corner cases like key not found or key already exists. No worries, that's not the point here.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">That said, as always, it's worth confirming this with your interviewer. "I'm going to write some pseudocode, is it ok that it's not syntactically correct or missing some details?"</div></div></div></div></div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">That's it. Three operations, all <span class="MuiBox-root mui-1vu004u">O(1)</span>. The hash table handles collision resolution and dynamic resizing for us.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">We can host this code on a single server. When a user makes a API request, we'll parse the request, and then call the appropriate method on our <span class="MuiBox-root mui-1vu004u">Cache</span> instance, returning the appropriate response.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag"><div class="MuiBox-root mui-10khgmf" style="cursor: pointer;"><div class="MuiGrid-root MuiGrid-container MuiGrid-direction-xs-column mui-1tdxmx0"><div class="MuiGrid-root MuiGrid-item mui-tolxbf"><div class="relative w-full"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeSmall mui-wksd04" tabindex="0" type="button" aria-label="zoom-in"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium mui-10dohqv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ZoomInIcon"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"></path><path d="M12 10h-2v2H9v-2H7V9h2V7h1v2h2z"></path></svg><span class="MuiTouchRipple-root mui-w0pj6f"></span></button><span class="w-full h-full"><span class="block"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 647.3947680713759 366.7446420883832">
  <!-- svg-source:excalidraw -->
  <!-- payload-type:application/vnd.excalidraw+json --><!-- payload-version:2 -->
  <defs>
    <style class="style-fonts">
      
      
      
    </style>
    
  </defs>
  <rect x="0" y="0" width="647.3947680713759" height="366.7446420883832" fill="#ffffff"></rect><g stroke-linecap="round" transform="translate(10 156.42134896485283) rotate(0 46.552734375 44.4140625)"><path d="M22.21 0 C41.37 1.52, 57.38 -1.47, 70.9 0 M22.21 0 C36.6 -0.1, 48.93 -0.27, 70.9 0 M70.9 0 C86.63 -1.47, 91.53 7.82, 93.11 22.21 M70.9 0 C87.24 0.42, 91.24 8.63, 93.11 22.21 M93.11 22.21 C94.18 32.56, 94.83 39.02, 93.11 66.62 M93.11 22.21 C94.04 30.94, 92.85 41.52, 93.11 66.62 M93.11 66.62 C92.24 81.99, 84.09 88.59, 70.9 88.83 M93.11 66.62 C95.17 79.65, 84.88 86.8, 70.9 88.83 M70.9 88.83 C52.55 87.69, 34.1 89.53, 22.21 88.83 M70.9 88.83 C57.27 88.24, 41.9 89.19, 22.21 88.83 M22.21 88.83 C7.32 90.12, -1.88 82.22, 0 66.62 M22.21 88.83 C5.9 90.87, 1.41 80.6, 0 66.62 M0 66.62 C0.46 50.69, 0.96 32.53, 0 22.21 M0 66.62 C0.3 53.01, -0.55 38.22, 0 22.21 M0 22.21 C0.32 5.84, 6.47 -1.83, 22.21 0 M0 22.21 C0.82 7.51, 8.47 1.48, 22.21 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(30.922760009765625 188.33541146485283) rotate(0 25.629974365234375 12.5)"><text x="25.629974365234375" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">client</text></g><g stroke-linecap="round"><g transform="translate(112.28125 201.37472259154066) rotate(0 93.26171875 -1.0391868133439175)"><path d="M0.12 -0.27 C31.31 -0.62, 156.36 -1.41, 187.46 -1.84 M-1.28 -1.46 C29.81 -2.22, 155.79 -3.76, 187.01 -3.84" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(112.28125 201.37472259154066) rotate(0 93.26171875 -1.0391868133439175)"><path d="M158.9 6.65 C167.63 4.75, 177.68 0.07, 187.01 -3.84 M158.9 6.65 C164.83 3.67, 171.3 2.03, 187.01 -3.84" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(112.28125 201.37472259154066) rotate(0 93.26171875 -1.0391868133439175)"><path d="M158.73 -13.87 C167.56 -9.05, 177.66 -7.02, 187.01 -3.84 M158.73 -13.87 C164.52 -12.02, 171.03 -8.84, 187.01 -3.84" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(133.51583375393386 145.52100743875866) rotate(0 73.05992889404297 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">get/set/delete</text></g><g stroke-linecap="round" transform="translate(328.2630192657616 54.44344670989864) rotate(0 154.56587440280714 151.1505976892423)"><path d="M32 0 C90.46 -1.7, 145.1 -0.19, 277.13 0 M32 0 C107.83 1.44, 184.37 0.98, 277.13 0 M277.13 0 C296.83 0.35, 308.37 11.87, 309.13 32 M277.13 0 C298.88 1.77, 307.69 12.22, 309.13 32 M309.13 32 C308.89 120.85, 309.36 213.35, 309.13 270.3 M309.13 32 C308.06 106.28, 307.91 179.16, 309.13 270.3 M309.13 270.3 C307.61 293.25, 296.92 304.27, 277.13 302.3 M309.13 270.3 C311.35 290.79, 296.83 302.25, 277.13 302.3 M277.13 302.3 C209.38 303.97, 140.31 303.15, 32 302.3 M277.13 302.3 C212.34 300.93, 146.04 301.16, 32 302.3 M32 302.3 C10.3 300.63, 0.65 290.9, 0 270.3 M32 302.3 C10.37 302.7, 1.87 290.49, 0 270.3 M0 270.3 C-2.55 175.93, -2.37 83.65, 0 32 M0 270.3 C-0.58 203.7, -1.04 137.39, 0 32 M0 32 C-1.13 9.15, 9.91 1.1, 32 0 M0 32 C0.39 11.75, 8.86 1.22, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(453.9758195334788 10) rotate(0 28.53997802734375 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Cache</text></g><g stroke-linecap="round" transform="translate(373.5184775641035 97.94138890406015) rotate(0 108.66760096562274 107.27918615046525)"><path d="M0 0 C81.94 -0.73, 162.5 -0.51, 217.34 0 M0 0 C80.54 -0.64, 161.07 0.03, 217.34 0 M217.34 0 C217.24 81.76, 217.95 164.28, 217.34 214.56 M217.34 0 C218.86 67.52, 218.55 134.07, 217.34 214.56 M217.34 214.56 C137 215.72, 54.31 216.63, 0 214.56 M217.34 214.56 C131.63 212.49, 45.79 212.85, 0 214.56 M0 214.56 C-0.97 160.17, -1.63 107.72, 0 0 M0 214.56 C-1.49 152.9, -0.87 91.43, 0 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(481.05517496312973 98.57658331717698) rotate(0 0 109.12682935888964)"><path d="M0 0 C-1.21 84.41, -0.86 168.62, 0 218.25 M0 0 C-0.78 74.54, -1.36 148.24, 0 218.25" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(372.21375390472826 149.73548469793977) rotate(0 110.51095231990445 0)"><path d="M0 0 C85.22 2.55, 172.24 2.41, 221.02 0 M0 0 C80.85 0.83, 162.11 1.85, 221.02 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(373.81032364580585 208.81880951292754) rotate(0 110.51095231990445 0)"><path d="M0 0 C76.78 0.46, 156.08 -2.03, 221.02 0 M0 0 C52.63 1, 104.8 1.28, 221.02 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(371.8532381567429 266.33821695109975) rotate(0 110.51095231990445 0)"><path d="M0 0 C85.01 -1.23, 172.24 -0.62, 221.02 0 M0 0 C53.91 0.56, 107.83 0.45, 221.02 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(441.4206819267026 66.72041824335511) rotate(0 40.47996520996094 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Hashmap</text></g><g transform="translate(404.8438552651071 112.86771976986051) rotate(0 18.999984741210938 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Key1</text></g><g transform="translate(505.0502860751084 114.46657809114754) rotate(0 28.389976501464844 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">value1</text></g><g transform="translate(405.45557686956954 168.3392822986379) rotate(0 23.40998077392578 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Key2</text></g><g transform="translate(502.6067690156442 168.83448035038623) rotate(0 32.79997253417969 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">value2</text></g><g transform="translate(406.8540524122757 224.2449758828717) rotate(0 23.09998321533203 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Key3</text></g><g transform="translate(409.50174611198827 278.59366079102205) rotate(0 22.689979553222656 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Key4</text></g><g transform="translate(504.492551445029 225.4244475679563) rotate(0 32.48997497558594 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">value3</text></g><g transform="translate(507.2511947247226 277.65399870166044) rotate(0 32.07997131347656 25)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">value4</text><text x="0" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge"></text></g></svg></span></span></div></div><div class="MuiGrid-root MuiGrid-item mui-1wxaqej"><span class="MuiTypography-root MuiTypography-caption mui-17cupi8">Simple Cache</span></div></div></div></div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Now, this isn't production-ready. It'll fall over if we try to handle real traffic or store too much data. But it's a solid foundation that meets our core functional requirement: storing and retrieving key-value pairs.</div><h3 class="MuiTypography-root MuiTypography-h4 mui-hkpafq" id="2-users-should-be-able-to-configure-the-expiration-time-for-key-value-pairs">2) Users should be able to configure the expiration time for key-value pairs</h3><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Let's add expiration functionality to our cache. We'll need to store a timestamp alongside each value and check it during reads. We'll also need a way to clean up expired entries.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">The pseudocode below shows how we can modify our cache to support TTLs (Time To Live). The key changes are:</div><ol style="list-style: outside decimal;">
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">Instead of storing just values, we now store tuples of (value, expiry_timestamp)</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">The <span class="MuiBox-root mui-1vu004u">get()</span> method checks if the entry has expired before returning it</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">The <span class="MuiBox-root mui-1vu004u">set()</span> method takes an optional TTL parameter and calculates the expiry timestamp</div></li>
</ol><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">This gives us the ability to automatically expire cache entries after a specified time period, which is necessary for keeping the cache fresh and preventing stale data from being served.</div><pre><div class="MuiBox-root mui-xnilmx"><div class="MuiBox-root mui-v2ritd"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-4 h-4  cursor-pointer" aria-label="Copy"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"></path></svg></div><div style="background: rgb(250, 250, 250); color: rgb(56, 58, 66); font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0px; overflow: auto; border-radius: 0.375rem; border: none;"><code font-size="18" style="white-space: pre;"><span class="token" style="color: rgb(160, 161, 167); font-style: italic;"># Check the expiry time of the key on get</span><span>
</span><span>get</span><span class="token" style="color: rgb(56, 58, 66);">(</span><span>key</span><span class="token" style="color: rgb(56, 58, 66);">)</span><span class="token" style="color: rgb(56, 58, 66);">:</span><span>
</span><span>    </span><span class="token" style="color: rgb(56, 58, 66);">(</span><span>value</span><span class="token" style="color: rgb(56, 58, 66);">,</span><span> expiry</span><span class="token" style="color: rgb(56, 58, 66);">)</span><span> </span><span class="token" style="color: rgb(64, 120, 242);">=</span><span> data</span><span class="token" style="color: rgb(56, 58, 66);">[</span><span>key</span><span class="token" style="color: rgb(56, 58, 66);">]</span><span>
</span><span>    </span><span class="token" style="color: rgb(166, 38, 164);">if</span><span> expiry </span><span class="token" style="color: rgb(166, 38, 164);">and</span><span> currentTime</span><span class="token" style="color: rgb(56, 58, 66);">(</span><span class="token" style="color: rgb(56, 58, 66);">)</span><span> </span><span class="token" style="color: rgb(64, 120, 242);">&gt;</span><span> expiry</span><span class="token" style="color: rgb(56, 58, 66);">:</span><span>
</span><span>        </span><span class="token" style="color: rgb(160, 161, 167); font-style: italic;"># Key has expired, remove it</span><span>
</span><span>        delete data</span><span class="token" style="color: rgb(56, 58, 66);">[</span><span>key</span><span class="token" style="color: rgb(56, 58, 66);">]</span><span>
</span><span>        </span><span class="token" style="color: rgb(166, 38, 164);">return</span><span> null
</span>        
<span>    </span><span class="token" style="color: rgb(166, 38, 164);">return</span><span> value
</span>
<span></span><span class="token" style="color: rgb(160, 161, 167); font-style: italic;"># Set the expiry time of the key on set</span><span>
</span><span></span><span class="token" style="color: rgb(80, 161, 79);">set</span><span class="token" style="color: rgb(56, 58, 66);">(</span><span>key</span><span class="token" style="color: rgb(56, 58, 66);">,</span><span> value</span><span class="token" style="color: rgb(56, 58, 66);">,</span><span> ttl</span><span class="token" style="color: rgb(56, 58, 66);">)</span><span class="token" style="color: rgb(56, 58, 66);">:</span><span>
</span><span>    expiry </span><span class="token" style="color: rgb(64, 120, 242);">=</span><span> currentTime</span><span class="token" style="color: rgb(56, 58, 66);">(</span><span class="token" style="color: rgb(56, 58, 66);">)</span><span> </span><span class="token" style="color: rgb(64, 120, 242);">+</span><span> ttl </span><span class="token" style="color: rgb(166, 38, 164);">if</span><span> ttl </span><span class="token" style="color: rgb(166, 38, 164);">else</span><span> null
</span><span>    data</span><span class="token" style="color: rgb(56, 58, 66);">[</span><span>key</span><span class="token" style="color: rgb(56, 58, 66);">]</span><span> </span><span class="token" style="color: rgb(64, 120, 242);">=</span><span> </span><span class="token" style="color: rgb(56, 58, 66);">(</span><span>value</span><span class="token" style="color: rgb(56, 58, 66);">,</span><span> expiry</span><span class="token" style="color: rgb(56, 58, 66);">)</span></code></div></div></pre><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">This handles the basic TTL functionality, but there's a problem: expired keys only get cleaned up when they're accessed. This means our cache could fill up with expired entries that nobody is requesting anymore.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">To fix this, we need a background process (often called a "janitor") that periodically scans for and removes expired entries:</div><pre><div class="MuiBox-root mui-xnilmx"><div class="MuiBox-root mui-v2ritd"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-4 h-4  cursor-pointer" aria-label="Copy"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"></path></svg></div><div style="background: rgb(250, 250, 250); color: rgb(56, 58, 66); font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0px; overflow: auto; border-radius: 0.375rem; border: none;"><code font-size="18" style="white-space: pre;"><span>cleanup</span><span class="token" style="color: rgb(56, 58, 66);">(</span><span class="token" style="color: rgb(56, 58, 66);">)</span><span class="token" style="color: rgb(56, 58, 66);">:</span><span>    
</span><span>    </span><span class="token" style="color: rgb(160, 161, 167); font-style: italic;"># Find all expired keys and delete</span><span>
</span><span>    </span><span class="token" style="color: rgb(166, 38, 164);">for</span><span> key</span><span class="token" style="color: rgb(56, 58, 66);">,</span><span> value </span><span class="token" style="color: rgb(166, 38, 164);">in</span><span> data</span><span class="token" style="color: rgb(56, 58, 66);">:</span><span>
</span><span>        </span><span class="token" style="color: rgb(166, 38, 164);">if</span><span> value</span><span class="token" style="color: rgb(56, 58, 66);">.</span><span>expiry </span><span class="token" style="color: rgb(166, 38, 164);">and</span><span> current_time </span><span class="token" style="color: rgb(64, 120, 242);">&gt;</span><span> value</span><span class="token" style="color: rgb(56, 58, 66);">.</span><span>expiry</span><span class="token" style="color: rgb(56, 58, 66);">:</span><span>
</span><span>            delete data</span><span class="token" style="color: rgb(56, 58, 66);">[</span><span>key</span><span class="token" style="color: rgb(56, 58, 66);">]</span></code></div></div></pre><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag"><div class="MuiBox-root mui-10khgmf" style="cursor: pointer;"><div class="MuiGrid-root MuiGrid-container MuiGrid-direction-xs-column mui-1tdxmx0"><div class="MuiGrid-root MuiGrid-item mui-tolxbf"><div class="relative w-full"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeSmall mui-wksd04" tabindex="0" type="button" aria-label="zoom-in"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium mui-10dohqv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ZoomInIcon"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"></path><path d="M12 10h-2v2H9v-2H7V9h2V7h1v2h2z"></path></svg><span class="MuiTouchRipple-root mui-w0pj6f"></span></button><span class="w-full h-full"><span class="block"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 990.3382413846731 376.1424893525307">
  <!-- svg-source:excalidraw -->
  <!-- payload-type:application/vnd.excalidraw+json --><!-- payload-version:2 -->
  <defs>
    <style class="style-fonts">
      
      
      
    </style>
    
  </defs>
  <rect x="0" y="0" width="990.3382413846731" height="376.1424893525307" fill="#ffffff"></rect><g stroke-linecap="round" transform="translate(10 157.96001684376148) rotate(0 46.552734375 44.4140625)"><path d="M22.21 0 C34.75 0.71, 44.93 -1.65, 70.9 0 M22.21 0 C37.63 0.84, 51.28 -0.54, 70.9 0 M70.9 0 C84.55 -0.42, 91.19 6.56, 93.11 22.21 M70.9 0 C87.69 -1.68, 92.09 6.92, 93.11 22.21 M93.11 22.21 C93.56 31.68, 91.69 39.76, 93.11 66.62 M93.11 22.21 C91.91 39.71, 93.44 56.35, 93.11 66.62 M93.11 66.62 C93.53 80.13, 86.97 89.85, 70.9 88.83 M93.11 66.62 C94.27 82.39, 87.55 87.89, 70.9 88.83 M70.9 88.83 C53.32 87.63, 41.37 88.79, 22.21 88.83 M70.9 88.83 C53.89 89.89, 36.4 88.8, 22.21 88.83 M22.21 88.83 C8.28 88.17, -1.71 79.97, 0 66.62 M22.21 88.83 C8.8 88.15, 0.59 80.11, 0 66.62 M0 66.62 C1.82 50.35, 0.74 33.61, 0 22.21 M0 66.62 C-0.97 55.91, 0.49 42.76, 0 22.21 M0 22.21 C-1.33 6.23, 7.46 0.13, 22.21 0 M0 22.21 C-0.99 6.62, 9.67 -0.16, 22.21 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(34.3408203125 189.87407934376148) rotate(0 22.2119140625 12.5)"><text x="22.2119140625" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">client</text></g><g stroke-linecap="round"><g transform="translate(112.28125 203.251426840995) rotate(0 92.51891356707856 -0.485282177770614)"><path d="M-1.16 -0.04 C29.73 -0.14, 154.39 -1.38, 185.61 -1.41 M0.43 -1.11 C31.2 -0.97, 154.03 0.07, 184.97 -0.1" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(112.28125 203.251426840995) rotate(0 92.51891356707856 -0.485282177770614)"><path d="M156.75 10.09 C165.82 8.05, 174.22 5.77, 184.97 -0.1 M156.75 10.09 C166.48 6.36, 176.43 2.42, 184.97 -0.1" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(112.28125 203.251426840995) rotate(0 92.51891356707856 -0.485282177770614)"><path d="M156.8 -10.43 C165.71 -5.88, 174.1 -1.57, 184.97 -0.1 M156.8 -10.43 C166.55 -6.66, 176.48 -3.09, 184.97 -0.1" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(133.51583375393386 147.0596753176673) rotate(0 73.05992889404297 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">get/set/delete</text></g><g stroke-linecap="round" transform="translate(326.7774088999188 52.02305585899444) rotate(0 326.78041624237716 157.05971674676812)"><path d="M32 0 C237.67 -2.15, 441.72 -2.76, 621.56 0 M32 0 C196.85 0.7, 360.83 0.91, 621.56 0 M621.56 0 C641.04 0.93, 653.62 10.92, 653.56 32 M621.56 0 C643.2 -1.87, 652.57 12.41, 653.56 32 M653.56 32 C656.34 93.43, 656.26 153.27, 653.56 282.12 M653.56 32 C655.27 91.21, 655.51 149.39, 653.56 282.12 M653.56 282.12 C654.03 303.43, 642.21 312.29, 621.56 314.12 M653.56 282.12 C652.37 305.74, 643.04 315.33, 621.56 314.12 M621.56 314.12 C496.66 314.41, 370.16 314.88, 32 314.12 M621.56 314.12 C464.47 312.28, 307 312.17, 32 314.12 M32 314.12 C12.12 314.85, -1.47 305.44, 0 282.12 M32 314.12 C10.99 315.15, 0.09 302.57, 0 282.12 M0 282.12 C3.08 196.04, 0.57 106.57, 0 32 M0 282.12 C-0.41 221.5, 0.75 161.38, 0 32 M0 32 C-1.99 8.89, 11.48 0.05, 32 0 M0 32 C-1.18 8.78, 11.62 1.99, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(571.8961423222535 10) rotate(0 28.53997802734375 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Cache</text></g><g stroke-linecap="round" transform="translate(373.5184775641035 99.4800567829688) rotate(0 161.29302651203164 107.27918615046528)"><path d="M0 0 C102.51 -0.04, 205.02 2.49, 322.59 0 M0 0 C72.6 0.8, 146.52 0.56, 322.59 0 M322.59 0 C322.39 66.22, 322.31 132.84, 322.59 214.56 M322.59 0 C323.89 81.16, 324.26 163.9, 322.59 214.56 M322.59 214.56 C208.88 216.69, 96.28 215.89, 0 214.56 M322.59 214.56 C255.34 217.15, 187.4 217.01, 0 214.56 M0 214.56 C-2.03 147.24, -2.29 76.9, 0 0 M0 214.56 C-0.91 165.36, -0.5 117.48, 0 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(481.05517496312973 100.11525119608564) rotate(0 0 109.12682935888964)"><path d="M0 0 C-1.13 54.39, -1.67 105.01, 0 218.25 M0 0 C-1.73 60.97, -1.64 121.02, 0 218.25" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(372.03073898546427 151.28595999099446) rotate(0 148.07656383745842 -0.20534486759763126)"><path d="M0 0 C59.45 -2.63, 120.74 -3.43, 296.15 -0.41 M0 0 C102.7 -1.02, 204.88 0, 296.15 -0.41" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(373.81032364580585 210.3574773918362) rotate(0 156.3888532454897 0.003571215088641111)"><path d="M0 0 C120.52 -0.33, 242.3 1.04, 312.78 0.01 M0 0 C97.44 2.35, 195.07 2.32, 312.78 0.01" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(371.87109423218635 267.89474090545167) rotate(0 156.44780810469268 0.0035712150886695326)"><path d="M0 0 C80.68 2.11, 160.22 2.26, 312.9 0.01 M0 0 C68.07 -1.18, 136.29 -1.11, 312.9 0.01" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(441.4206819267026 68.2590861222638) rotate(0 40.47996520996094 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Hashmap</text></g><g transform="translate(404.8438552651071 114.40638764876917) rotate(0 18.999984741210938 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Key1</text></g><g transform="translate(504.9502920526261 115.89810951739656) rotate(0 85.96991729736328 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">value1, expireTime</text></g><g transform="translate(405.45557686956954 169.87795017754655) rotate(0 23.40998077392578 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Key2</text></g><g transform="translate(502.6067690156442 170.48742711213185) rotate(0 90.37991333007812 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">value2, expireTime</text></g><g transform="translate(406.8540524122757 225.78364376178035) rotate(0 23.09998321533203 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Key3</text></g><g transform="translate(409.50174611198827 280.1323286699307) rotate(0 22.689979553222656 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Key4</text></g><g transform="translate(504.492551445029 226.96311544686495) rotate(0 32.48997497558594 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">value3</text></g><g transform="translate(507.2511947247226 279.1926665805691) rotate(0 89.659912109375 25)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">value4, expireTime</text><text x="0" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge"></text></g><g stroke-linecap="round" transform="translate(753.9592046103322 102.23117159352415) rotate(0 98.08664746376996 31.222357964583182)"><path d="M15.61 0 C62.37 -2.48, 111.55 0.41, 180.56 0 M15.61 0 C67.88 1.83, 118.31 0.52, 180.56 0 M180.56 0 C189.04 0.71, 195.69 3.87, 196.17 15.61 M180.56 0 C191.2 0.23, 194.57 3.51, 196.17 15.61 M196.17 15.61 C195.62 29.21, 195.59 37.48, 196.17 46.83 M196.17 15.61 C195.64 22.68, 197.08 31.48, 196.17 46.83 M196.17 46.83 C195.57 56.67, 191.21 62.32, 180.56 62.44 M196.17 46.83 C195 55.72, 189.21 62.93, 180.56 62.44 M180.56 62.44 C145.88 61.75, 114.05 62.35, 15.61 62.44 M180.56 62.44 C120.07 61.64, 57.17 62.32, 15.61 62.44 M15.61 62.44 C3.59 62.81, -1.31 57.93, 0 46.83 M15.61 62.44 C6.44 63.05, -0.61 57.37, 0 46.83 M0 46.83 C-0.21 38.64, -1.36 34.33, 0 15.61 M0 46.83 C-0.12 38.94, 0.64 32.78, 0 15.61 M0 15.61 C-0.2 5.67, 3.57 -0.74, 15.61 0 M0 15.61 C0.36 3.51, 4.42 0.54, 15.61 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(816.6858819813287 120.95352955810733) rotate(0 35.35997009277344 12.5)"><text x="35.35997009277344" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Janitor</text></g><g stroke-linecap="round"><g transform="translate(853.4939897059257 176.4983817990921) rotate(0 -70.28097812592733 36.01286332690228)"><path d="M0.6 1.14 C0.48 13.18, 21.92 60.14, -1.78 71.99 C-25.48 83.83, -118.4 72.09, -141.62 72.2 M-0.55 0.69 C-0.75 12.38, 20.3 57.91, -2.82 70.06 C-25.94 82.22, -116.23 73.55, -139.28 73.61" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(853.4939897059257 176.4983817990921) rotate(0 -70.28097812592733 36.01286332690228)"><path d="M-110.68 64.56 C-114.84 66.33, -122.14 66.75, -139.28 73.61 M-110.68 64.56 C-119.47 66.9, -129.3 70.06, -139.28 73.61" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(853.4939897059257 176.4983817990921) rotate(0 -70.28097812592733 36.01286332690228)"><path d="M-111.56 85.06 C-115.49 82.5, -122.6 78.6, -139.28 73.61 M-111.56 85.06 C-119.98 80.95, -129.54 77.66, -139.28 73.61" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(759.8103965952984 261.58360342203736) rotate(0 97.37992095947266 37.5)"><text x="97.37992095947266" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Run every n minutes</text><text x="97.37992095947266" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">to remove expired </text><text x="97.37992095947266" y="50" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">key-value pairs.</text></g></svg></span></span></div></div><div class="MuiGrid-root MuiGrid-item mui-1wxaqej"><span class="MuiTypography-root MuiTypography-caption mui-17cupi8">Simple Cache with TTLs</span></div></div></div></div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">This cleanup process can run on a schedule (say every minute) or when memory pressure hits certain thresholds. The trade-off here is between CPU usage (checking entries) and memory efficiency (removing expired data promptly).</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Now we have TTL support, but we still need to handle memory constraints. That's where our next requirement comes in: LRU eviction.</div><h3 class="MuiTypography-root MuiTypography-h4 mui-hkpafq" id="3-data-should-be-evicted-according-to-lru-policy">3) Data should be evicted according to LRU policy</h3><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Now we need to handle what happens when our cache gets full. We'll use the Least Recently Used (LRU) policy, which removes the entries that haven't been accessed for the longest time.</div><div class="my-6"><div class="MuiBox-root mui-o9fqh4"><div class="MuiBox-root mui-3t6lyr"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-6 h-6 heroicon-sw-2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"></path></svg></div><div class="MuiBox-root mui-79elbk"><div style="overflow: hidden; max-height: 300px;"><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Make sure you've confirmed with your interviewer that you're implementing an LRU cache. They may have a different eviction policy in mind, or even ask that your implementation is configurable.</div></div></div></div></div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">We have a challenge: we need to find items quickly AND track which items were used least recently. If we just used a hash table, we could find items fast but wouldn't know their access order. If we just used a list, we could track order but would be slow to find items.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">The solution is to combine two data structures:</div><ol style="list-style: outside decimal;">
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">A hash table for <span class="MuiBox-root mui-1vu004u">O(1)</span> lookups - This gives us instant access to any item in the cache</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">A doubly linked list to track access order - This lets us maintain a perfect history of which items were used when</div></li>
</ol><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Together, these structures let us build an efficient LRU cache where both get and set operations take <span class="MuiBox-root mui-1vu004u">O(1)</span> time.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">When we add or access an item:</div><ol style="list-style: outside decimal;">
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">We create a Node object containing the key, value, and expiry time</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">We add an entry to our hash table mapping the key to this Node</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">We insert the Node at the front of our doubly-linked list (right after the dummy head)</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">If we're at capacity, we remove the least recently used item from both the hash table and the linked list</div></li>
</ol><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">The doubly-linked list maintains the exact order of access - the head of the list contains the most recently used items, and the tail contains the least recently used. When we need to evict an item, we simply remove the node right before our dummy tail.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">For example, if we add items A, B, C to a cache with capacity 2:</div><ol style="list-style: outside decimal;">
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">Add A: [A]</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">Add B: [B -&gt; A]</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">Add C: Cache is full, evict A (least recently used), resulting in [C -&gt; B]</div></li>
</ol><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">When we access an existing item, we:</div><ol style="list-style: outside decimal;">
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">Look up its Node in our hash table (<span class="MuiBox-root mui-1vu004u">O(1)</span>)</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">Remove the Node from its current position in the list (<span class="MuiBox-root mui-1vu004u">O(1)</span>)</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">Move it to the front of the list (<span class="MuiBox-root mui-1vu004u">O(1)</span>)</div></li>
</ol><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">This way, frequently accessed items stay near the head and are safe from eviction, while rarely used items drift towards the tail where they'll eventually be removed when space is needed.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">The hash table gives us <span class="MuiBox-root mui-1vu004u">O(1)</span> lookups, while the doubly-linked list gives us <span class="MuiBox-root mui-1vu004u">O(1)</span> updates to our access order. By combining them, we get the best of both worlds - fast access and efficient LRU tracking.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Here is some pseudocode for the implementation:</div><pre><div class="MuiBox-root mui-xnilmx"><div class="MuiBox-root mui-v2ritd"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-4 h-4  cursor-pointer" aria-label="Copy"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"></path></svg></div><div style="background: rgb(250, 250, 250); color: rgb(56, 58, 66); font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0px; overflow: auto; border-radius: 0.375rem; border: none;"><code font-size="18" style="white-space: pre;"><span class="token" style="color: rgb(166, 38, 164);">class</span><span> </span><span class="token" style="color: rgb(183, 107, 1);">Node</span><span> </span><span class="token" style="color: rgb(160, 161, 167); font-style: italic;"># Node in our doubly-linked list storing values and expiry times</span><span>
</span>
<span></span><span class="token" style="color: rgb(166, 38, 164);">class</span><span> </span><span class="token" style="color: rgb(183, 107, 1);">Cache</span><span class="token" style="color: rgb(56, 58, 66);">:</span><span>
</span><span>    get</span><span class="token" style="color: rgb(56, 58, 66);">(</span><span>key</span><span class="token" style="color: rgb(56, 58, 66);">)</span><span class="token" style="color: rgb(56, 58, 66);">:</span><span>
</span><span>        </span><span class="token" style="color: rgb(160, 161, 167); font-style: italic;"># get the node from the hash table</span><span>
</span><span>        node </span><span class="token" style="color: rgb(64, 120, 242);">=</span><span> data</span><span class="token" style="color: rgb(56, 58, 66);">[</span><span>key</span><span class="token" style="color: rgb(56, 58, 66);">]</span><span>
</span>        
<span>        </span><span class="token" style="color: rgb(160, 161, 167); font-style: italic;"># Check if the entry has expired</span><span>
</span><span>        </span><span class="token" style="color: rgb(166, 38, 164);">if</span><span> node</span><span class="token" style="color: rgb(56, 58, 66);">.</span><span>expiry </span><span class="token" style="color: rgb(166, 38, 164);">and</span><span> currentTime</span><span class="token" style="color: rgb(56, 58, 66);">(</span><span class="token" style="color: rgb(56, 58, 66);">)</span><span> </span><span class="token" style="color: rgb(64, 120, 242);">&gt;</span><span> node</span><span class="token" style="color: rgb(56, 58, 66);">.</span><span>expiry</span><span class="token" style="color: rgb(56, 58, 66);">:</span><span>
</span><span>            </span><span class="token" style="color: rgb(160, 161, 167); font-style: italic;"># Remove expired node from both hash table and linked list</span><span>
</span><span>            delete data</span><span class="token" style="color: rgb(56, 58, 66);">[</span><span>key</span><span class="token" style="color: rgb(56, 58, 66);">]</span><span>
</span>            delete node
<span>            </span><span class="token" style="color: rgb(166, 38, 164);">return</span><span> null
</span>            
<span>        </span><span class="token" style="color: rgb(160, 161, 167); font-style: italic;"># Move node to front of list</span><span>
</span><span>        move_to_front</span><span class="token" style="color: rgb(56, 58, 66);">(</span><span>node</span><span class="token" style="color: rgb(56, 58, 66);">)</span><span>
</span><span>        </span><span class="token" style="color: rgb(166, 38, 164);">return</span><span> node</span><span class="token" style="color: rgb(56, 58, 66);">.</span><span>value
</span>
<span>    </span><span class="token" style="color: rgb(80, 161, 79);">set</span><span class="token" style="color: rgb(56, 58, 66);">(</span><span>key</span><span class="token" style="color: rgb(56, 58, 66);">,</span><span> value</span><span class="token" style="color: rgb(56, 58, 66);">,</span><span> ttl</span><span class="token" style="color: rgb(56, 58, 66);">)</span><span class="token" style="color: rgb(56, 58, 66);">:</span><span>
</span><span>        </span><span class="token" style="color: rgb(160, 161, 167); font-style: italic;"># Calculate expiry timestamp if TTL is provided</span><span>
</span><span>        expiry </span><span class="token" style="color: rgb(64, 120, 242);">=</span><span> currentTime</span><span class="token" style="color: rgb(56, 58, 66);">(</span><span class="token" style="color: rgb(56, 58, 66);">)</span><span> </span><span class="token" style="color: rgb(64, 120, 242);">+</span><span> ttl </span><span class="token" style="color: rgb(166, 38, 164);">if</span><span> ttl </span><span class="token" style="color: rgb(166, 38, 164);">else</span><span> null
</span>        
<span>        </span><span class="token" style="color: rgb(166, 38, 164);">if</span><span> key </span><span class="token" style="color: rgb(166, 38, 164);">in</span><span> data</span><span class="token" style="color: rgb(56, 58, 66);">:</span><span>
</span><span>            </span><span class="token" style="color: rgb(160, 161, 167); font-style: italic;"># Update existing entry</span><span>
</span><span>            node </span><span class="token" style="color: rgb(64, 120, 242);">=</span><span> data</span><span class="token" style="color: rgb(56, 58, 66);">[</span><span>key</span><span class="token" style="color: rgb(56, 58, 66);">]</span><span>
</span><span>            node</span><span class="token" style="color: rgb(56, 58, 66);">.</span><span>value </span><span class="token" style="color: rgb(64, 120, 242);">=</span><span> value
</span><span>            node</span><span class="token" style="color: rgb(56, 58, 66);">.</span><span>expiry </span><span class="token" style="color: rgb(64, 120, 242);">=</span><span> expiry
</span><span>            move_to_front</span><span class="token" style="color: rgb(56, 58, 66);">(</span><span>node</span><span class="token" style="color: rgb(56, 58, 66);">)</span><span>
</span><span>        </span><span class="token" style="color: rgb(166, 38, 164);">else</span><span class="token" style="color: rgb(56, 58, 66);">:</span><span>
</span><span>            </span><span class="token" style="color: rgb(160, 161, 167); font-style: italic;"># Add new entry</span><span>
</span><span>            node </span><span class="token" style="color: rgb(64, 120, 242);">=</span><span> Node</span><span class="token" style="color: rgb(56, 58, 66);">(</span><span>key</span><span class="token" style="color: rgb(56, 58, 66);">,</span><span> value</span><span class="token" style="color: rgb(56, 58, 66);">,</span><span> expiry</span><span class="token" style="color: rgb(56, 58, 66);">)</span><span>
</span><span>            data</span><span class="token" style="color: rgb(56, 58, 66);">[</span><span>key</span><span class="token" style="color: rgb(56, 58, 66);">]</span><span> </span><span class="token" style="color: rgb(64, 120, 242);">=</span><span> node
</span><span>            add_node</span><span class="token" style="color: rgb(56, 58, 66);">(</span><span>node</span><span class="token" style="color: rgb(56, 58, 66);">)</span><span>
</span>            
<span>            </span><span class="token" style="color: rgb(160, 161, 167); font-style: italic;"># If over capacity, remove least recently used item</span><span>
</span><span>            </span><span class="token" style="color: rgb(166, 38, 164);">if</span><span> size </span><span class="token" style="color: rgb(64, 120, 242);">&gt;</span><span> capacity</span><span class="token" style="color: rgb(56, 58, 66);">:</span><span>
</span><span>                lru </span><span class="token" style="color: rgb(64, 120, 242);">=</span><span> tail</span><span class="token" style="color: rgb(56, 58, 66);">.</span><span>prev
</span>                delete lru
<span>                delete data</span><span class="token" style="color: rgb(56, 58, 66);">[</span><span>lru</span><span class="token" style="color: rgb(56, 58, 66);">.</span><span>key</span><span class="token" style="color: rgb(56, 58, 66);">]</span><span>
</span>
<span>    cleanup</span><span class="token" style="color: rgb(56, 58, 66);">(</span><span class="token" style="color: rgb(56, 58, 66);">)</span><span class="token" style="color: rgb(56, 58, 66);">:</span><span>
</span><span>        expired_keys </span><span class="token" style="color: rgb(64, 120, 242);">=</span><span> </span><span class="token" style="color: rgb(56, 58, 66);">[</span><span class="token" style="color: rgb(56, 58, 66);">]</span><span>
</span>        
<span>        </span><span class="token" style="color: rgb(160, 161, 167); font-style: italic;"># Scan from LRU end towards head</span><span>
</span><span>        current </span><span class="token" style="color: rgb(64, 120, 242);">=</span><span> tail</span><span class="token" style="color: rgb(56, 58, 66);">.</span><span>prev
</span><span>        </span><span class="token" style="color: rgb(166, 38, 164);">while</span><span> current </span><span class="token" style="color: rgb(64, 120, 242);">!=</span><span> head</span><span class="token" style="color: rgb(56, 58, 66);">:</span><span>
</span><span>            </span><span class="token" style="color: rgb(166, 38, 164);">if</span><span> current</span><span class="token" style="color: rgb(56, 58, 66);">.</span><span>expiry </span><span class="token" style="color: rgb(166, 38, 164);">and</span><span> currentTime</span><span class="token" style="color: rgb(56, 58, 66);">(</span><span class="token" style="color: rgb(56, 58, 66);">)</span><span> </span><span class="token" style="color: rgb(64, 120, 242);">&gt;</span><span> current</span><span class="token" style="color: rgb(56, 58, 66);">.</span><span>expiry</span><span class="token" style="color: rgb(56, 58, 66);">:</span><span>
</span><span>                expired_keys</span><span class="token" style="color: rgb(56, 58, 66);">.</span><span>add</span><span class="token" style="color: rgb(56, 58, 66);">(</span><span>current</span><span class="token" style="color: rgb(56, 58, 66);">.</span><span>key</span><span class="token" style="color: rgb(56, 58, 66);">)</span><span>
</span><span>            current </span><span class="token" style="color: rgb(64, 120, 242);">=</span><span> current</span><span class="token" style="color: rgb(56, 58, 66);">.</span><span>prev
</span>            
<span>        </span><span class="token" style="color: rgb(160, 161, 167); font-style: italic;"># Remove expired entries</span><span>
</span><span>        </span><span class="token" style="color: rgb(166, 38, 164);">for</span><span> key </span><span class="token" style="color: rgb(166, 38, 164);">in</span><span> expired_keys</span><span class="token" style="color: rgb(56, 58, 66);">:</span><span>
</span><span>            node </span><span class="token" style="color: rgb(64, 120, 242);">=</span><span> data</span><span class="token" style="color: rgb(56, 58, 66);">[</span><span>key</span><span class="token" style="color: rgb(56, 58, 66);">]</span><span>
</span><span>            delete data</span><span class="token" style="color: rgb(56, 58, 66);">[</span><span>key</span><span class="token" style="color: rgb(56, 58, 66);">]</span><span>
</span>            delete node</code></div></div></pre><div class="my-6"><div class="MuiBox-root mui-o9fqh4"><div class="MuiBox-root mui-3t6lyr"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-6 h-6 heroicon-sw-2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"></path></svg></div><div class="MuiBox-root mui-79elbk"><div style="overflow: hidden; max-height: 300px;"><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">The code examples provided here are meant to illustrate core concepts and are intentionally simplified for clarity. A production implementation would need to handle many additional concerns including thread safety, error handling, monitoring, and performance optimizations.</div></div></div></div></div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag"><div class="MuiBox-root mui-10khgmf" style="cursor: pointer;"><div class="MuiGrid-root MuiGrid-container MuiGrid-direction-xs-column mui-1tdxmx0"><div class="MuiGrid-root MuiGrid-item mui-tolxbf"><div class="relative w-full"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeSmall mui-wksd04" tabindex="0" type="button" aria-label="zoom-in"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium mui-10dohqv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ZoomInIcon"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"></path><path d="M12 10h-2v2H9v-2H7V9h2V7h1v2h2z"></path></svg><span class="MuiTouchRipple-root mui-w0pj6f"></span></button><span class="w-full h-full"><span class="block"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1543.5986282181052 550.2177871203214">
  <!-- svg-source:excalidraw -->
  <!-- payload-type:application/vnd.excalidraw+json --><!-- payload-version:2 -->
  <defs>
    <style class="style-fonts">
      
      
      
    </style>
    
  </defs>
  <rect x="0" y="0" width="1543.5986282181052" height="550.2177871203214" fill="#ffffff"></rect><g stroke-linecap="round" transform="translate(10 246.3800823958412) rotate(0 46.552734375 44.4140625)"><path d="M22.21 0 C37.32 -0.86, 48.91 0.91, 70.9 0 M22.21 0 C35.84 -0.57, 47.65 -0.48, 70.9 0 M70.9 0 C86.17 0.73, 94.75 8.12, 93.11 22.21 M70.9 0 C87.75 -1.38, 94.93 7.68, 93.11 22.21 M93.11 22.21 C93.6 35.59, 92.57 46.97, 93.11 66.62 M93.11 22.21 C93.76 34.92, 93.3 44.9, 93.11 66.62 M93.11 66.62 C93.3 81.07, 86 89.83, 70.9 88.83 M93.11 66.62 C92.88 82.36, 84.8 90.62, 70.9 88.83 M70.9 88.83 C56.3 89.4, 44.66 88.88, 22.21 88.83 M70.9 88.83 C56.82 88.5, 41.91 88.72, 22.21 88.83 M22.21 88.83 C6.54 90.65, -1.94 82.4, 0 66.62 M22.21 88.83 C5.85 90.47, -2.25 80.37, 0 66.62 M0 66.62 C-0.74 58.3, -0.87 48.48, 0 22.21 M0 66.62 C0.71 53.04, -0.54 41.13, 0 22.21 M0 22.21 C-0.27 7.45, 7.77 1.18, 22.21 0 M0 22.21 C2.02 8.56, 7.89 -1.1, 22.21 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(34.3408203125 278.2941448958412) rotate(0 22.2119140625 12.5)"><text x="22.2119140625" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">client</text></g><g stroke-linecap="round"><g transform="translate(112.28894261170413 290.9329319092255) rotate(0 90.42763203146684 -0.8467181547656253)"><path d="M0.48 -0.36 C30.54 -0.5, 149.63 -1.56, 179.8 -1.92 M-0.73 -1.6 C29.74 -1.45, 151.66 -0.5, 181.95 -0.49" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(112.28894261170413 290.9329319092255) rotate(0 90.42763203146684 -0.8467181547656253)"><path d="M153.71 9.64 C160.29 5.22, 167.62 5.45, 181.95 -0.49 M153.71 9.64 C160.63 7.8, 167.81 5.42, 181.95 -0.49" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(112.28894261170413 290.9329319092255) rotate(0 90.42763203146684 -0.8467181547656253)"><path d="M153.81 -10.88 C160.17 -10.15, 167.47 -4.77, 181.95 -0.49 M153.81 -10.88 C160.53 -7.93, 167.69 -5.51, 181.95 -0.49" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(127.66944885882299 239.53374723780416) rotate(0 73.05992889404297 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">get/set/delete</text></g><g stroke-linecap="round" transform="translate(309.81741778819645 46.46048511279963) rotate(0 611.8906052149543 246.87865100376092)"><path d="M32 0 C277.01 -3, 522.62 -2.16, 1191.78 0 M32 0 C422.8 -1.9, 813.2 -1.61, 1191.78 0 M1191.78 0 C1213.04 -0.75, 1224.89 11.33, 1223.78 32 M1191.78 0 C1213.37 -0.43, 1221.99 9.89, 1223.78 32 M1223.78 32 C1223.16 168.02, 1221.25 303.9, 1223.78 461.76 M1223.78 32 C1224.07 153.55, 1223.91 275.08, 1223.78 461.76 M1223.78 461.76 C1223.4 482.34, 1213.12 492.83, 1191.78 493.76 M1223.78 461.76 C1224.44 484.36, 1213.17 493.76, 1191.78 493.76 M1191.78 493.76 C902.93 496.44, 614.27 495.9, 32 493.76 M1191.78 493.76 C738.21 496.3, 284.8 495.84, 32 493.76 M32 493.76 C9.04 495.68, -1.88 482.77, 0 461.76 M32 493.76 C12.27 493.24, 1.48 482.93, 0 461.76 M0 461.76 C-2.53 307.75, -1.39 154.19, 0 32 M0 461.76 C0.04 332.15, -0.3 201.77, 0 32 M0 32 C0.39 10.1, 9.08 -1.34, 32 0 M0 32 C-0.72 9.75, 12.4 1.42, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(673.6227669499635 10) rotate(0 28.53997802734372 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Cache</text></g><g transform="translate(424.0770467378731 62.69282038259783) rotate(0 40.47996520996094 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Hashmap</text></g><g stroke-linecap="round" transform="translate(347.08474558285513 100.65258075673631) rotate(0 147.6617284307858 209.2196126463192)"><path d="M0 0 C91.26 3.06, 184.93 1.53, 295.32 0 M0 0 C99.75 1.43, 200.3 1.26, 295.32 0 M295.32 0 C295.59 159.44, 295.87 317.92, 295.32 418.44 M295.32 0 C296.04 149.54, 295.98 299.49, 295.32 418.44 M295.32 418.44 C222.95 419.82, 151.72 419.2, 0 418.44 M295.32 418.44 C223.34 419.35, 151.62 419.15, 0 418.44 M0 418.44 C0.82 260.26, 0.82 101.84, 0 0 M0 418.44 C-1.66 256.42, -1.38 92.98, 0 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g stroke-linecap="round" transform="translate(482.84445345106815 140.0721289003808) rotate(0 73.04020305775248 25)"><path d="M12.5 0 C62.33 -1.25, 108.44 0.82, 133.58 0 M12.5 0 C48.8 -0.65, 86.14 -1.82, 133.58 0 M133.58 0 C141.82 -1.83, 146.11 5.24, 146.08 12.5 M133.58 0 C142.59 -1.04, 147.56 2.32, 146.08 12.5 M146.08 12.5 C144.58 21.61, 146.49 28.36, 146.08 37.5 M146.08 12.5 C145.75 17.9, 146.25 24.62, 146.08 37.5 M146.08 37.5 C147.04 45.17, 140.44 51.84, 133.58 50 M146.08 37.5 C147.93 45.3, 141.31 51.75, 133.58 50 M133.58 50 C87.94 51.64, 38.01 51.6, 12.5 50 M133.58 50 C96.22 50.72, 57.8 50.95, 12.5 50 M12.5 50 C2.44 49.49, 1.05 47.34, 0 37.5 M12.5 50 C2.27 48.89, -0.94 46.86, 0 37.5 M0 37.5 C0.42 28.24, -1.23 19.3, 0 12.5 M0 37.5 C-0.86 30.8, 0.7 22.77, 0 12.5 M0 12.5 C-1.65 4.39, 3.81 -1.16, 12.5 0 M0 12.5 C-1.76 4.68, 3.9 0.46, 12.5 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(500.4766898950511 145.0721289003808) rotate(0 55.40796661376953 20)"><text x="55.40796661376953" y="0" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">value1 &amp; </text><text x="55.40796661376953" y="20" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">expirationTime</text></g><g transform="translate(528.909421025661 113.51229691222017) rotate(0 20.67998504638672 10)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Node1</text></g><g stroke-linecap="round"><g transform="translate(347.1009029934211 207.91800570004494) rotate(0 147.3455542125635 0)"><path d="M-0.02 -0.14 C49.31 0.06, 246.57 0.9, 295.65 1.1 M-1.49 -1.26 C47.79 -1.36, 246.03 -0.54, 295.2 -0.45" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(460.2650051805373 104.04823520451401) rotate(0 0 205.7349886050157)"><path d="M-0.95 -0.46 C-0.99 68.16, 0.2 342.25, 0.54 411.08 M0.76 -1.74 C0.53 67.1, -0.14 343.66, -0.13 412.41" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(383.54432260202975 145.05455795542758) rotate(0 14.191993713378906 10)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">key1</text></g><g stroke-linecap="round" transform="translate(487.253370455613 245.86946922404212) rotate(0 73.04020305775248 25)"><path d="M12.5 0 C57.91 -0.41, 102.8 1.18, 133.58 0 M12.5 0 C48.76 0.5, 86.61 1.85, 133.58 0 M133.58 0 C141.37 1.03, 147.87 3.08, 146.08 12.5 M133.58 0 C143.48 0.45, 143.83 6.45, 146.08 12.5 M146.08 12.5 C147.64 19.71, 144.4 28.92, 146.08 37.5 M146.08 12.5 C145.38 22.66, 145.43 30.96, 146.08 37.5 M146.08 37.5 C147.07 44.35, 143.16 49.27, 133.58 50 M146.08 37.5 C144.4 46.41, 141.11 50.72, 133.58 50 M133.58 50 C88.25 48.36, 45.07 49.51, 12.5 50 M133.58 50 C97.17 49.61, 60.59 48.88, 12.5 50 M12.5 50 C2.74 51.11, 1.41 44.1, 0 37.5 M12.5 50 C4.2 52.29, 1.81 47.48, 0 37.5 M0 37.5 C0.34 28.17, -1.47 19.53, 0 12.5 M0 37.5 C-0.23 31.71, -0.22 26.76, 0 12.5 M0 12.5 C1.67 3.12, 2.48 -1.8, 12.5 0 M0 12.5 C-1.77 2.15, 2.1 2.1, 12.5 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(504.8856068995959 250.86946922404212) rotate(0 55.40796661376953 20)"><text x="55.40796661376953" y="0" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">valu2 &amp; </text><text x="55.40796661376953" y="20" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">expirationTime</text></g><g transform="translate(533.2119247662406 219.5525503347676) rotate(0 24.207984924316406 10)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Node2</text></g><g stroke-linecap="round"><g transform="translate(351.40340673400067 314.1667168166974) rotate(0 147.3455542125635 0)"><path d="M0.49 -1.11 C49.41 -1.24, 245.03 -1.07, 294.23 -0.74 M-0.7 0.92 C47.95 0.93, 243.69 0.73, 293.04 0.41" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(387.84682634260935 251.30326907208) rotate(0 17.719993591308594 10)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">key2</text></g><g stroke-linecap="round" transform="translate(485.0094616918853 355.4250713453105) rotate(0 73.04020305775248 25)"><path d="M12.5 0 C54.21 -1.28, 93.7 -1.67, 133.58 0 M12.5 0 C55.73 0.15, 98.87 -0.96, 133.58 0 M133.58 0 C143.55 -0.42, 146.38 2.89, 146.08 12.5 M133.58 0 C140.44 0.11, 147.47 4.75, 146.08 12.5 M146.08 12.5 C146.3 19.48, 147.71 24.03, 146.08 37.5 M146.08 12.5 C145.72 18.82, 145.78 24.89, 146.08 37.5 M146.08 37.5 C144.4 45.83, 140.9 49.28, 133.58 50 M146.08 37.5 C145.45 46.22, 141.06 50.23, 133.58 50 M133.58 50 C87.6 49.25, 42.36 51.45, 12.5 50 M133.58 50 C94.34 50.23, 57.13 50.77, 12.5 50 M12.5 50 C2.21 50.18, -0.28 45.59, 0 37.5 M12.5 50 C6.13 51.52, -1.15 46.93, 0 37.5 M0 37.5 C-0.43 28.76, 1.77 19.41, 0 12.5 M0 37.5 C0.19 29.81, -0.7 19.99, 0 12.5 M0 12.5 C-0.18 2.57, 3.39 -1.58, 12.5 0 M0 12.5 C0.04 2.12, 2.83 2.02, 12.5 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(502.64169813586824 360.4250713453105) rotate(0 55.40796661376953 20)"><text x="55.40796661376953" y="0" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">valu3 &amp; </text><text x="55.40796661376953" y="20" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">expirationTime</text></g><g transform="translate(531.0744292664781 329.0017391920707) rotate(0 23.959983825683594 10)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Node3</text></g><g stroke-linecap="round"><g transform="translate(349.2659112342383 423.4253157822473) rotate(0 147.3455542125635 0)"><path d="M1.08 -0.02 C50.4 -0.1, 246.15 0.35, 295.25 0.15 M0.19 -1.08 C49.46 -1, 245.38 1.67, 294.6 1.77" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(385.70933084284695 360.56186803762995) rotate(0 17.47199249267578 10)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">key3</text></g><g stroke-linecap="round" transform="translate(482.2073712862381 458.7068795103177) rotate(0 73.04020305775248 25)"><path d="M12.5 0 C36.73 0.59, 64.5 -0.92, 133.58 0 M12.5 0 C56.35 0.81, 100.7 0.88, 133.58 0 M133.58 0 C143.05 0.62, 146.46 3.27, 146.08 12.5 M133.58 0 C142.42 -0.02, 146.8 4.06, 146.08 12.5 M146.08 12.5 C146.86 18.33, 147.55 25.66, 146.08 37.5 M146.08 12.5 C146.52 17.74, 146.77 22.62, 146.08 37.5 M146.08 37.5 C146.42 46.24, 140.54 48.26, 133.58 50 M146.08 37.5 C147.15 45.14, 143.29 49.91, 133.58 50 M133.58 50 C94.58 51.31, 58.43 52.85, 12.5 50 M133.58 50 C98 50.72, 64.95 49.51, 12.5 50 M12.5 50 C5.36 50.86, 1.72 44.76, 0 37.5 M12.5 50 C4.5 52.02, 0.27 44.72, 0 37.5 M0 37.5 C0.73 33.76, -1.63 28.2, 0 12.5 M0 37.5 C-1.1 31.11, 0.69 25.67, 0 12.5 M0 12.5 C0.46 3.16, 5.98 -1.41, 12.5 0 M0 12.5 C-1.23 3.04, 5.77 -0.26, 12.5 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(499.839607730221 463.7068795103177) rotate(0 55.40796661376953 20)"><text x="55.40796661376953" y="0" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">valu4 &amp; </text><text x="55.40796661376953" y="20" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">expirationTime</text></g><g transform="translate(528.462928752584 432.283547357078) rotate(0 23.631980895996094 10)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Node4</text></g><g transform="translate(383.0978303289529 464.0342660943904) rotate(0 17.14398956298828 10)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">key4</text></g><g transform="translate(1014.373747611512 61.38706407910385) rotate(0 53.13995361328125 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Linked List</text></g><g stroke-linecap="round" transform="translate(672.7049250725559 141.20979666178624) rotate(0 73.04020305775245 25)"><path d="M12.5 0 C39.4 1.73, 68.96 1.82, 133.58 0 M12.5 0 C53.44 -0.94, 94.09 -0.22, 133.58 0 M133.58 0 C142.96 -1.39, 146.07 4.69, 146.08 12.5 M133.58 0 C143.85 -0.46, 145.75 4.67, 146.08 12.5 M146.08 12.5 C145.11 24.15, 144.98 33.84, 146.08 37.5 M146.08 12.5 C146.64 21.35, 146.31 30.79, 146.08 37.5 M146.08 37.5 C146.21 47.33, 140.36 50.29, 133.58 50 M146.08 37.5 C148.06 46.57, 143.31 49.94, 133.58 50 M133.58 50 C91.6 47.82, 50.36 50.52, 12.5 50 M133.58 50 C108.95 48.54, 82.59 49.62, 12.5 50 M12.5 50 C3.13 50.22, -0.39 44.25, 0 37.5 M12.5 50 C5.01 49.33, 1.65 43.81, 0 37.5 M0 37.5 C0.67 33.36, -2.07 25.31, 0 12.5 M0 37.5 C-0.57 28.73, 0.46 20.13, 0 12.5 M0 12.5 C-1.08 3.58, 5.72 -0.43, 12.5 0 M0 12.5 C-0.54 3.69, 4.21 -1.29, 12.5 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(690.3371615165388 146.20979666178624) rotate(0 55.4079666137695 20)"><text x="55.40796661376953" y="0" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">value1 &amp; </text><text x="55.40796661376953" y="20" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">expirationTime</text></g><g transform="translate(718.7698926471487 114.64996467362568) rotate(0 20.67998504638672 10)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Node1</text></g><g stroke-linecap="round" transform="translate(876.1894141896566 139.25986833833622) rotate(0 73.04020305775248 25)"><path d="M12.5 0 C39.93 -1.55, 72.55 -0.97, 133.58 0 M12.5 0 C61.29 0.98, 109.44 0.26, 133.58 0 M133.58 0 C140.99 0.53, 145.8 3.9, 146.08 12.5 M133.58 0 C140.24 -0.72, 146.98 4.98, 146.08 12.5 M146.08 12.5 C146.04 23.42, 145.62 32, 146.08 37.5 M146.08 12.5 C145.67 22.22, 145.13 31.91, 146.08 37.5 M146.08 37.5 C148 46.45, 142.51 49.33, 133.58 50 M146.08 37.5 C144.51 46.87, 142.94 51.18, 133.58 50 M133.58 50 C108.77 50.8, 82.29 48.4, 12.5 50 M133.58 50 C87.26 50.03, 39.17 50.03, 12.5 50 M12.5 50 C4.86 48.12, 1.27 44.87, 0 37.5 M12.5 50 C4.4 48.63, 0.85 47.83, 0 37.5 M0 37.5 C0.13 33.14, -0.92 27.85, 0 12.5 M0 37.5 C-0.07 28.42, -0.52 18.59, 0 12.5 M0 12.5 C0.4 5.52, 3.28 -1.39, 12.5 0 M0 12.5 C2.16 2.26, 3.23 1.88, 12.5 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(893.8216506336396 144.25986833833622) rotate(0 55.40796661376953 20)"><text x="55.40796661376953" y="0" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">valu2 &amp; </text><text x="55.40796661376953" y="20" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">expirationTime</text></g><g transform="translate(922.1479685002844 112.94294944906176) rotate(0 24.207984924316406 10)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Node2</text></g><g stroke-linecap="round" transform="translate(1069.3403576132653 138.64005441506544) rotate(0 73.04020305775248 25)"><path d="M12.5 0 C49.1 0.59, 84.46 -1.34, 133.58 0 M12.5 0 C43.62 0.21, 75.16 -0.57, 133.58 0 M133.58 0 C140.3 0.05, 147.26 2.23, 146.08 12.5 M133.58 0 C142.11 -1.12, 145.43 4.23, 146.08 12.5 M146.08 12.5 C144.96 19.13, 146.29 21.12, 146.08 37.5 M146.08 12.5 C146.64 22.1, 145.39 32.16, 146.08 37.5 M146.08 37.5 C144.73 44.26, 143.16 51.93, 133.58 50 M146.08 37.5 C148.01 48.06, 143.63 47.84, 133.58 50 M133.58 50 C86.53 50.55, 38.52 49.89, 12.5 50 M133.58 50 C95.04 48.78, 58.44 48.07, 12.5 50 M12.5 50 C4.19 50.37, -1.72 47.11, 0 37.5 M12.5 50 C2.36 49.06, -1.97 44.08, 0 37.5 M0 37.5 C-1.33 27.46, 1.15 16.21, 0 12.5 M0 37.5 C-0.92 28.2, -0.03 17.72, 0 12.5 M0 12.5 C1.67 3.27, 2.84 -0.11, 12.5 0 M0 12.5 C1.1 3.18, 3.54 -2.07, 12.5 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1086.9725940572482 143.64005441506544) rotate(0 55.40796661376953 20)"><text x="55.40796661376953" y="0" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">valu3 &amp; </text><text x="55.40796661376953" y="20" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">expirationTime</text></g><g transform="translate(1115.4053251878581 112.21672226182574) rotate(0 23.959983825683594 10)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Node3</text></g><g stroke-linecap="round" transform="translate(1265.2012510602392 138.32438990684926) rotate(0 73.04020305775248 25)"><path d="M12.5 0 C54.47 2.95, 93.52 1.62, 133.58 0 M12.5 0 C48.73 -0.13, 83.95 -0.86, 133.58 0 M133.58 0 C141.85 -1.03, 148 4.28, 146.08 12.5 M133.58 0 C141.01 -0.67, 147.45 5.39, 146.08 12.5 M146.08 12.5 C144.22 19.11, 147.84 21.75, 146.08 37.5 M146.08 12.5 C146.14 20.66, 146.16 29.33, 146.08 37.5 M146.08 37.5 C146.54 47.8, 142.3 49.72, 133.58 50 M146.08 37.5 C146.27 47.54, 141.69 48.03, 133.58 50 M133.58 50 C91.07 47.35, 49.65 50.24, 12.5 50 M133.58 50 C96.37 50.51, 59.1 49.13, 12.5 50 M12.5 50 C4.87 51.28, 0.89 47.25, 0 37.5 M12.5 50 C3.15 51.07, -2.11 46.45, 0 37.5 M0 37.5 C-0.69 27.84, 2.08 18.45, 0 12.5 M0 37.5 C-0.52 28.59, -0.62 19.48, 0 12.5 M0 12.5 C-1.73 5.05, 3.34 -1.24, 12.5 0 M0 12.5 C2.28 6.31, 2.37 1.6, 12.5 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1282.8334875042221 143.32438990684926) rotate(0 55.40796661376953 20)"><text x="55.40796661376953" y="0" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">valu4 &amp; </text><text x="55.40796661376953" y="20" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">expirationTime</text></g><g transform="translate(1311.456808526585 111.90105775360956) rotate(0 23.631980895996094 10)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Node4</text></g><g stroke-linecap="round"><g transform="translate(822.5134628806102 163.19336244251684) rotate(0 24.56772687721451 -0.18116461980733334)"><path d="M0.24 -0.03 C8.49 -0.12, 41.3 0.09, 49.43 -0.03 M-0.3 -0.52 C7.91 -0.53, 41 -0.86, 49.15 -0.83" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(822.5134628806102 163.19336244251684) rotate(0 24.56772687721451 -0.18116461980733334)"><path d="M0.37 0.04 L13.2 -6.06 L13.73 6.96 L-0.34 -0.31" stroke="none" stroke-width="0" fill="#1e1e1e" fill-rule="evenodd"></path><path d="M0.24 -0.03 C4.14 -1.5, 8.58 -3.94, 13.84 -6.35 M0.24 -0.03 C3.63 -1.46, 6.7 -3.12, 13.84 -6.35 M13.84 -6.35 C13.64 -2.31, 13.58 0.71, 13.83 6.32 M13.84 -6.35 C13.88 -3.78, 13.6 -1.34, 13.83 6.32 M13.83 6.32 C8.97 4.18, 3.82 1.95, 0.24 -0.03 M13.83 6.32 C8.87 3.68, 3.87 1.56, 0.24 -0.03 M0.24 -0.03 C0.24 -0.03, 0.24 -0.03, 0.24 -0.03 M0.24 -0.03 C0.24 -0.03, 0.24 -0.03, 0.24 -0.03" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(822.5134628806102 163.19336244251684) rotate(0 24.56772687721451 -0.18116461980733334)"><path d="M49.28 -0.76 L34.93 5.86 L35.43 -6.48 L48.57 -1.11" stroke="none" stroke-width="0" fill="#1e1e1e" fill-rule="evenodd"></path><path d="M49.15 -0.83 C45.19 1.47, 41.73 2.73, 35.58 5.57 M49.15 -0.83 C46.28 0.55, 43.07 1.84, 35.58 5.57 M35.58 5.57 C35.26 2.31, 35.19 -1.96, 35.53 -7.11 M35.58 5.57 C35.62 2.87, 35.33 0.05, 35.53 -7.11 M35.53 -7.11 C40.63 -4.62, 45.48 -2.22, 49.15 -0.83 M35.53 -7.11 C40.29 -5.11, 45.09 -2.69, 49.15 -0.83 M49.15 -0.83 C49.15 -0.83, 49.15 -0.83, 49.15 -0.83 M49.15 -0.83 C49.15 -0.83, 49.15 -0.83, 49.15 -0.83" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(1024.0566050987632 161.75936545684857) rotate(0 24.56772687721451 -0.18116461980733334)"><path d="M0.24 0.22 C8.49 0.26, 41.16 0.15, 49.33 0.01 M-0.3 -0.14 C7.92 -0.24, 40.79 -0.77, 49.01 -0.76" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(1024.0566050987632 161.75936545684857) rotate(0 24.56772687721451 -0.18116461980733334)"><path d="M0.87 0.49 L13.31 -5.86 L14.62 7.02 L1.23 0.8" stroke="none" stroke-width="0" fill="#1e1e1e" fill-rule="evenodd"></path><path d="M0.24 0.22 C4.16 -1.23, 7.96 -3.01, 13.82 -6.15 M0.24 0.22 C3.74 -1.18, 7.67 -2.8, 13.82 -6.15 M13.82 -6.15 C14.12 -1.62, 13.3 3.38, 13.85 6.52 M13.82 -6.15 C13.63 -3.3, 13.86 -0.37, 13.85 6.52 M13.85 6.52 C8.2 4.12, 4.62 2.22, 0.24 0.22 M13.85 6.52 C8.71 4.26, 3.05 1.91, 0.24 0.22 M0.24 0.22 C0.24 0.22, 0.24 0.22, 0.24 0.22 M0.24 0.22 C0.24 0.22, 0.24 0.22, 0.24 0.22" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(1024.0566050987632 161.75936545684857) rotate(0 24.56772687721451 -0.18116461980733334)"><path d="M49.64 -0.49 L34.96 5.99 L36.12 -6.49 L50 -0.19" stroke="none" stroke-width="0" fill="#1e1e1e" fill-rule="evenodd"></path><path d="M49.01 -0.76 C45.71 1.25, 42.32 2.88, 35.47 5.7 M49.01 -0.76 C45.41 1.3, 42.29 3.01, 35.47 5.7 M35.47 5.7 C35.72 0.27, 34.85 -4.68, 35.36 -6.98 M35.47 5.7 C35.25 2.9, 35.45 0.17, 35.36 -6.98 M35.36 -6.98 C39.52 -4.88, 45.76 -2.27, 49.01 -0.76 M35.36 -6.98 C40.97 -4.42, 46.03 -1.83, 49.01 -0.76 M49.01 -0.76 C49.01 -0.76, 49.01 -0.76, 49.01 -0.76 M49.01 -0.76 C49.01 -0.76, 49.01 -0.76, 49.01 -0.76" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(1217.2636975570492 163.43756726987505) rotate(0 24.56772687721451 -0.18116461980733334)"><path d="M-0.05 -0.29 C8.13 -0.35, 40.94 -0.21, 49.08 -0.31 M-0.74 0.75 C7.36 0.78, 40.18 0.64, 48.62 0.42" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(1217.2636975570492 163.43756726987505) rotate(0 24.56772687721451 -0.18116461980733334)"><path d="M-0.6 -0.4 L13.82 -6.91 L13.87 6.76 L0.39 0.43" stroke="none" stroke-width="0" fill="#1e1e1e" fill-rule="evenodd"></path><path d="M-0.05 -0.29 C3.6 -2.25, 8.13 -4.57, 13.54 -6.62 M-0.05 -0.29 C2.47 -1.91, 5.2 -2.81, 13.54 -6.62 M13.54 -6.62 C14.08 -3.38, 13.81 0.1, 13.54 6.06 M13.54 -6.62 C13.25 -1.65, 13.49 2.86, 13.54 6.06 M13.54 6.06 C10.62 3.98, 7.48 3.38, -0.05 -0.29 M13.54 6.06 C9.74 4.3, 5.96 2.85, -0.05 -0.29 M-0.05 -0.29 C-0.05 -0.29, -0.05 -0.29, -0.05 -0.29 M-0.05 -0.29 C-0.05 -0.29, -0.05 -0.29, -0.05 -0.29" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(1217.2636975570492 163.43756726987505) rotate(0 24.56772687721451 -0.18116461980733334)"><path d="M48.07 0.31 L35.39 6.65 L35.27 -5.04 L49.06 1.14" stroke="none" stroke-width="0" fill="#1e1e1e" fill-rule="evenodd"></path><path d="M48.62 0.42 C44.19 2.28, 40.63 3.79, 35.11 6.94 M48.62 0.42 C45.69 1.45, 42.94 3.15, 35.11 6.94 M35.11 6.94 C35.62 3.75, 35.32 0.81, 34.94 -5.74 M35.11 6.94 C34.81 2.27, 34.98 -2.85, 34.94 -5.74 M34.94 -5.74 C37.61 -5.1, 40.09 -3.13, 48.62 0.42 M34.94 -5.74 C38.9 -4.06, 42.9 -1.94, 48.62 0.42 M48.62 0.42 C48.62 0.42, 48.62 0.42, 48.62 0.42 M48.62 0.42 C48.62 0.42, 48.62 0.42, 48.62 0.42" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g transform="translate(1403.247773880733 221.70269625749887) rotate(0 40.215980529785156 20)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#868e96" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Next to </text><text x="0" y="20" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#868e96" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">be evicted</text></g><g stroke-linecap="round"><g transform="translate(736.4890464860409 207.4648431173784) rotate(0 39.953641247212886 19.164177540854865)"><path d="M-0.87 -0.15 C4.96 6.12, 21.54 32.51, 35 38.75 C48.45 44.99, 72.56 37.54, 79.85 37.28 M0.88 -1.28 C6.52 5.14, 20.93 30.31, 33.96 36.86 C46.99 43.42, 71.65 37.9, 79.06 38.05" stroke="#868e96" stroke-width="1" fill="none"></path></g><g transform="translate(736.4890464860409 207.4648431173784) rotate(0 39.953641247212886 19.164177540854865)"><path d="M18.27 11.43 C12.1 7.5, 7.28 4.17, -0.87 -0.15 M18.27 11.43 C13.88 8.98, 9.89 5.71, -0.87 -0.15" stroke="#868e96" stroke-width="1" fill="none"></path></g><g transform="translate(736.4890464860409 207.4648431173784) rotate(0 39.953641247212886 19.164177540854865)"><path d="M6.35 21.03 C3.71 14.27, 2.5 8.02, -0.87 -0.15 M6.35 21.03 C4.59 16.64, 3.13 11.33, -0.87 -0.15" stroke="#868e96" stroke-width="1" fill="none"></path></g></g><mask></mask><g transform="translate(830.2166638866815 221.1040631957946) rotate(0 93.32794952392578 20)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#868e96" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">When accessed, nodes</text><text x="0" y="20" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#868e96" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">get moved to the front</text></g><g stroke-linecap="round" transform="translate(1033.2519471040991 377.5459225498466) rotate(0 98.09844655595293 47.58769882225272)"><path d="M23.79 0 C69.67 -1.55, 116.95 0.09, 172.4 0 M23.79 0 C72.11 0.22, 120.38 0.29, 172.4 0 M172.4 0 C187.61 -1.99, 195.28 6.18, 196.2 23.79 M172.4 0 C186.99 1.04, 194.29 9.38, 196.2 23.79 M196.2 23.79 C197.35 37.56, 196.9 53.05, 196.2 71.38 M196.2 23.79 C195.78 34.67, 196.9 44.15, 196.2 71.38 M196.2 71.38 C198 85.29, 188.25 94.28, 172.4 95.18 M196.2 71.38 C195.56 85.96, 190.18 96.53, 172.4 95.18 M172.4 95.18 C115.23 96.05, 59.62 96.94, 23.79 95.18 M172.4 95.18 C122.42 95.13, 72.9 94.23, 23.79 95.18 M23.79 95.18 C7.61 96.91, 1.94 86.36, 0 71.38 M23.79 95.18 C6.47 97.01, -0.41 85.34, 0 71.38 M0 71.38 C-1.41 55.36, 0.48 39.45, 0 23.79 M0 71.38 C-1.1 54.23, 0.09 34.99, 0 23.79 M0 23.79 C-1.07 8.97, 9.75 0.02, 23.79 0 M0 23.79 C-1.58 7.38, 7.04 1.01, 23.79 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1095.9904235672786 412.6336213720993) rotate(0 35.35997009277344 12.5)"><text x="35.35997009277344" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Janitor</text></g><g stroke-linecap="round"><g transform="translate(1015.4197818758785 413.9608161675953) rotate(0 -158.62750317264144 2.6095464987494665)"><path d="M0.41 0.27 C-34.97 0.96, -159.98 4.47, -212.85 4.99 C-265.72 5.52, -299.54 3.66, -316.8 3.41 M-0.84 -0.63 C-36.29 0.17, -160.85 5.53, -213.59 6.41 C-266.34 7.3, -300.31 4.99, -317.32 4.69" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1015.4197818758785 413.9608161675953) rotate(0 -158.62750317264144 2.6095464987494665)"><path d="M-288.8 -4.61 C-295.48 -1.53, -303.49 0.94, -317.32 4.69 M-288.8 -4.61 C-297.45 -2.86, -305.98 -0.01, -317.32 4.69" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1015.4197818758785 413.9608161675953) rotate(0 -158.62750317264144 2.6095464987494665)"><path d="M-289.49 15.9 C-296.14 13.81, -303.98 11.1, -317.32 4.69 M-289.49 15.9 C-298.09 11.61, -306.41 8.43, -317.32 4.69" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(752.3301366146322 439.7131650986158) rotate(0 97.37992095947266 37.5)"><text x="97.37992095947266" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#868e96" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Run every n minutes</text><text x="97.37992095947266" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#868e96" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">to remove expired </text><text x="97.37992095947266" y="50" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#868e96" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">nodes.</text></g><g stroke-linecap="round"><g transform="translate(1014.1250656508521 413.15955173636) rotate(0 -145.29671218670956 -72.6696252519651)"><path d="M-0.44 -1.12 C-38.69 -14.97, -181.09 -59.5, -229.64 -83.62 C-278.19 -107.73, -281.38 -135.56, -291.72 -145.8 M1.52 0.9 C-36.89 -12.71, -182.21 -57.86, -230.7 -82.13 C-279.19 -106.4, -279.2 -134.44, -289.42 -144.72" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1014.1250656508521 413.15955173636) rotate(0 -145.29671218670956 -72.6696252519651)"><path d="M-266.17 -125.76 C-274.66 -131.67, -279.65 -138.65, -289.42 -144.72 M-266.17 -125.76 C-271.47 -130.61, -278.01 -135.34, -289.42 -144.72" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1014.1250656508521 413.15955173636) rotate(0 -145.29671218670956 -72.6696252519651)"><path d="M-283.8 -115.25 C-287.16 -124.12, -287.07 -134.13, -289.42 -144.72 M-283.8 -115.25 C-284.39 -122.89, -286.32 -130.37, -289.42 -144.72" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(1393.741433400784 241.12891020109328) rotate(0 -44.196346851897374 -20.38260358511718)"><path d="M-0.45 0.94 C-14.02 0.87, -65.68 6.6, -80.4 -0.47 C-95.11 -7.53, -87.53 -34.69, -88.73 -41.43 M1.52 0.39 C-11.8 0.48, -63.07 7.63, -78.27 0.82 C-93.47 -5.98, -88.23 -33.68, -89.67 -40.46" stroke="#868e96" stroke-width="1" fill="none"></path></g><g transform="translate(1393.741433400784 241.12891020109328) rotate(0 -44.196346851897374 -20.38260358511718)"><path d="M-82.11 -20.99 C-83.47 -30.44, -88.76 -36.71, -89.67 -40.46 M-82.11 -20.99 C-83.62 -25.97, -85.01 -29.57, -89.67 -40.46" stroke="#868e96" stroke-width="1" fill="none"></path></g><g transform="translate(1393.741433400784 241.12891020109328) rotate(0 -44.196346851897374 -20.38260358511718)"><path d="M-96.39 -20.69 C-92.2 -30.2, -91.94 -36.59, -89.67 -40.46 M-96.39 -20.69 C-94.42 -25.72, -92.32 -29.4, -89.67 -40.46" stroke="#868e96" stroke-width="1" fill="none"></path></g></g><mask></mask></svg></span></span></div></div><div class="MuiGrid-root MuiGrid-item mui-1wxaqej"><span class="MuiTypography-root MuiTypography-caption mui-17cupi8">Simple LRU Cache</span></div></div></div></div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">The clever part about this implementation is that all operations (<span class="MuiBox-root mui-1vu004u">get</span>, <span class="MuiBox-root mui-1vu004u">set</span>, and even <span class="MuiBox-root mui-1vu004u">eviction</span>) remain <span class="MuiBox-root mui-1vu004u">O(1)</span>. When we access or add an item, we move it to the front of the list. When we need to evict, we remove from the back.</div><h2 class="MuiTypography-root MuiTypography-h3 mui-1rzqq5q" id="potential-deep-dives"><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover mui-pvpazu" href="https://www.hellointerview.com/learn/system-design/in-a-hurry/delivery#deep-dives-10-minutes-1" target="_blank" rel="noopener noreferrer" style="color: rgb(99, 115, 129); cursor: pointer; font-weight: 600; text-decoration: underline;">Potential Deep Dives</a></h2><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Ok, truth be told, up until this point this has been more of a low level design interview than pure system design, but the deep dives is where that changes and we discuss how we turn our single, in-memory cache instance into a distributed system that can meet our non-functional requirements.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">For these types of deeper infra questions, the same pattern applies where you should try to lead the conversation toward deep dives in order to satisfy your non-functional requirements. However, it's also the case that your interviewer will likely jump in and hit you with probing questions, so be prepared to be flexible.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Here are some of the questions I'll usually ask (or a candidate could do this proactively).</div><h3 class="MuiTypography-root MuiTypography-h4 mui-hkpafq" id="1-how-do-we-ensure-our-cache-is-highly-available-and-fault-tolerant">1) How do we ensure our cache is highly available and fault tolerant?</h3><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Our high-level design works great on a single node, but what happens when that node fails? In a production environment, we need our cache to stay available even when things go wrong. Let's look at how we can make that happen.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">The key challenge here is data replication - we need multiple copies of our data spread across different nodes. But this opens up a whole new set of questions:</div><ol style="list-style: outside decimal;">
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">How many copies should we keep?</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">Which nodes should store the copies?</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">How do we keep the copies in sync?</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">What happens when nodes fail or can't communicate?</div></li>
</ol><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">There are several well-established patterns for handling this. Each has its own trade-offs between consistency, availability, and complexity.</div><div class="my-6"><div class="MuiBox-root mui-1147lff"><div class="MuiBox-root mui-zvu67g"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-6 h-6 heroicon-sw-2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"></path></svg></div><div class="MuiBox-root mui-79elbk"><div style="overflow: hidden; max-height: 300px;"><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">These patterns extend far beyond distributed caches - they're fundamental building blocks for achieving high availability and fault tolerance in any distributed system, from databases to message queues.</div></div></div></div></div><div class="my-6 flex flex-col gap-4"><div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation0 MuiAccordion-root MuiAccordion-rounded MuiAccordion-gutters mui-ifi55z"><div class="MuiButtonBase-root MuiAccordionSummary-root MuiAccordionSummary-gutters mui-1ev8i4f" tabindex="0" role="button" aria-expanded="false" aria-controls="panel1bh-content" id="panel1bh-header"><div class="MuiAccordionSummary-content MuiAccordionSummary-contentGutters mui-l0jafl"><p class="MuiTypography-root MuiTypography-body1 mui-h8owmt">Bad Solution: Synchronous Replication</p></div><div class="MuiAccordionSummary-expandIconWrapper mui-awtdfi"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium mui-10dohqv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ExpandMoreIcon"><path d="M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"></path></svg></div></div><div class="MuiCollapse-root MuiCollapse-vertical MuiCollapse-hidden mui-a0y2e3" style="min-height: 0px;"><div class="MuiCollapse-wrapper MuiCollapse-vertical mui-hboir5"><div class="MuiCollapse-wrapperInner MuiCollapse-vertical mui-8atqhb"><div aria-labelledby="panel1bh-header" id="panel1bh-content" role="region" class="MuiAccordion-region"><div class="MuiAccordionDetails-root mui-u7qq7e"><h6 class="MuiTypography-root MuiTypography-body1 mui-1quhbks" id="approach">Approach</h6><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">The simplest approach is to maintain a few replicas of each shard. When a write comes in, we update all replicas synchronously and only respond once all replicas have acknowledged the write. While straightforward, this approach can impact write latency and availability if any replica is slow or down.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Synchronous replication is preferred for caches that need strong consistency guarantees (which ours does not).</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag"><div class="MuiBox-root mui-10khgmf" style="cursor: pointer;"><div class="MuiGrid-root MuiGrid-container MuiGrid-direction-xs-column mui-1tdxmx0"><div class="MuiGrid-root MuiGrid-item mui-tolxbf"><div class="relative w-full"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeSmall mui-wksd04" tabindex="0" type="button" aria-label="zoom-in"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium mui-10dohqv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ZoomInIcon"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"></path><path d="M12 10h-2v2H9v-2H7V9h2V7h1v2h2z"></path></svg><span class="MuiTouchRipple-root mui-w0pj6f"></span></button><span class="w-full h-full"><span class="block"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 540.7544513977628 724.7610524762589">
  <!-- svg-source:excalidraw -->
  <!-- payload-type:application/vnd.excalidraw+json --><!-- payload-version:2 -->
  <defs>
    <style class="style-fonts">
      
      
      
    </style>
    
  </defs>
  <rect x="0" y="0" width="540.7544513977628" height="724.7610524762589" fill="#ffffff"></rect><g stroke-linecap="round" transform="translate(12.126198454226426 306.4280365682023) rotate(0 46.552734375 44.4140625)"><path d="M22.21 0 C38.98 -0.04, 57.48 0.83, 70.9 0 M22.21 0 C39.6 0.26, 55.74 1.1, 70.9 0 M70.9 0 C86.39 -0.41, 91.18 5.55, 93.11 22.21 M70.9 0 C84.48 -0.72, 93.44 8.51, 93.11 22.21 M93.11 22.21 C93.19 30.46, 94.22 41.64, 93.11 66.62 M93.11 22.21 C93.77 38.89, 93.09 53.51, 93.11 66.62 M93.11 66.62 C91.28 83.35, 85.8 90.48, 70.9 88.83 M93.11 66.62 C95.39 82.42, 85.41 88.65, 70.9 88.83 M70.9 88.83 C54.22 86.74, 41.13 89.43, 22.21 88.83 M70.9 88.83 C55.65 88.64, 38.35 88.6, 22.21 88.83 M22.21 88.83 C7.23 89.93, -1.72 83.11, 0 66.62 M22.21 88.83 C7 91.07, 0.11 82.99, 0 66.62 M0 66.62 C1.78 53.31, 1.03 45.07, 0 22.21 M0 66.62 C-0.19 54.42, -0.21 44.56, 0 22.21 M0 22.21 C-0.4 8.88, 8.63 1.9, 22.21 0 M0 22.21 C-1.94 7.9, 8.12 0.4, 22.21 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(36.467018766726426 338.3420990682023) rotate(0 22.2119140625 12.5)"><text x="22.2119140625" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">client</text></g><g stroke-linecap="round"><g transform="translate(114.73887292732724 352.2898162058822) rotate(0 105.67422881884198 -108.03879081940775)"><path d="M0.64 0.5 C36.02 -35.46, 177.16 -180.75, 212.42 -216.86 M-0.49 -0.28 C34.82 -36.02, 176.64 -179.97, 212.04 -215.74" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(114.73887292732724 352.2898162058822) rotate(0 105.67422881884198 -108.03879081940775)"><path d="M12.96 -26.85 C9.75 -16.52, 3.78 -8.37, 0.64 0.5 M12.96 -26.85 C9.75 -18.92, 4.82 -11.61, 0.64 0.5" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(114.73887292732724 352.2898162058822) rotate(0 105.67422881884198 -108.03879081940775)"><path d="M27.66 -12.53 C20.02 -6.56, 9.51 -2.83, 0.64 0.5 M27.66 -12.53 C20.09 -8.69, 10.85 -5.59, 0.64 0.5" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(114.73887292732724 352.2898162058822) rotate(0 105.67422881884198 -108.03879081940775)"><path d="M199.54 -188.47 C204.49 -195.18, 206.21 -203.93, 212.04 -215.74 M199.54 -188.47 C203.49 -196.79, 205.86 -205.52, 212.04 -215.74" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(114.73887292732724 352.2898162058822) rotate(0 105.67422881884198 -108.03879081940775)"><path d="M184.93 -202.89 C194.27 -205.21, 200.51 -209.5, 212.04 -215.74 M184.93 -202.89 C193.21 -207.08, 199.87 -211.58, 212.04 -215.74" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(348.0768042125779 10) rotate(0 88.23450257863317 98.93473203061866)"><path d="M32 0 C70.39 0.48, 111.27 -0.54, 144.47 0 M32 0 C73.53 -0.69, 116.45 -0.08, 144.47 0 M144.47 0 C166.1 0.96, 174.77 12.49, 176.47 32 M144.47 0 C166.5 -0.37, 174.97 11.48, 176.47 32 M176.47 32 C178.27 74.77, 178.76 115.65, 176.47 165.87 M176.47 32 C175.29 65.48, 176.24 97.74, 176.47 165.87 M176.47 165.87 C176.21 187.05, 166.32 199.81, 144.47 197.87 M176.47 165.87 C175.4 186.28, 163.66 200.14, 144.47 197.87 M144.47 197.87 C105 198.93, 67.76 196.43, 32 197.87 M144.47 197.87 C109.51 199.33, 76.1 199.46, 32 197.87 M32 197.87 C10.76 199.23, -0.88 187.54, 0 165.87 M32 197.87 C10.66 200, -2.22 188.47, 0 165.87 M0 165.87 C0.89 116.43, -1.2 68.18, 0 32 M0 165.87 C0.88 119.46, -0.57 71.37, 0 32 M0 32 C0.62 11.01, 12.09 -0.25, 32 0 M0 32 C2.1 12.04, 9.77 1.49, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(365.2713592814454 96.43473203061865) rotate(0 71.03994750976562 12.5)"><text x="71.03994750976562" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">cache replica 1</text></g><g stroke-linecap="round" transform="translate(354.28544624049647 266.1605515537334) rotate(0 88.23450257863317 98.93473203061865)"><path d="M32 0 C75.65 0.42, 115.78 -2.19, 144.47 0 M32 0 C55.47 0.83, 77.79 1.26, 144.47 0 M144.47 0 C166.41 -0.32, 175.16 11.38, 176.47 32 M144.47 0 C166.16 1.35, 178.55 11.83, 176.47 32 M176.47 32 C176.36 73.84, 179.4 119.44, 176.47 165.87 M176.47 32 C177.67 83.11, 178.06 135.35, 176.47 165.87 M176.47 165.87 C175.54 186.4, 163.94 199.84, 144.47 197.87 M176.47 165.87 C177.43 187.89, 164.66 196.66, 144.47 197.87 M144.47 197.87 C101.68 197.2, 59.86 195.66, 32 197.87 M144.47 197.87 C101.33 199.64, 57.66 199.13, 32 197.87 M32 197.87 C10.66 199.72, -1.93 188.3, 0 165.87 M32 197.87 C12.05 196.82, -2.16 187.52, 0 165.87 M0 165.87 C2.28 133.43, 2.69 103.03, 0 32 M0 165.87 C1.44 113.15, 1.84 59.96, 0 32 M0 32 C1.83 11.86, 9.88 1.3, 32 0 M0 32 C-0.51 11.12, 12.76 0.16, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(367.07000527664917 352.59528358435205) rotate(0 75.44994354248047 12.5)"><text x="75.44994354248047" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">cache replica 2</text></g><g stroke-linecap="round" transform="translate(352.1198173717044 516.8915884150216) rotate(0 88.23450257863317 98.93473203061865)"><path d="M32 0 C67.76 0.02, 106.59 1.37, 144.47 0 M32 0 C71.44 -1.18, 109.61 -0.67, 144.47 0 M144.47 0 C166.11 1.17, 178.28 11.68, 176.47 32 M144.47 0 C166.41 1.73, 175.51 9.38, 176.47 32 M176.47 32 C179.41 61.9, 178.62 87.57, 176.47 165.87 M176.47 32 C176.35 70.74, 175.88 111.27, 176.47 165.87 M176.47 165.87 C177.3 187.8, 164.81 196.82, 144.47 197.87 M176.47 165.87 C178.33 187.36, 164.79 197.94, 144.47 197.87 M144.47 197.87 C113.39 196.56, 80.89 197, 32 197.87 M144.47 197.87 C103.08 198.98, 60.73 198.61, 32 197.87 M32 197.87 C11.87 196.96, -1.87 187.48, 0 165.87 M32 197.87 C9.27 195.79, -1.43 188.44, 0 165.87 M0 165.87 C0.91 126.72, -0.55 91.58, 0 32 M0 165.87 C-0.03 123.97, -1.34 81.53, 0 32 M0 32 C-0.44 11.06, 12.49 0.14, 32 0 M0 32 C-1.92 11.95, 9.69 0.59, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(365.21437396645086 603.3263204456402) rotate(0 75.13994598388672 12.5)"><text x="75.13994598388672" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">cache replica 3</text></g><g stroke-linecap="round"><g transform="translate(129.18200924822537 355.41539850323966) rotate(0 103.14104964115734 8.460231459951899)"><path d="M0.18 0.58 C34.49 3.64, 170.85 15.32, 205.26 18.01 M-1.19 -0.17 C33.55 2.62, 172.9 13.44, 207.44 16.46" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(129.18200924822537 355.41539850323966) rotate(0 103.14104964115734 8.460231459951899)"><path d="M29.14 -7.24 C22.93 -6.96, 16.64 -2.73, 0.18 0.58 M29.14 -7.24 C21.02 -4.33, 13.55 -2.19, 0.18 0.58" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(129.18200924822537 355.41539850323966) rotate(0 103.14104964115734 8.460231459951899)"><path d="M27.39 13.21 C21.67 8.44, 15.82 7.62, 0.18 0.58 M27.39 13.21 C19.9 10.31, 12.92 6.64, 0.18 0.58" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(129.18200924822537 355.41539850323966) rotate(0 103.14104964115734 8.460231459951899)"><path d="M178.51 24.39 C186.63 20.7, 194.63 21.04, 207.44 16.46 M178.51 24.39 C186.93 22.62, 195.89 20.29, 207.44 16.46" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(129.18200924822537 355.41539850323966) rotate(0 103.14104964115734 8.460231459951899)"><path d="M180.18 3.94 C187.83 5.29, 195.41 10.68, 207.44 16.46 M180.18 3.94 C187.99 7.98, 196.48 11.46, 207.44 16.46" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(124.01781733033641 373.93033542544094) rotate(0 104.40234997133302 123.2147633865003)"><path d="M-1.02 1.09 C33.81 42.03, 174.33 205.27, 209.17 246.24 M0.65 0.62 C35.34 41.7, 173.43 206.98, 208.41 247.67" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(124.01781733033641 373.93033542544094) rotate(0 104.40234997133302 123.2147633865003)"><path d="M25.12 15.81 C18.65 11.56, 8.28 5.02, -1.02 1.09 M25.12 15.81 C17.23 11.53, 7.82 6.84, -1.02 1.09" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(124.01781733033641 373.93033542544094) rotate(0 104.40234997133302 123.2147633865003)"><path d="M9.55 29.17 C7.91 20.85, 2.44 10.1, -1.02 1.09 M9.55 29.17 C6.86 20.32, 2.68 11.14, -1.02 1.09" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(124.01781733033641 373.93033542544094) rotate(0 104.40234997133302 123.2147633865003)"><path d="M182.37 232.77 C192.45 238.29, 198.51 241.06, 208.41 247.67 M182.37 232.77 C192.04 238.13, 200.13 243.37, 208.41 247.67" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(124.01781733033641 373.93033542544094) rotate(0 104.40234997133302 123.2147633865003)"><path d="M198.04 219.52 C203.26 229.07, 204.38 236.02, 208.41 247.67 M198.04 219.52 C202.47 229.41, 205.31 239.11, 208.41 247.67" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(10 514.3200179659793) rotate(0 111.32991027832028 25)"><text x="111.32991027832031" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#868e96" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">write to all, </text><text x="111.32991027832031" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#868e96" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">wait for all to confirm</text></g></svg></span></span></div></div><div class="MuiGrid-root MuiGrid-item mui-1wxaqej"><span class="MuiTypography-root MuiTypography-caption mui-17cupi8">Synchronous Replication</span></div></div></div></div><h6 class="MuiTypography-root MuiTypography-body1 mui-1quhbks" id="challenges">Challenges</h6><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">The main drawbacks of this stem from its synchronous nature. Write operations must wait for confirmation from all replicas before completing, which can significantly impact latency. If any replica becomes unavailable, the entire system's availability suffers since writes cannot proceed without full consensus. Additionally, as you add more replicas to the system, these problems compound - each new replica increases the likelihood of delays or failures, making it difficult to scale the system horizontally.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">For our use case at least, this is not a good fit. We need to prioritize availability and performance over consistency.</div></div></div></div></div></div></div><div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation0 MuiAccordion-root MuiAccordion-rounded MuiAccordion-gutters mui-nhbct3"><div class="MuiButtonBase-root MuiAccordionSummary-root MuiAccordionSummary-gutters mui-guv1gb" tabindex="0" role="button" aria-expanded="false" aria-controls="panel1bh-content" id="panel1bh-header"><div class="MuiAccordionSummary-content MuiAccordionSummary-contentGutters mui-l0jafl"><p class="MuiTypography-root MuiTypography-body1 mui-h8owmt">Good Solution: Asynchronous Replication</p></div><div class="MuiAccordionSummary-expandIconWrapper mui-awtdfi"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium mui-10dohqv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ExpandMoreIcon"><path d="M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"></path></svg></div></div><div class="MuiCollapse-root MuiCollapse-vertical MuiCollapse-hidden mui-a0y2e3" style="min-height: 0px;"><div class="MuiCollapse-wrapper MuiCollapse-vertical mui-hboir5"><div class="MuiCollapse-wrapperInner MuiCollapse-vertical mui-8atqhb"><div aria-labelledby="panel1bh-header" id="panel1bh-content" role="region" class="MuiAccordion-region"><div class="MuiAccordionDetails-root mui-u7qq7e"><h6 class="MuiTypography-root MuiTypography-body1 mui-1quhbks" id="approach-1">Approach</h6><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Another option is to update one primary copy immediately and then propagate changes to replicas asynchronously -- confirming the write once only the primary has acknowledged the change. This aligns well with the eventual consistency model that most caches adopt (and is a non-functional requirement for us), making it more suitable for a cache with our requirements than synchronous replication.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">The asynchronous nature provides several key advantages. First, it enables better write performance since we don't need to wait for replica acknowledgement. It also offers higher availability, as writes can proceed even when replicas are down. The system scales better with additional replicas since they don't impact write latency. Finally, it's a natural fit for cache use cases where some staleness is acceptable.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag"><div class="MuiBox-root mui-10khgmf" style="cursor: pointer;"><div class="MuiGrid-root MuiGrid-container MuiGrid-direction-xs-column mui-1tdxmx0"><div class="MuiGrid-root MuiGrid-item mui-tolxbf"><div class="relative w-full"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeSmall mui-wksd04" tabindex="0" type="button" aria-label="zoom-in"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium mui-10dohqv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ZoomInIcon"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"></path><path d="M12 10h-2v2H9v-2H7V9h2V7h1v2h2z"></path></svg><span class="MuiTouchRipple-root mui-w0pj6f"></span></button><span class="w-full h-full"><span class="block"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 836.2516255395881 598.4234170041336">
  <!-- svg-source:excalidraw -->
  <!-- payload-type:application/vnd.excalidraw+json --><!-- payload-version:2 -->
  <defs>
    <style class="style-fonts">
      
      
      
    </style>
    
  </defs>
  <rect x="0" y="0" width="836.2516255395881" height="598.4234170041336" fill="#ffffff"></rect><g stroke-linecap="round" transform="translate(10 255.75598947498335) rotate(0 46.552734375 44.4140625)"><path d="M22.21 0 C40.91 -0.78, 58.2 1.21, 70.9 0 M22.21 0 C32.74 -0.64, 44.36 0.05, 70.9 0 M70.9 0 C84.2 -0.43, 94.43 7.36, 93.11 22.21 M70.9 0 C87.98 -2.24, 90.84 7.97, 93.11 22.21 M93.11 22.21 C92.77 35.51, 92.21 51.36, 93.11 66.62 M93.11 22.21 C93.49 39.44, 93.42 54.47, 93.11 66.62 M93.11 66.62 C91.73 79.83, 84.84 88.71, 70.9 88.83 M93.11 66.62 C94.96 79.57, 85.04 89.5, 70.9 88.83 M70.9 88.83 C52.07 86.81, 33.12 89.68, 22.21 88.83 M70.9 88.83 C57.33 89.22, 40.97 87.61, 22.21 88.83 M22.21 88.83 C7.89 88.53, 1.16 79.5, 0 66.62 M22.21 88.83 C6.95 86.97, -1.19 81.87, 0 66.62 M0 66.62 C1.49 47.95, -1.09 33.37, 0 22.21 M0 66.62 C-0.92 52.94, 0.26 39.42, 0 22.21 M0 22.21 C1.82 7.57, 5.66 1.19, 22.21 0 M0 22.21 C-0.81 7.79, 9.42 1.75, 22.21 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(30.922760009765625 287.6700519749834) rotate(0 25.629974365234375 12.5)"><text x="25.629974365234375" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">client</text></g><g stroke-linecap="round"><g transform="translate(112.52969360351562 301.6253166269664) rotate(0 111.64130833579787 1.5168346264314607)"><path d="M0.92 -0.76 C38.27 -0.35, 186.92 3, 223.78 3.55 M-0.05 1.45 C37.2 2.02, 185.69 1.34, 223.1 1.69" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(112.52969360351562 301.6253166269664) rotate(0 111.64130833579787 1.5168346264314607)"><path d="M29.31 -10.47 C20.26 -6.73, 14.52 -6.85, 0.92 -0.76 M29.31 -10.47 C21.19 -8.12, 15.32 -5.44, 0.92 -0.76" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(112.52969360351562 301.6253166269664) rotate(0 111.64130833579787 1.5168346264314607)"><path d="M28.91 10.05 C19.79 8.1, 14.16 2.29, 0.92 -0.76 M28.91 10.05 C21.08 7.13, 15.31 4.55, 0.92 -0.76" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(112.52969360351562 301.6253166269664) rotate(0 111.64130833579787 1.5168346264314607)"><path d="M194.89 11.9 C201.34 9.69, 211.28 4.05, 223.1 1.69 M194.89 11.9 C201.46 9, 210.11 6.57, 223.1 1.69" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(112.52969360351562 301.6253166269664) rotate(0 111.64130833579787 1.5168346264314607)"><path d="M194.92 -8.62 C201.55 -5.15, 211.48 -5.1, 223.1 1.69 M194.92 -8.62 C201.31 -6.26, 209.94 -3.43, 223.1 1.69" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(647.2018729465601 10) rotate(0 88.23450257863317 98.93473203061866)"><path d="M32 0 C69.99 0.2, 107.32 -1.71, 144.47 0 M32 0 C54.53 -0.16, 77.14 -1.24, 144.47 0 M144.47 0 C164.96 -0.76, 177.88 10.31, 176.47 32 M144.47 0 C167.94 1.07, 178.26 11.56, 176.47 32 M176.47 32 C174.69 63.63, 177.16 93.88, 176.47 165.87 M176.47 32 C175.94 68.12, 176.55 103.67, 176.47 165.87 M176.47 165.87 C175.08 188.15, 165.78 199.43, 144.47 197.87 M176.47 165.87 C175.13 189.46, 167.37 195.97, 144.47 197.87 M144.47 197.87 C122.34 195.77, 97.51 196.08, 32 197.87 M144.47 197.87 C115.58 198.35, 89.17 198.04, 32 197.87 M32 197.87 C9.14 198.81, 0.26 187.94, 0 165.87 M32 197.87 C11.55 196.14, 0.48 188.18, 0 165.87 M0 165.87 C-2.96 119.02, -1.92 70.13, 0 32 M0 165.87 C-2.01 113.64, -0.97 62.87, 0 32 M0 32 C0.48 11.23, 8.7 0.86, 32 0 M0 32 C-0.89 12.79, 12.66 -1.68, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(661.9164246584941 96.43473203061868) rotate(0 73.51995086669922 12.5)"><text x="73.51995086669922" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Replica cache 1</text></g><g stroke-linecap="round" transform="translate(352.15924778627004 215.4885044605144) rotate(0 88.23450257863317 98.93473203061865)"><path d="M32 0 C69.72 -0.88, 109.69 2.01, 144.47 0 M32 0 C69.62 0.93, 106.73 0.49, 144.47 0 M144.47 0 C167.24 1.13, 174.51 8.89, 176.47 32 M144.47 0 C166.27 -1.71, 178.1 12.67, 176.47 32 M176.47 32 C174.79 79.91, 176.37 128.98, 176.47 165.87 M176.47 32 C176.39 79.7, 175.57 127.86, 176.47 165.87 M176.47 165.87 C174.87 189.06, 166.9 198.52, 144.47 197.87 M176.47 165.87 C177.67 187.29, 165.24 198.24, 144.47 197.87 M144.47 197.87 C104.62 198.32, 66.46 197.13, 32 197.87 M144.47 197.87 C112.72 197.01, 82.49 196.8, 32 197.87 M32 197.87 C9.71 197.93, 0.17 188.85, 0 165.87 M32 197.87 C12.87 199.83, 2.13 187.13, 0 165.87 M0 165.87 C-0.8 135.75, 1.21 105.55, 0 32 M0 165.87 C-0.3 120.25, -1.21 76.06, 0 32 M0 32 C1.97 9.97, 9.75 -0.33, 32 0 M0 32 C1.56 11.14, 11.39 2.13, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(374.68379705679774 301.923236491133) rotate(0 65.70995330810547 12.5)"><text x="65.70995330810547" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Leader cache</text></g><g stroke-linecap="round" transform="translate(649.7826203823217 390.55395294289633) rotate(0 88.23450257863317 98.93473203061865)"><path d="M32 0 C70.09 1.18, 111.28 -0.28, 144.47 0 M32 0 C56.69 -1.63, 82.17 -0.61, 144.47 0 M144.47 0 C165.32 -1.8, 175.43 12.02, 176.47 32 M144.47 0 C167.1 0.59, 174.8 9.54, 176.47 32 M176.47 32 C176.81 79.74, 176.43 128.57, 176.47 165.87 M176.47 32 C178.23 86.2, 178.54 138.15, 176.47 165.87 M176.47 165.87 C175.53 187.87, 164.25 199.82, 144.47 197.87 M176.47 165.87 C174.85 188.49, 167.23 199, 144.47 197.87 M144.47 197.87 C119.32 197.18, 90.62 198.22, 32 197.87 M144.47 197.87 C105.87 198.51, 66.03 196.92, 32 197.87 M32 197.87 C12.29 198.56, 1.93 188.53, 0 165.87 M32 197.87 C12.58 199.36, -1.31 188.11, 0 165.87 M0 165.87 C0.69 118.26, 2.98 69.36, 0 32 M0 165.87 C0.19 134.59, 0.66 102.88, 0 32 M0 32 C-0.93 10.1, 9.54 0.41, 32 0 M0 32 C1.31 11.88, 12.08 -1.3, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(660.0871760615408 476.988684973515) rotate(0 77.92994689941406 12.5)"><text x="77.92994689941406" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Replica cache 2</text></g><g stroke-linecap="round"><g transform="translate(536.6891453735933 317.4343282930978) rotate(0 47.0062255859375 -91.88438415527344)"><path d="M-0.63 0.36 C15.03 -30.16, 77.87 -152.89, 93.69 -183.41 M1.25 -0.5 C16.74 -31.36, 77.17 -154.66, 92.57 -185.34" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(536.6891453735933 317.4343282930978) rotate(0 47.0062255859375 -91.88438415527344)"><path d="M89.25 -155.52 C90.85 -164.32, 91.78 -171.6, 92.57 -185.34 M89.25 -155.52 C90.07 -167.07, 92.11 -178.95, 92.57 -185.34" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(536.6891453735933 317.4343282930978) rotate(0 47.0062255859375 -91.88438415527344)"><path d="M70.86 -164.63 C77.53 -170.8, 83.57 -175.56, 92.57 -185.34 M70.86 -164.63 C78.71 -172.7, 87.84 -181.08, 92.57 -185.34" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(536.4828465454683 335.82806608606654) rotate(0 51.37030029296875 83.58130021385779)"><path d="M-0.91 -0.94 C16.21 27.22, 85.21 140.37, 102.67 168.36 M0.82 1.19 C17.77 29.09, 84.54 139.02, 101.68 166.86" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(536.4828465454683 335.82806608606654) rotate(0 51.37030029296875 83.58130021385779)"><path d="M78.23 148.15 C83.55 153.76, 94.06 161.28, 101.68 166.86 M78.23 148.15 C85.24 154.22, 91.03 159.83, 101.68 166.86" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(536.4828465454683 335.82806608606654) rotate(0 51.37030029296875 83.58130021385779)"><path d="M95.74 137.45 C95.81 146.11, 101.12 156.8, 101.68 166.86 M95.74 137.45 C97.81 146.43, 98.58 155.11, 101.68 166.86" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(564.8656590454683 295.2390157930978) rotate(0 122.55988311767578 25)"><text x="122.55988311767578" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#868e96" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Asyncronounsly propogate</text><text x="122.55988311767578" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#868e96" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">changes to replicas</text></g></svg></span></span></div></div><div class="MuiGrid-root MuiGrid-item mui-1wxaqej"><span class="MuiTypography-root MuiTypography-caption mui-17cupi8">Asynchronous Replication</span></div></div></div></div><h6 class="MuiTypography-root MuiTypography-body1 mui-1quhbks" id="challenges-1">Challenges</h6><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">The main trade-offs come from the asynchronous nature. Replicas may temporarily have stale data until changes fully propagate through the system. Since all writes go through a single primary node, there's no need for complex conflict resolution - the primary node determines the order of all updates. However, failure recovery becomes more complex since we need to track which updates may have been missed while replicas were down and ensure they get properly synchronized when they come back online. Additionally, if the primary node fails, we need a mechanism to promote one of the replicas to become the new primary, which can introduce complexity and potential downtime during the failover process.</div></div></div></div></div></div></div><div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation0 MuiAccordion-root MuiAccordion-rounded MuiAccordion-gutters mui-nhbct3"><div class="MuiButtonBase-root MuiAccordionSummary-root MuiAccordionSummary-gutters mui-guv1gb" tabindex="0" role="button" aria-expanded="false" aria-controls="panel1bh-content" id="panel1bh-header"><div class="MuiAccordionSummary-content MuiAccordionSummary-contentGutters mui-l0jafl"><p class="MuiTypography-root MuiTypography-body1 mui-h8owmt">Good Solution: Peer-to-Peer Replication</p></div><div class="MuiAccordionSummary-expandIconWrapper mui-awtdfi"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium mui-10dohqv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ExpandMoreIcon"><path d="M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"></path></svg></div></div><div class="MuiCollapse-root MuiCollapse-vertical MuiCollapse-hidden mui-a0y2e3" style="min-height: 0px;"><div class="MuiCollapse-wrapper MuiCollapse-vertical mui-hboir5"><div class="MuiCollapse-wrapperInner MuiCollapse-vertical mui-8atqhb"><div aria-labelledby="panel1bh-header" id="panel1bh-content" role="region" class="MuiAccordion-region"><div class="MuiAccordionDetails-root mui-u7qq7e"><h6 class="MuiTypography-root MuiTypography-body1 mui-1quhbks" id="approach-2">Approach</h6><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">In peer-to-peer replication, each node is equal and can accept both reads and writes. Changes are propagated to other nodes using <a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover mui-pvpazu" href="https://en.wikipedia.org/wiki/Gossip_protocol" target="_blank" rel="noopener noreferrer" style="color: rgb(99, 115, 129); cursor: pointer; font-weight: 600; text-decoration: underline;">gossip protocols</a>, where nodes periodically exchange information about their state with randomly selected peers.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">This provides scalability and availability since there's no single point of failure. When a node receives a write, it can process it immediately and then asynchronously propagate the change to its peers. The gossip protocol ensures that changes eventually reach all nodes in the cluster.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag"><div class="MuiBox-root mui-10khgmf" style="cursor: pointer;"><div class="MuiGrid-root MuiGrid-container MuiGrid-direction-xs-column mui-1tdxmx0"><div class="MuiGrid-root MuiGrid-item mui-tolxbf"><div class="relative w-full"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeSmall mui-wksd04" tabindex="0" type="button" aria-label="zoom-in"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium mui-10dohqv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ZoomInIcon"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"></path><path d="M12 10h-2v2H9v-2H7V9h2V7h1v2h2z"></path></svg><span class="MuiTouchRipple-root mui-w0pj6f"></span></button><span class="w-full h-full"><span class="block"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 661.2749137452513 937.5560997690758">
  <!-- svg-source:excalidraw -->
  <!-- payload-type:application/vnd.excalidraw+json --><!-- payload-version:2 -->
  <defs>
    <style class="style-fonts">
      
      
      
    </style>
    
  </defs>
  <rect x="0" y="0" width="661.2749137452513" height="937.5560997690758" fill="#ffffff"></rect><g stroke-linecap="round" transform="translate(10 422.69349495022067) rotate(0 46.552734375 44.4140625)"><path d="M22.21 0 C39.83 -0.79, 53 1.65, 70.9 0 M22.21 0 C40.25 0.6, 56.64 0.29, 70.9 0 M70.9 0 C87.68 1.43, 92.44 6.18, 93.11 22.21 M70.9 0 C86.94 2.01, 93.64 5.34, 93.11 22.21 M93.11 22.21 C93.38 37.81, 94.86 59.17, 93.11 66.62 M93.11 22.21 C92.64 39.04, 94 55.57, 93.11 66.62 M93.11 66.62 C94.32 79.52, 84.09 89.3, 70.9 88.83 M93.11 66.62 C93.74 82.76, 84.38 89.64, 70.9 88.83 M70.9 88.83 C55.95 89.59, 44.74 90.52, 22.21 88.83 M70.9 88.83 C51.55 89.57, 32.77 89.03, 22.21 88.83 M22.21 88.83 C7.93 86.86, -1.11 82.67, 0 66.62 M22.21 88.83 C8.15 88.65, 1.66 79.65, 0 66.62 M0 66.62 C0.81 53.34, -1.06 42, 0 22.21 M0 66.62 C-0.48 55.82, -0.7 43.97, 0 22.21 M0 22.21 C-1.23 9.09, 7.2 -0.49, 22.21 0 M0 22.21 C1.48 6.62, 5.11 1.35, 22.21 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(34.3408203125 454.60755745022067) rotate(0 22.2119140625 12.5)"><text x="22.2119140625" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">client</text></g><g stroke-linecap="round"><g transform="translate(112.61267447310081 459.35083420601836) rotate(0 106.40510452433824 -148.2384625096781)"><path d="M1.07 0.69 C36.45 -48.74, 176.46 -247.73, 211.87 -297.2" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(112.61267447310081 459.35083420601836) rotate(0 106.40510452433824 -148.2384625096781)"><path d="M8.97 -28.25 C7.85 -22.03, 3.4 -11.48, 1.07 0.69" stroke="#1e1e1e" stroke-width="2.5" fill="none"></path></g><g transform="translate(112.61267447310081 459.35083420601836) rotate(0 106.40510452433824 -148.2384625096781)"><path d="M25.72 -16.4 C20.21 -13.19, 11.28 -5.8, 1.07 0.69" stroke="#1e1e1e" stroke-width="2.5" fill="none"></path></g><g transform="translate(112.61267447310081 459.35083420601836) rotate(0 106.40510452433824 -148.2384625096781)"><path d="M203.94 -268.27 C207.36 -277.61, 207.12 -282.5, 211.87 -297.2" stroke="#1e1e1e" stroke-width="2.5" fill="none"></path></g><g transform="translate(112.61267447310081 459.35083420601836) rotate(0 106.40510452433824 -148.2384625096781)"><path d="M187.2 -280.14 C195.02 -286.47, 199.25 -288.18, 211.87 -297.2" stroke="#1e1e1e" stroke-width="2.5" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(347.412357169344 10) rotate(0 88.23450257863317 98.93473203061866)"><path d="M32 0 C74.54 2.15, 120.1 0.12, 144.47 0 M32 0 C65.41 -1.41, 100.02 0.07, 144.47 0 M144.47 0 C166.27 -1.8, 178.38 11.22, 176.47 32 M144.47 0 C166.47 0.17, 174.21 12.54, 176.47 32 M176.47 32 C178.91 82.97, 178.54 138.13, 176.47 165.87 M176.47 32 C176.47 84.28, 177.55 136.66, 176.47 165.87 M176.47 165.87 C175.32 187.91, 165.25 196.2, 144.47 197.87 M176.47 165.87 C175.47 185.26, 166.92 198.27, 144.47 197.87 M144.47 197.87 C100.81 198.11, 56.68 199.24, 32 197.87 M144.47 197.87 C110.05 197.38, 77.06 196.68, 32 197.87 M32 197.87 C12.11 196.32, -0.19 185.67, 0 165.87 M32 197.87 C11.6 198.41, -0.44 185.59, 0 165.87 M0 165.87 C2.51 116.69, 0.96 68.07, 0 32 M0 165.87 C0.73 136.41, 1.47 107.1, 0 32 M0 32 C-1.99 11.84, 10.17 0.03, 32 0 M0 32 C1.96 10.85, 9 1.72, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(375.69080506047715 96.43473203061865) rotate(0 59.9560546875 12.5)"><text x="59.9560546875" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">cache replica 1</text></g><g stroke-linecap="round" transform="translate(352.2582205380561 360.10393560935825) rotate(0 88.23450257863317 98.93473203061865)"><path d="M32 0 C72.88 2.4, 115.18 -0.24, 144.47 0 M32 0 C59.11 -1.88, 86.71 -0.71, 144.47 0 M144.47 0 C166.39 0.15, 174.5 12.3, 176.47 32 M144.47 0 C167.91 1.51, 177.83 12.47, 176.47 32 M176.47 32 C179.04 63.59, 175.36 91.14, 176.47 165.87 M176.47 32 C176.26 75.7, 176.56 117.86, 176.47 165.87 M176.47 165.87 C175.6 185.51, 166.77 198.22, 144.47 197.87 M176.47 165.87 C178.66 189.44, 166.25 198.78, 144.47 197.87 M144.47 197.87 C110.64 199.04, 74.8 197.41, 32 197.87 M144.47 197.87 C104.46 197.01, 62.92 197.02, 32 197.87 M32 197.87 C11.48 198.34, -0.38 185.8, 0 165.87 M32 197.87 C12.04 196.62, -0.15 189.25, 0 165.87 M0 165.87 C-1.79 131.23, 1.53 98.87, 0 32 M0 165.87 C-1.86 129.61, -1.11 92.19, 0 32 M0 32 C1.7 10.82, 9.22 1.5, 32 0 M0 32 C1.86 8.42, 10.38 0.26, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(380.53666842918926 446.5386676399769) rotate(0 59.9560546875 12.5)"><text x="59.9560546875" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">cache replica 2</text></g><g stroke-linecap="round" transform="translate(350.8886488379186 729.6866357078385) rotate(0 88.23450257863317 98.93473203061865)"><path d="M32 0 C75.64 1.45, 123.47 0.84, 144.47 0 M32 0 C55.93 -0.24, 78.3 0.5, 144.47 0 M144.47 0 C167.64 1.31, 177.65 12.23, 176.47 32 M144.47 0 C164.12 1.37, 177.92 12.71, 176.47 32 M176.47 32 C175.67 80.81, 176.36 127.37, 176.47 165.87 M176.47 32 C175.66 76.04, 176.58 121.95, 176.47 165.87 M176.47 165.87 C178.37 189.15, 166.19 198.66, 144.47 197.87 M176.47 165.87 C176.49 188.46, 167.13 197.89, 144.47 197.87 M144.47 197.87 C109.03 197.9, 70.95 198.69, 32 197.87 M144.47 197.87 C119.84 197.24, 94.2 196.3, 32 197.87 M32 197.87 C11.86 196.78, -0.13 188.98, 0 165.87 M32 197.87 C9.51 198.14, -1.68 185.32, 0 165.87 M0 165.87 C-1.62 135.26, -1.8 100.08, 0 32 M0 165.87 C1.18 117.93, -0.39 70.58, 0 32 M0 32 C1.62 8.72, 10.42 0.23, 32 0 M0 32 C-1.52 12.12, 11.39 -0.53, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(379.16709672905176 816.1213677384571) rotate(0 59.9560546875 12.5)"><text x="59.9560546875" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">cache replica 3</text></g><g stroke-linecap="round"><g transform="translate(127.05581079399894 472.2475783758098) rotate(0 103.19053601705036 0.7865281058452922)"><path d="M0.28 -1.08 C34.76 -0.93, 173.12 1.45, 207.53 1.91" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(127.05581079399894 472.2475783758098) rotate(0 103.19053601705036 0.7865281058452922)"><path d="M28.61 -10.94 C16.88 -5.48, 9.22 -3.32, 0.28 -1.08" stroke="#1e1e1e" stroke-width="2.5" fill="none"></path></g><g transform="translate(127.05581079399894 472.2475783758098) rotate(0 103.19053601705036 0.7865281058452922)"><path d="M28.32 9.58 C16.52 7.79, 8.95 2.69, 0.28 -1.08" stroke="#1e1e1e" stroke-width="2.5" fill="none"></path></g><g transform="translate(127.05581079399894 472.2475783758098) rotate(0 103.19053601705036 0.7865281058452922)"><path d="M179.18 11.73 C187.32 10.1, 199.7 5.3, 207.53 1.91" stroke="#1e1e1e" stroke-width="2.5" fill="none"></path></g><g transform="translate(127.05581079399894 472.2475783758098) rotate(0 103.19053601705036 0.7865281058452922)"><path d="M179.5 -8.78 C187.71 -3.16, 199.97 -0.7, 207.53 1.91" stroke="#1e1e1e" stroke-width="2.5" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(121.89161887610999 503.58256244222173) rotate(0 104.84986493155333 157.05606335700793)"><path d="M1.15 0.33 C36.11 52.88, 175.49 261.74, 210.05 314.2" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(121.89161887610999 503.58256244222173) rotate(0 104.84986493155333 157.05606335700793)"><path d="M25.32 18.11 C18.22 13.18, 10.01 4.89, 1.15 0.33" stroke="#1e1e1e" stroke-width="2.5" fill="none"></path></g><g transform="translate(121.89161887610999 503.58256244222173) rotate(0 104.84986493155333 157.05606335700793)"><path d="M8.24 29.48 C6.77 20.72, 4.07 8.75, 1.15 0.33" stroke="#1e1e1e" stroke-width="2.5" fill="none"></path></g><g transform="translate(121.89161887610999 503.58256244222173) rotate(0 104.84986493155333 157.05606335700793)"><path d="M185.91 296.39 C194.11 302.5, 201.5 305.71, 210.05 314.2" stroke="#1e1e1e" stroke-width="2.5" fill="none"></path></g><g transform="translate(121.89161887610999 503.58256244222173) rotate(0 104.84986493155333 157.05606335700793)"><path d="M203.01 285.04 C205.58 294.98, 207.45 301.86, 210.05 314.2" stroke="#1e1e1e" stroke-width="2.5" fill="none"></path></g></g><mask></mask><g transform="translate(47.90638713092676 636.4909286229041) rotate(0 68.0499496459961 25)"><text x="68.0499496459961" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#868e96" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">write to ANY </text><text x="68.0499496459961" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#868e96" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">of the nodes</text></g><g stroke-linecap="round"><g transform="translate(431.8923134414057 340.34031516340696) rotate(0 0 -56.53155211207917)"><path d="M-0.39 -0.06 C-0.6 -18.73, -0.19 -93.86, -0.07 -112.51 M1.61 -1.14 C1.13 -20.12, -0.75 -95.58, -1.06 -114.35" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(431.8923134414057 340.34031516340696) rotate(0 0 -56.53155211207917)"><path d="M-10.6 -28.27 C-6.78 -17.19, -1.71 -5.37, -0.39 -0.06 M-10.6 -28.27 C-7.33 -17.42, -2.45 -5.5, -0.39 -0.06" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(431.8923134414057 340.34031516340696) rotate(0 0 -56.53155211207917)"><path d="M9.92 -28.23 C5.61 -17.23, 2.55 -5.43, -0.39 -0.06 M9.92 -28.23 C5.2 -17.35, 2.1 -5.44, -0.39 -0.06" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(431.8923134414057 340.34031516340696) rotate(0 0 -56.53155211207917)"><path d="M9.8 -86.38 C5.51 -97.62, 2.23 -108.06, -1.06 -114.35 M9.8 -86.38 C4.43 -97.34, 1.11 -107.28, -1.06 -114.35" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(431.8923134414057 340.34031516340696) rotate(0 0 -56.53155211207917)"><path d="M-10.71 -85.94 C-6.88 -97.29, -2.03 -107.9, -1.06 -114.35 M-10.71 -85.94 C-8.1 -97.12, -3.43 -107.24, -1.06 -114.35" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(432.5383180233241 704.2106316979672) rotate(0 0 -56.53155211207917)"><path d="M-0.28 -0.01 C-0.18 -18.73, 0.2 -93.29, 0.33 -112.08 M1.77 -1.07 C1.76 -20.13, -0.15 -95.32, -0.45 -113.69" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(432.5383180233241 704.2106316979672) rotate(0 0 -56.53155211207917)"><path d="M-10.39 -28.26 C-7.56 -19.86, -3.1 -11.79, -0.28 -0.01 M-10.39 -28.26 C-7.03 -18.81, -4.35 -9.38, -0.28 -0.01" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(432.5383180233241 704.2106316979672) rotate(0 0 -56.53155211207917)"><path d="M10.13 -28.15 C7.27 -19.83, 6.04 -11.79, -0.28 -0.01 M10.13 -28.15 C6.81 -18.77, 2.81 -9.37, -0.28 -0.01" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(432.5383180233241 704.2106316979672) rotate(0 0 -56.53155211207917)"><path d="M10.41 -85.72 C7.32 -92.96, 5.96 -100.48, -0.45 -113.69 M10.41 -85.72 C6.9 -94.61, 2.74 -103.47, -0.45 -113.69" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(432.5383180233241 704.2106316979672) rotate(0 0 -56.53155211207917)"><path d="M-10.11 -85.29 C-7.51 -92.6, -3.18 -100.24, -0.45 -113.69 M-10.11 -85.29 C-6.94 -94.28, -4.42 -103.29, -0.45 -113.69" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(467.4150809815794 261.0725843812057) rotate(0 91.92991638183594 25)"><text x="91.92991638183594" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#868e96" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Propogate changes</text><text x="91.92991638183594" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#868e96" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge"> to other nodes</text></g></svg></span></span></div></div><div class="MuiGrid-root MuiGrid-item mui-1wxaqej"><span class="MuiTypography-root MuiTypography-caption mui-17cupi8">Peer-to-Peer Replication</span></div></div></div></div><h6 class="MuiTypography-root MuiTypography-body1 mui-1quhbks" id="challenges-2">Challenges</h6><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">While peer-to-peer replication offers great scalability and availability, it comes with some significant challenges. The implementation is more complex than other approaches since each node needs to maintain connections with multiple peers and handle conflict resolution. The eventual consistency model means that different nodes may temporarily have different values for the same key. Additionally, careful consideration must be given to conflict resolution strategies when concurrent updates occur at different nodes.</div></div></div></div></div></div></div></div><div class="my-6"><div class="MuiBox-root mui-1ygn9bx"><div class="MuiBox-root mui-14185gn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-6 h-6 heroicon-sw-2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"></path></svg></div><div class="MuiBox-root mui-79elbk"><div style="overflow: hidden; max-height: 300px;"><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">All of the above approaches could be good depending on your specific use case and constraints. Redis, for example, uses asynchronous replication by default, though it does provide a <span class="MuiBox-root mui-1vu004u">WAIT</span> command that allows clients to wait for replica acknowledgement if needed (sometimes called "semi-synchronous" behavior). Other distributed systems allow you to configure the replication type in order to choose the right trade-offs for your workload.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">In your interview, I'd discuss the options with your interviewer. It's likely they care less about you making a decision here and more about seeing that you're aware of the options and trade-offs.</div></div></div></div></div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Given our requirements, I'd discuss two options with my interviewer:</div><ol style="list-style: outside decimal;">
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">Asynchronous replication for a good balance of availability and simplicity</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">Peer-to-peer for maximum scalability</div></li>
</ol><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">The reality is, there is no single right answer here.</div><h3 class="MuiTypography-root MuiTypography-h4 mui-hkpafq" id="2-how-do-we-ensure-our-cache-is-scalable">2) How do we ensure our cache is scalable?</h3><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Designing a reliable, single-node cache is a good start, but it won't meet the lofty non-functional requirements of handling 1TB of data or sustaining 100k requests per second. We need to spread the load across multiple machines to maintain low latency and high availability as we grow. This is where scaling strategies come into play, and one of the core tactics is to distribute data and requests intelligently.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">We can't fit 1TB of data efficiently on a single node without hitting memory and performance limits. We need to splitâ€”or <strong>shard</strong>â€”our key-value pairs across multiple nodes. If done well, each node will hold a manageable portion of the dataset, allowing us to scale horizontally by simply adding more machines.</div><div class="my-6"><div class="MuiBox-root mui-1147lff"><div class="MuiBox-root mui-zvu67g"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-6 h-6 heroicon-sw-2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"></path></svg></div><div class="MuiBox-root mui-79elbk"><div style="overflow: hidden; max-height: 300px;"><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">What is the difference between partitioning and sharding? Technically, partitioning refers to splitting data within a single database/system, while sharding specifically means splitting data across multiple machines/nodes. However, you'll hear these terms used interchangeably in practice - when someone mentions "partitioning" in a distributed systems context, they very likely mean distributing data across different nodes (sharding). The key thing is to understand the core concept of splitting data, regardless of which term is used.</div></div></div></div></div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">We can estimate the number of nodes needed by considering both our throughput and storage requirements. Let's start with throughput. Let's assume we've benchmarked a single host to be able to perform 20,000 requests per second - we would need at least <span class="MuiBox-root mui-1vu004u">100,000 / 20,000 = 5</span> nodes to handle our throughput requirements. Adding some buffer for traffic spikes and potential node failures, we should plan for around 8 nodes minimum to handle our throughput needs.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">For storage requirements, we need to consider that a typical AWS instance with 32GB RAM can reliably use about 24GB for cache data after accounting for system overhead. Since we need to store 1TB (1024GB) of data, we would need approximately <span class="MuiBox-root mui-1vu004u">1024GB / 24GB = 43</span> nodes just for storage. Adding some buffer for data growth and operational overhead, we should plan for about 50 nodes.</div><div class="my-6"><div class="MuiBox-root mui-o9fqh4"><div class="MuiBox-root mui-3t6lyr"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-6 h-6 heroicon-sw-2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"></path></svg></div><div class="MuiBox-root mui-79elbk"><div style="overflow: hidden; max-height: 300px;"><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Note that the throughput (20k requests/second) and memory capacity (24GB usable from 32GB RAM) estimates used above are rough approximations for illustration. Actual performance will vary significantly based on hardware specs, cache configuration, access patterns, and the nature of your cached data. Always benchmark with your specific workload to determine true capacity needs.</div></div></div></div></div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Since our storage-based calculation (50 nodes) exceeds our throughput-based calculation (8 nodes), we should provision based on the storage needs. This higher node count actually works in our favor, as it gives us plenty of headroom for handling our throughput requirements. Of course, these are rough estimates and the actual numbers would vary based on several factors including our choice of instance types, the average size of our cached values, read/write ratio, replication requirements, and expected growth rate. But, for our purposes, we are going to say we'll have 50 nodes in our cluster!</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">So we have 50 nodes, but how do we know which node a given key-value pair should be stored on?</div><h3 class="MuiTypography-root MuiTypography-h4 mui-hkpafq" id="3-how-can-we-ensure-an-even-distribution-of-keys-across-our-nodes">3) How can we ensure an even distribution of keys across our nodes?</h3><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">The answer? Consistent hashing.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">I'm sure you've read about consistent hashing before, but let's quickly review the core concept.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Without consistent hashing, the naive solution would be to use a simple modulo operation to determine which node a key-value pair should be stored on. For example, if you had 4 nodes, you could use <span class="MuiBox-root mui-1vu004u">hash(key) % 4</span> and the result would be the node number that that key-value pair should be stored on.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">This works great when you have a fixed number of nodes, but what happens when you add or remove a node?</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Consistent hashing is a technique that helps us distribute keys across our cache nodes while minimizing the number of keys that need to be remapped when nodes are added or removed. Instead of using simple modulo arithmetic (which would require remapping most keys when the number of nodes changes), consistent hashing arranges both nodes and keys in a circular keyspace.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">So, instead of using <span class="MuiBox-root mui-1vu004u">hash(key) % 4</span>, we use a consistent hashing function like <a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover mui-pvpazu" href="https://en.wikipedia.org/wiki/MurmurHash" target="_blank" rel="noopener noreferrer" style="color: rgb(99, 115, 129); cursor: pointer; font-weight: 600; text-decoration: underline;">MurmurHash</a> to get a position on the circle. Given that position, we move clockwise around the circle until we find the first node. That is the node that should store the key-value pair on!</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag"><div class="MuiBox-root mui-10khgmf" style="cursor: pointer;"><div class="MuiGrid-root MuiGrid-container MuiGrid-direction-xs-column mui-1tdxmx0"><div class="MuiGrid-root MuiGrid-item mui-tolxbf"><div class="relative w-full"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeSmall mui-wksd04" tabindex="0" type="button" aria-label="zoom-in"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium mui-10dohqv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ZoomInIcon"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"></path><path d="M12 10h-2v2H9v-2H7V9h2V7h1v2h2z"></path></svg><span class="MuiTouchRipple-root mui-w0pj6f"></span></button><span class="w-full h-full"><span class="block"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1258.786415121505 941.4797615612865">
  <!-- svg-source:excalidraw -->
  <!-- payload-type:application/vnd.excalidraw+json --><!-- payload-version:2 -->
  <defs>
    <style class="style-fonts">
      
      
      
    </style>
    
  </defs>
  <rect x="0" y="0" width="1258.786415121505" height="941.4797615612865" fill="#ffffff"></rect><g stroke-linecap="round" transform="translate(156.06143906969237 159.1413152200248) rotate(0 311.15629960823435 313.5150513542821)"><path d="M406.77 15.8 C428.64 17.74, 449.55 32.95, 468.93 44.2 C488.31 55.46, 506.74 68.2, 523.04 83.32 C539.34 98.43, 554.01 116.45, 566.74 134.92 C579.46 153.4, 590.86 173.33, 599.39 194.17 C607.92 215, 614.05 237.76, 617.92 259.93 C621.8 282.09, 623.8 304.93, 622.65 327.18 C621.51 349.43, 616.91 371.78, 611.08 393.41 C605.24 415.05, 597.9 436.97, 587.62 457 C577.34 477.04, 563.68 496.35, 549.38 513.62 C535.08 530.89, 519.31 546.66, 501.82 560.63 C484.32 574.59, 464.66 587.56, 444.42 597.43 C424.17 607.3, 402.08 615.01, 380.35 619.84 C358.63 624.68, 336.31 626.27, 314.08 626.43 C291.85 626.58, 268.83 625.22, 246.97 620.78 C225.11 616.34, 203.09 608.93, 182.91 599.78 C162.74 590.63, 143.79 579.3, 125.92 565.88 C108.06 552.45, 90.48 536.22, 75.73 519.23 C60.98 502.25, 47.86 483.79, 37.41 463.95 C26.97 444.1, 19.06 421.78, 13.06 400.17 C7.06 378.55, 3 356.81, 1.42 334.25 C-0.17 311.7, 0.35 287.06, 3.56 264.86 C6.78 242.66, 12.65 221.8, 20.68 201.06 C28.72 180.32, 39.31 159.41, 51.78 140.43 C64.24 121.44, 79.47 102.87, 95.48 87.17 C111.5 71.47, 129.07 57.85, 147.87 46.23 C166.67 34.6, 187.06 24.86, 208.29 17.42 C229.53 9.98, 252.93 4.35, 275.27 1.58 C297.61 -1.19, 318.14 -2.1, 342.34 0.79 C366.53 3.69, 405.75 13.87, 420.43 18.95 C435.11 24.03, 432.31 26.13, 430.42 31.28 M264.47 4.68 C284.88 -3.43, 311.48 -1.59, 333.71 -0.11 C355.94 1.36, 376.51 6.83, 397.84 13.52 C419.18 20.21, 442.11 29.39, 461.73 40.03 C481.34 50.68, 498.78 62.94, 515.56 77.38 C532.35 91.82, 549.23 108.58, 562.44 126.65 C575.64 144.73, 585.88 165.36, 594.81 185.84 C603.74 206.31, 611.36 227.54, 615.99 249.5 C620.62 271.46, 622.94 294.81, 622.59 317.58 C622.25 340.35, 618.95 364.05, 613.92 386.14 C608.9 408.23, 602.25 430.12, 592.42 450.13 C582.6 470.13, 569 488.64, 554.97 506.17 C540.95 523.7, 525.08 540.71, 508.26 555.32 C491.44 569.93, 473.85 583.74, 454.05 593.83 C434.25 603.91, 410.93 610.12, 389.47 615.84 C368 621.55, 347.5 626.97, 325.25 628.13 C303.01 629.28, 277.98 626.83, 255.99 622.78 C234.01 618.72, 213.8 612.3, 193.35 603.81 C172.9 595.31, 151.63 584.69, 133.29 571.8 C114.96 558.92, 98.59 543.08, 83.34 526.5 C68.08 509.92, 53.01 491.91, 41.78 472.32 C30.55 452.72, 22.67 430.52, 15.97 408.91 C9.27 387.31, 4.09 365.13, 1.59 342.68 C-0.9 320.23, -1.66 296.35, 0.99 274.21 C3.64 252.07, 9.85 230.7, 17.49 209.84 C25.13 188.97, 34.83 168.01, 46.83 149.03 C58.82 130.05, 74.09 111.97, 89.48 95.94 C104.87 79.92, 120.54 65.57, 139.18 52.88 C157.82 40.18, 180.1 28.13, 201.33 19.78 C222.55 11.43, 255.78 4.3, 266.51 2.8 C277.24 1.3, 265.05 5.42, 265.7 10.78" stroke="#343a40" stroke-width="2" fill="none"></path></g><g stroke-linecap="round" transform="translate(402.8493928369671 10) rotate(0 65.94913579124659 61.686331430918244)"><path d="M60.43 1.12 C70.19 -0.69, 82.38 0.84, 91.75 4.39 C101.13 7.94, 110.17 15.03, 116.68 22.42 C123.2 29.81, 128.7 39.32, 130.85 48.72 C133 58.13, 132.33 69.62, 129.57 78.85 C126.81 88.07, 121.5 97.35, 114.29 104.06 C107.09 110.78, 96.08 116.16, 86.32 119.14 C76.55 122.13, 65.81 123.39, 55.69 121.97 C45.57 120.55, 33.81 116.33, 25.59 110.62 C17.37 104.9, 10.66 96.13, 6.38 87.7 C2.09 79.28, -0.4 69.38, -0.12 60.07 C0.16 50.75, 2.97 40.32, 8.06 31.82 C13.14 23.32, 21.42 14.28, 30.39 9.06 C39.37 3.84, 56.36 1.75, 61.89 0.53 C67.42 -0.7, 63.37 0.6, 63.58 1.71 M58.28 1.9 C67.62 0.03, 78.54 1.83, 88.1 4.85 C97.66 7.86, 108.97 13.21, 115.66 20 C122.36 26.78, 125.66 36.34, 128.26 45.56 C130.86 54.78, 133.26 65.81, 131.29 75.33 C129.31 84.85, 123.46 95.44, 116.41 102.66 C109.36 109.88, 98.61 115.4, 88.98 118.64 C79.35 121.88, 68.57 122.86, 58.63 122.11 C48.69 121.37, 37.92 119.19, 29.33 114.18 C20.75 109.17, 12.2 100.57, 7.13 92.07 C2.06 83.56, -0.85 72.75, -1.08 63.18 C-1.31 53.61, 0.78 43.27, 5.76 34.63 C10.74 25.99, 20.09 17.08, 28.79 11.33 C37.49 5.58, 53.21 1.96, 57.97 0.12 C62.74 -1.71, 57.48 -0.95, 57.37 0.34" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(455.38145091479953 49.0675081695951) rotate(0 13.28399658203125 22.5)"><text x="13.28399658203125" y="0" font-family="Virgil, Segoe UI Emoji" font-size="36px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">n1</text></g><g stroke-linecap="round" transform="translate(706.6416979127334 153.03484797385136) rotate(0 65.94913579124659 61.686331430918244)"><path d="M94.52 6.08 C103.7 9.23, 113.2 16.88, 119.34 24.62 C125.48 32.36, 129.75 43.02, 131.36 52.5 C132.96 61.98, 132.44 72.67, 128.97 81.51 C125.49 90.35, 118.03 99.06, 110.51 105.55 C103 112.04, 93.74 117.79, 83.87 120.46 C74 123.12, 61.31 123.51, 51.29 121.52 C41.26 119.53, 31.45 114.44, 23.72 108.53 C15.99 102.62, 8.91 94.64, 4.89 86.05 C0.87 77.46, -1.33 66.73, -0.42 57 C0.5 47.27, 4.78 35.77, 10.38 27.67 C15.98 19.58, 24.33 12.96, 33.18 8.42 C42.04 3.89, 52.09 0.15, 63.5 0.48 C74.9 0.8, 94.58 7.99, 101.63 10.36 C108.67 12.72, 106.5 13.82, 105.77 14.68 M95.31 5.9 C104.29 8.71, 111.1 16.61, 117.24 24.23 C123.38 31.86, 130.18 42.02, 132.12 51.66 C134.07 61.3, 132.55 73.03, 128.91 82.06 C125.27 91.09, 117.79 99.51, 110.28 105.84 C102.77 112.17, 93.45 117.13, 83.85 120.04 C74.25 122.95, 62.79 124.93, 52.7 123.31 C42.6 121.69, 31.37 116.46, 23.28 110.3 C15.19 104.14, 8.23 95.17, 4.16 86.35 C0.1 77.54, -2.31 67.06, -1.11 57.43 C0.09 47.79, 5.52 36.8, 11.38 28.53 C17.23 20.26, 25.32 12.77, 34.01 7.79 C42.71 2.8, 53.61 -1.31, 63.56 -1.4 C73.52 -1.5, 88.47 5.92, 93.74 7.2 C99.01 8.47, 95.67 5.38, 95.18 6.26" stroke="#343a40" stroke-width="2" fill="none"></path></g><g transform="translate(751.2357600799213 192.10235614344646) rotate(0 21.22199249267578 22.5)"><text x="21.22199249267578" y="0" font-family="Virgil, Segoe UI Emoji" font-size="36px" fill="#343a40" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">n2</text></g><g stroke-linecap="round" transform="translate(789.8729530481451 409.5491003566085) rotate(0 65.94913579124659 61.686331430918244)"><path d="M62.61 0.26 C72.3 -1.1, 84.91 1.59, 94.04 5.37 C103.18 9.15, 111.26 15.46, 117.42 22.96 C123.58 30.45, 129.28 40.83, 131.02 50.32 C132.77 59.82, 131.02 70.81, 127.89 79.92 C124.75 89.03, 119.36 98.08, 112.21 104.99 C105.07 111.9, 94.88 118.36, 85.01 121.38 C75.13 124.4, 63 125.1, 52.97 123.11 C42.93 121.12, 32.74 115.42, 24.81 109.42 C16.87 103.41, 9.52 95.64, 5.35 87.07 C1.17 78.51, -1.06 67.47, -0.23 58.02 C0.6 48.57, 4.99 38.51, 10.35 30.36 C15.71 22.21, 22.56 14.02, 31.92 9.11 C41.28 4.19, 59.83 2.18, 66.51 0.86 C73.18 -0.45, 71.81 0.24, 71.97 1.23 M65.25 -0.17 C75.24 -1.12, 86.67 2.92, 95.45 7.1 C104.22 11.28, 112 17.48, 117.9 24.91 C123.79 32.35, 129.08 41.98, 130.8 51.69 C132.52 61.41, 131.68 73.88, 128.23 83.2 C124.78 92.52, 117.73 101.2, 110.09 107.62 C102.44 114.04, 92.28 119.19, 82.36 121.71 C72.44 124.23, 60.18 124.87, 50.57 122.72 C40.95 120.57, 32.13 115.15, 24.69 108.81 C17.25 102.46, 9.95 93.72, 5.91 84.66 C1.88 75.6, -0.21 63.69, 0.49 54.45 C1.19 45.21, 4.36 37.14, 10.14 29.23 C15.93 21.33, 26.3 11.74, 35.2 7.02 C44.1 2.3, 58.52 1.65, 63.53 0.94 C68.55 0.22, 65.19 1.86, 65.29 2.73" stroke="#343a40" stroke-width="2" fill="none"></path></g><g transform="translate(835.0250138725595 448.61660852620355) rotate(0 20.663993835449276 22.5)"><text x="20.66399383544922" y="0" font-family="Virgil, Segoe UI Emoji" font-size="36px" fill="#343a40" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">n3</text></g><g stroke-linecap="round" transform="translate(682.6279000162112 692.0167266198414) rotate(0 65.94913579124659 61.686331430918244)"><path d="M70.99 -0.76 C80.66 -0.95, 93.13 3.9, 101.7 9.14 C110.26 14.39, 117.37 22.39, 122.38 30.71 C127.4 39.02, 131.32 49.27, 131.79 59.02 C132.25 68.77, 129.72 80.34, 125.18 89.19 C120.64 98.03, 112.74 106.59, 104.53 112.07 C96.33 117.54, 85.98 120.65, 75.95 122.05 C65.92 123.46, 54.06 123.41, 44.35 120.49 C34.65 117.58, 24.58 111.42, 17.71 104.57 C10.83 97.71, 5.86 88.57, 3.11 79.37 C0.35 70.17, -0.81 58.72, 1.15 49.36 C3.11 40, 8.16 30.68, 14.86 23.21 C21.57 15.75, 30.78 8.17, 41.39 4.59 C52.01 1, 71.56 2.03, 78.55 1.68 C85.54 1.34, 83.71 1.48, 83.34 2.49 M60.32 -0.25 C69.8 -2.03, 82.76 0.25, 92.32 4.38 C101.87 8.52, 111.4 16.79, 117.66 24.58 C123.91 32.37, 128.14 41.84, 129.85 51.12 C131.56 60.4, 130.99 71.15, 127.93 80.27 C124.87 89.39, 118.32 99.16, 111.5 105.84 C104.68 112.52, 96.39 117.66, 87.03 120.35 C77.68 123.04, 65.6 123.87, 55.38 121.97 C45.17 120.08, 34.08 114.57, 25.75 108.99 C17.42 103.42, 9.44 97.1, 5.41 88.51 C1.38 79.92, 1.01 67.04, 1.56 57.45 C2.11 47.86, 3.51 38.79, 8.69 30.97 C13.86 23.15, 23.83 15.68, 32.61 10.54 C41.39 5.41, 56.34 1.77, 61.36 0.15 C66.38 -1.47, 62.69 -0.23, 62.72 0.81" stroke="#343a40" stroke-width="2" fill="none"></path></g><g transform="translate(728.517959803028 731.0842347894364) rotate(0 19.925994873046875 22.5)"><text x="19.925994873046875" y="0" font-family="Virgil, Segoe UI Emoji" font-size="36px" fill="#343a40" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">n4</text></g><g stroke-linecap="round" transform="translate(415.49926477623467 808.10709869945) rotate(0 65.94913579124659 61.686331430918244)"><path d="M33.53 7.01 C41.55 1.87, 54.55 -0.64, 64.89 -0.59 C75.23 -0.53, 86.54 2.78, 95.56 7.33 C104.57 11.87, 113.04 19.14, 118.97 26.71 C124.91 34.28, 129.7 43.34, 131.15 52.75 C132.6 62.15, 131.18 73.96, 127.66 83.12 C124.14 92.28, 117.43 101.16, 110.04 107.69 C102.65 114.21, 93.18 119.85, 83.31 122.27 C73.45 124.69, 60.96 124.36, 50.86 122.21 C40.75 120.05, 30.24 115.65, 22.68 109.33 C15.13 103, 9.12 93.14, 5.53 84.23 C1.94 75.32, 0.23 65.49, 1.15 55.85 C2.07 46.22, 5.14 34.57, 11.06 26.43 C16.99 18.28, 31.86 10.3, 36.68 6.99 C41.49 3.68, 39.35 5.91, 39.97 6.57 M57.64 1.69 C67.06 -0.06, 78.69 1.53, 88.08 4.76 C97.47 7.99, 107.23 13.97, 113.98 21.07 C120.72 28.16, 125.69 38.2, 128.56 47.35 C131.43 56.51, 133.21 66.89, 131.2 75.98 C129.2 85.07, 123.42 94.91, 116.54 101.88 C109.65 108.85, 99.67 114.07, 89.88 117.79 C80.1 121.5, 67.76 125.17, 57.83 124.18 C47.89 123.18, 38.71 117.25, 30.25 111.82 C21.8 106.38, 11.95 99.63, 7.08 91.58 C2.22 83.53, 1.07 73.22, 1.08 63.51 C1.08 53.81, 2.44 42.17, 7.12 33.34 C11.81 24.52, 20.86 16.03, 29.2 10.56 C37.53 5.09, 52.35 2.16, 57.13 0.55 C61.9 -1.06, 57.59 -0.07, 57.87 0.91" stroke="#343a40" stroke-width="2" fill="none"></path></g><g transform="translate(461.785328286196 847.1746068690451) rotate(0 19.529991149902344 22.5)"><text x="19.529991149902344" y="0" font-family="Virgil, Segoe UI Emoji" font-size="36px" fill="#343a40" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">n5</text></g><g stroke-linecap="round" transform="translate(91.33430719506532 164.83571137803392) rotate(0 65.94913579124659 61.686331430918244)"><path d="M49.65 2.56 C58.72 -0.31, 70.76 0.51, 80.69 2.53 C90.63 4.56, 101.52 8.47, 109.26 14.7 C117.01 20.93, 123.55 30.83, 127.19 39.92 C130.82 49.01, 132.11 59.66, 131.08 69.23 C130.06 78.8, 126.79 89.48, 121.05 97.37 C115.31 105.25, 105.82 112.08, 96.65 116.56 C87.48 121.04, 76.06 124.28, 66.03 124.23 C56.01 124.18, 45.41 120.7, 36.51 116.27 C27.62 111.85, 18.67 105.66, 12.66 97.69 C6.65 89.73, 1.94 77.95, 0.47 68.48 C-0.99 59, 0.3 49.59, 3.86 40.84 C7.42 32.1, 13.76 22.74, 21.81 16.03 C29.87 9.32, 46.91 2.92, 52.2 0.59 C57.49 -1.74, 53.51 0.91, 53.55 2.06 M90.49 5.4 C99.74 8.07, 108.7 16, 115.55 23.27 C122.41 30.54, 129.19 39.84, 131.65 49 C134.11 58.15, 133.3 69.22, 130.34 78.19 C127.38 87.16, 121.18 95.61, 113.88 102.81 C106.57 110, 95.98 118.18, 86.51 121.34 C77.05 124.5, 67.17 123.32, 57.07 121.77 C46.96 120.23, 34.13 117.38, 25.88 112.05 C17.62 106.72, 11.89 98.58, 7.55 89.81 C3.2 81.04, -0.58 69.33, -0.21 59.44 C0.15 49.55, 4.7 38.76, 9.74 30.48 C14.77 22.19, 21.54 14.91, 30 9.73 C38.45 4.55, 50.16 0.26, 60.48 -0.59 C70.79 -1.44, 86.82 3.36, 91.89 4.63 C96.96 5.9, 91.26 5.87, 90.9 7.03" stroke="#343a40" stroke-width="2" fill="none"></path></g><g transform="translate(134.9743669818821 203.90321954762902) rotate(0 22.175994873046875 22.5)"><text x="22.175994873046875" y="0" font-family="Virgil, Segoe UI Emoji" font-size="36px" fill="#343a40" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">n8</text></g><g stroke-linecap="round" transform="translate(10 428.39069562926943) rotate(0 65.94913579124659 61.686331430918244)"><path d="M87.9 2.98 C97.43 5.09, 107.2 13.06, 114.09 20.25 C120.99 27.44, 126.46 36.81, 129.26 46.12 C132.06 55.43, 133.14 66.79, 130.92 76.11 C128.7 85.43, 122.71 94.76, 115.94 102.03 C109.18 109.3, 99.62 116.28, 90.34 119.75 C81.06 123.23, 70.25 123.86, 60.26 122.87 C50.27 121.89, 39.09 119.25, 30.41 113.86 C21.72 108.47, 13.27 98.87, 8.15 90.51 C3.04 82.15, -0.06 73.03, -0.28 63.69 C-0.51 54.35, 2.1 43.27, 6.79 34.46 C11.49 25.64, 19.62 16.48, 27.88 10.8 C36.14 5.11, 45.77 1.32, 56.38 0.37 C66.99 -0.59, 84.87 3.92, 91.53 5.08 C98.19 6.24, 96.56 6.51, 96.32 7.33 M79.03 0.89 C89.13 1.43, 99.77 7.04, 107.65 12.72 C115.53 18.4, 122.38 25.98, 126.31 34.97 C130.24 43.96, 131.64 57.04, 131.23 66.68 C130.81 76.32, 129.13 84.69, 123.82 92.81 C118.51 100.94, 108.18 110.1, 99.37 115.42 C90.56 120.74, 81.08 124.32, 70.95 124.74 C60.81 125.16, 47.89 122.2, 38.57 117.93 C29.25 113.66, 21.35 106.65, 15.02 99.13 C8.68 91.61, 2.56 82.25, 0.57 72.81 C-1.42 63.37, -0.11 51.64, 3.07 42.47 C6.26 33.3, 12.48 24.25, 19.67 17.81 C26.86 11.37, 36.4 6.44, 46.22 3.82 C56.03 1.21, 73.55 2.46, 78.57 2.11 C83.6 1.77, 76.85 0.92, 76.36 1.76" stroke="#343a40" stroke-width="2" fill="none"></path></g><g transform="translate(57.726058321973056 467.4582037988645) rotate(0 18.08999633789061 22.5)"><text x="18.089996337890625" y="0" font-family="Virgil, Segoe UI Emoji" font-size="36px" fill="#343a40" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">n7</text></g><g stroke-linecap="round" transform="translate(110.5098221426083 675.3846849406282) rotate(0 65.94913579124659 61.686331430918244)"><path d="M46.49 3.09 C55.65 -0.33, 68.96 0.23, 79.01 2.03 C89.06 3.82, 98.95 7.92, 106.79 13.86 C114.63 19.81, 121.73 29.06, 126.04 37.71 C130.34 46.35, 133.16 56.24, 132.63 65.74 C132.1 75.25, 128.39 86.73, 122.87 94.73 C117.36 102.73, 108.5 108.89, 99.53 113.76 C90.57 118.64, 79.29 123.29, 69.07 124 C58.86 124.71, 47.38 122.27, 38.24 118.01 C29.1 113.75, 20.46 106.11, 14.21 98.45 C7.96 90.78, 2.67 81.3, 0.73 72.04 C-1.22 62.77, -0.75 52, 2.54 42.84 C5.84 33.68, 11.84 24.19, 20.51 17.1 C29.19 10, 47.73 3.06, 54.61 0.29 C61.49 -2.47, 61.6 -0.76, 61.79 0.5 M63.24 -1.39 C72.64 -2.42, 83.99 2.9, 93.45 7.07 C102.9 11.23, 113.83 16.04, 119.98 23.6 C126.13 31.17, 128.74 42.66, 130.36 52.47 C131.97 62.28, 132.79 73.55, 129.66 82.47 C126.53 91.4, 118.91 99.72, 111.56 106.03 C104.21 112.33, 95.4 117.61, 85.56 120.31 C75.72 123.01, 62.68 124.15, 52.5 122.23 C42.33 120.32, 32.31 114.87, 24.51 108.81 C16.7 102.75, 9.77 94.33, 5.69 85.86 C1.6 77.4, -0.82 67.31, 0.02 58.01 C0.87 48.7, 5.51 38.36, 10.75 30.01 C15.99 21.66, 22.92 12.89, 31.46 7.91 C39.99 2.94, 56.54 1.05, 61.97 0.17 C67.39 -0.71, 63.92 1.77, 64.01 2.63" stroke="#343a40" stroke-width="2" fill="none"></path></g><g transform="translate(156.39988192942508 714.4521931102232) rotate(0 19.925994873046875 22.5)"><text x="19.925994873046875" y="0" font-family="Virgil, Segoe UI Emoji" font-size="36px" fill="#343a40" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">n6</text></g><g transform="translate(453.52703200733276 179.84433506335427) rotate(0 12.383995056152344 22.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="36px" fill="#868e96" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">0</text></g><g transform="translate(708.6203496033145 450.02798009490016) rotate(0 23.939987182617188 22.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="36px" fill="#868e96" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">25</text></g><g transform="translate(453.0324688065207 716.865826052187) rotate(0 23.50798797607422 22.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="36px" fill="#868e96" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">50</text></g><g transform="translate(183.75111736457984 460.1455381253463) rotate(0 20.80799102783203 22.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="36px" fill="#868e96" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">75</text></g><g transform="translate(655.6009320093244 276.8094272615572) rotate(0 17.693992614746094 22.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="36px" fill="#868e96" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">12</text></g><g transform="translate(646.174015879054 630.0609199280325) rotate(0 21.941993713378906 22.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="36px" fill="#868e96" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">37</text></g><g transform="translate(251.4430647031695 627.4819232900354) rotate(0 24.33599090576172 22.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="36px" fill="#868e96" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">62</text></g><g transform="translate(242.84663009654105 294.13772698629055) rotate(0 23.453994750976562 22.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="36px" fill="#868e96" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">87</text></g><g transform="translate(974.1066055511924 536.3301464229663) rotate(0 137.33990478515625 25)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#868e96" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">1. hash(key) = 28</text><text x="0" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#868e96" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">2. Find 28 on the hash ring</text></g><g stroke-linecap="round"><g transform="translate(962.7762012726719 569.2376017111028) rotate(0 -91.68700233567256 -0.40406830874894695)"><path d="M0.14 -0.37 C-30.53 -0.79, -152.7 -1.56, -183.4 -1.79 M-1.25 -1.6 C-32.13 -1.97, -153.7 -0.88, -184.36 -0.76" stroke="#868e96" stroke-width="2" fill="none"></path></g><g transform="translate(962.7762012726719 569.2376017111028) rotate(0 -91.68700233567256 -0.40406830874894695)"><path d="M-156.23 -11.21 C-166.6 -7.56, -177.45 -5.04, -184.36 -0.76 M-156.23 -11.21 C-162.41 -9.76, -169.72 -6.47, -184.36 -0.76" stroke="#868e96" stroke-width="2" fill="none"></path></g><g transform="translate(962.7762012726719 569.2376017111028) rotate(0 -91.68700233567256 -0.40406830874894695)"><path d="M-156.1 9.31 C-166.65 5.79, -177.54 1.14, -184.36 -0.76 M-156.1 9.31 C-162.26 6.18, -169.6 4.9, -184.36 -0.76" stroke="#868e96" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(785.9172878584891 598.1673879153046) rotate(0 -21.231979301816295 43.09894014485667)"><path d="M0.36 0.51 C-2.1 10.25, -8.18 43.99, -15.18 58.41 C-22.18 72.84, -37.2 82.27, -41.65 87.06 M-0.91 -0.27 C-3.47 9.13, -9.12 42.38, -15.97 56.62 C-22.82 70.86, -37.77 80.42, -41.99 85.17" stroke="#868e96" stroke-width="2" fill="none"></path></g><g transform="translate(785.9172878584891 598.1673879153046) rotate(0 -21.231979301816295 43.09894014485667)"><path d="M-32.79 67.87 C-34.43 73.03, -36.69 78.5, -41.99 85.17 M-32.79 67.87 C-36.04 74.59, -40.37 81.04, -41.99 85.17" stroke="#868e96" stroke-width="2" fill="none"></path></g><g transform="translate(785.9172878584891 598.1673879153046) rotate(0 -21.231979301816295 43.09894014485667)"><path d="M-23.82 77.84 C-27.86 80.35, -32.53 83.15, -41.99 85.17 M-23.82 77.84 C-30.45 80.92, -38.12 83.66, -41.99 85.17" stroke="#868e96" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(800.4819771257044 628.2492549098228) rotate(0 184.3798828125 25)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#868e96" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">3. Walk clockwise until we hit a node.</text><text x="0" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#868e96" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">4. Store data on that node! </text></g></svg></span></span></div></div><div class="MuiGrid-root MuiGrid-item mui-1wxaqej"><span class="MuiTypography-root MuiTypography-caption mui-17cupi8">Consistent Hashing</span></div></div></div></div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Why go through all this trouble?</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Because now if a node is added or removed, only the keys that fall within that node's range need to be remapped, rather than having to redistribute all keys across all nodes as would be the case if our modulo operation went from <span class="MuiBox-root mui-1vu004u">hash(key) % 4</span> to <span class="MuiBox-root mui-1vu004u">hash(key) % 5</span> or <span class="MuiBox-root mui-1vu004u">hash(key) % 3</span>.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">To read more about consistent hashing, I'd recommend checking out the <a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover mui-pvpazu" href="https://www.hellointerview.com/learn/system-design/deep-dives/cassandra#partitioning" target="_blank" rel="noopener noreferrer" style="color: rgb(99, 115, 129); cursor: pointer; font-weight: 600; text-decoration: underline;">Cassandra deep dive</a>.</div><h3 class="MuiTypography-root MuiTypography-h4 mui-hkpafq" id="4-what-happens-if-you-have-a-hot-key-that-is-being-read-from-a-lot">4) What happens if you have a hot key that is being read from a lot?</h3><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">You're bound to get the classic interview follow up question: What about hot keys?</div><div class="my-6"><div class="MuiBox-root mui-o9fqh4"><div class="MuiBox-root mui-3t6lyr"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-6 h-6 heroicon-sw-2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"></path></svg></div><div class="MuiBox-root mui-79elbk"><div style="overflow: hidden; max-height: 300px;"><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">To be honest, this is usually a property of the client or user of the cache, not the cache itself. Still, it comes up frequently in interviews, so it's best to be prepared with a thoughtful answer.</div></div></div></div></div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Hot keys are a common challenge in distributed caching systems. They occur when certain keys receive disproportionately high traffic compared to others - imagine a viral tweet's data or a flash sale product's inventory count. When too many requests concentrate on a single shard holding these popular keys, it creates a hotspot that can degrade performance for that entire shard.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">There are two distinct types of hot key problems we need to handle:</div><ol style="list-style: outside decimal;">
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0"><strong>Hot reads</strong>: Keys that receive an extremely high volume of read requests, like a viral tweet's data that millions of users are trying to view simultaneously</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0"><strong>Hot writes</strong>: Keys that receive many concurrent write requests, like a counter tracking real-time votes.</div></li>
</ol><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Let's first explore strategies for handling hot reads, then we'll discuss approaches for hot writes afterwards.</div><div class="my-6 flex flex-col gap-4"><div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation0 MuiAccordion-root MuiAccordion-rounded MuiAccordion-gutters mui-ifi55z"><div class="MuiButtonBase-root MuiAccordionSummary-root MuiAccordionSummary-gutters mui-1ev8i4f" tabindex="0" role="button" aria-expanded="false" aria-controls="panel1bh-content" id="panel1bh-header"><div class="MuiAccordionSummary-content MuiAccordionSummary-contentGutters mui-l0jafl"><p class="MuiTypography-root MuiTypography-body1 mui-h8owmt">Bad Solution: Vertical Scaling all Nodes</p></div><div class="MuiAccordionSummary-expandIconWrapper mui-awtdfi"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium mui-10dohqv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ExpandMoreIcon"><path d="M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"></path></svg></div></div><div class="MuiCollapse-root MuiCollapse-vertical MuiCollapse-hidden mui-a0y2e3" style="min-height: 0px;"><div class="MuiCollapse-wrapper MuiCollapse-vertical mui-hboir5"><div class="MuiCollapse-wrapperInner MuiCollapse-vertical mui-8atqhb"><div aria-labelledby="panel1bh-header" id="panel1bh-content" role="region" class="MuiAccordion-region"><div class="MuiAccordionDetails-root mui-u7qq7e"><h6 class="MuiTypography-root MuiTypography-body1 mui-1quhbks" id="approach-3">Approach</h6><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">The simplest approach is to scale up the hardware of all nodes in the cluster to handle hot keys. This means upgrading CPU, memory, and network capacity across the board. While straightforward, this treats all nodes equally regardless of their actual load.</div><h6 class="MuiTypography-root MuiTypography-body1 mui-1quhbks" id="challenges-3">Challenges</h6><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">This is an expensive and inefficient solution since we're upgrading resources for all nodes when only some are experiencing high load. It also doesn't address the root cause of hot keys and can still lead to bottlenecks if keys become extremely hot. The cost scales linearly with node count, making it unsustainable for large clusters.</div></div></div></div></div></div></div><div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation0 MuiAccordion-root MuiAccordion-rounded MuiAccordion-gutters mui-nhbct3"><div class="MuiButtonBase-root MuiAccordionSummary-root MuiAccordionSummary-gutters mui-guv1gb" tabindex="0" role="button" aria-expanded="false" aria-controls="panel1bh-content" id="panel1bh-header"><div class="MuiAccordionSummary-content MuiAccordionSummary-contentGutters mui-l0jafl"><p class="MuiTypography-root MuiTypography-body1 mui-h8owmt">Good Solution: Dedicated Hot Key Cache</p></div><div class="MuiAccordionSummary-expandIconWrapper mui-awtdfi"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium mui-10dohqv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ExpandMoreIcon"><path d="M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"></path></svg></div></div><div class="MuiCollapse-root MuiCollapse-vertical MuiCollapse-hidden mui-a0y2e3" style="min-height: 0px;"><div class="MuiCollapse-wrapper MuiCollapse-vertical mui-hboir5"><div class="MuiCollapse-wrapperInner MuiCollapse-vertical mui-8atqhb"><div aria-labelledby="panel1bh-header" id="panel1bh-content" role="region" class="MuiAccordion-region"><div class="MuiAccordionDetails-root mui-u7qq7e"><h6 class="MuiTypography-root MuiTypography-body1 mui-1quhbks" id="approach-4">Approach</h6><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">This strategy involves creating a separate caching layer specifically for handling hot keys. When a key is identified as "hot" through monitoring, it gets promoted to this specialized tier that uses more powerful hardware and is optimized for high throughput. This tier can be geographically distributed and placed closer to users for better performance.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag"><div class="MuiBox-root mui-10khgmf" style="cursor: pointer;"><div class="MuiGrid-root MuiGrid-container MuiGrid-direction-xs-column mui-1tdxmx0"><div class="MuiGrid-root MuiGrid-item mui-tolxbf"><div class="relative w-full"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeSmall mui-wksd04" tabindex="0" type="button" aria-label="zoom-in"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium mui-10dohqv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ZoomInIcon"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"></path><path d="M12 10h-2v2H9v-2H7V9h2V7h1v2h2z"></path></svg><span class="MuiTouchRipple-root mui-w0pj6f"></span></button><span class="w-full h-full"><span class="block"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 699.99512191358 1029.0176214810647">
  <!-- svg-source:excalidraw -->
  <!-- payload-type:application/vnd.excalidraw+json --><!-- payload-version:2 -->
  <defs>
    <style class="style-fonts">
      
      
      
    </style>
    
  </defs>
  <rect x="0" y="0" width="699.99512191358" height="1029.0176214810647" fill="#ffffff"></rect><g stroke-linecap="round" transform="translate(10 455.8241079311589) rotate(0 46.552734375 44.414062500000014)"><path d="M22.21 0 C32.56 -0.49, 45.42 -0.25, 70.9 0 M22.21 0 C36.49 -0.06, 51.73 1.03, 70.9 0 M70.9 0 C84.25 1.28, 91.82 6.06, 93.11 22.21 M70.9 0 C86.78 -1.1, 93.95 7.9, 93.11 22.21 M93.11 22.21 C92.43 38.59, 94.59 58.63, 93.11 66.62 M93.11 22.21 C93.5 33.84, 92.48 43.3, 93.11 66.62 M93.11 66.62 C92.69 80.93, 86.84 88.05, 70.9 88.83 M93.11 66.62 C94.28 82.77, 86.69 89.98, 70.9 88.83 M70.9 88.83 C57.92 90.85, 45.51 89.91, 22.21 88.83 M70.9 88.83 C53.03 89.03, 35.18 89.75, 22.21 88.83 M22.21 88.83 C7.53 87.64, 0.63 81.55, 0 66.62 M22.21 88.83 C5.61 90.51, -1.37 79.81, 0 66.62 M0 66.62 C-0.77 53.18, -1.82 39.24, 0 22.21 M0 66.62 C0.34 51.17, 1.09 37.67, 0 22.21 M0 22.21 C1.63 7.09, 6.29 -0.61, 22.21 0 M0 22.21 C-0.41 6.17, 5.38 0.84, 22.21 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(34.3408203125 487.7381704311589) rotate(0 22.2119140625 12.5)"><text x="22.2119140625" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">client</text></g><g stroke-linecap="round" transform="translate(457.7073192017277 316.5963010814334) rotate(0 88.23450257863317 98.93473203061868)"><path d="M32 0 C61 -1.31, 88.6 -1.13, 144.47 0 M32 0 C58.57 0.76, 85.38 0.42, 144.47 0 M144.47 0 C164.08 -0.62, 175.18 12.21, 176.47 32 M144.47 0 C167.04 -1.22, 178.24 12.04, 176.47 32 M176.47 32 C175.67 72.43, 176.86 114.81, 176.47 165.87 M176.47 32 C177.58 67.43, 176.71 102.25, 176.47 165.87 M176.47 165.87 C177.06 186.7, 167.68 197.43, 144.47 197.87 M176.47 165.87 C177.54 188.68, 164.1 199.53, 144.47 197.87 M144.47 197.87 C113.3 197.74, 78.66 198.24, 32 197.87 M144.47 197.87 C109.41 197.99, 75.69 199.31, 32 197.87 M32 197.87 C10.96 197.37, 0.53 185.65, 0 165.87 M32 197.87 C11.31 198.51, -0.85 187.44, 0 165.87 M0 165.87 C1.52 125.02, 0.88 79.8, 0 32 M0 165.87 C-0.64 130.17, -0.33 94.06, 0 32 M0 32 C1.01 9.1, 11.69 0.3, 32 0 M0 32 C1.78 12.2, 11.93 0.1, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(514.6918446685445 403.03103311205206) rotate(0 31.249977111816406 12.5)"><text x="31.249977111816406" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Cache1</text></g><g stroke-linecap="round" transform="translate(453.3926864555481 552.907110768365) rotate(0 88.23450257863317 98.93473203061865)"><path d="M32 0 C56.22 1.66, 82.16 1.46, 144.47 0 M32 0 C67.33 -0.18, 103.74 0.9, 144.47 0 M144.47 0 C166.88 -1.06, 178.01 11.86, 176.47 32 M144.47 0 C165.92 1.53, 174.25 8.72, 176.47 32 M176.47 32 C175.36 70.43, 177.31 107.68, 176.47 165.87 M176.47 32 C176.18 78.64, 176.82 125.56, 176.47 165.87 M176.47 165.87 C177.4 188.49, 164.33 199.31, 144.47 197.87 M176.47 165.87 C176.18 186.85, 165.26 199.19, 144.47 197.87 M144.47 197.87 C110.12 196.67, 76.98 197.03, 32 197.87 M144.47 197.87 C118.78 198.31, 93.07 197.79, 32 197.87 M32 197.87 C11.23 198.42, -0.74 187.41, 0 165.87 M32 197.87 C11.06 195.82, 2.12 187.57, 0 165.87 M0 165.87 C-0.4 114.44, -0.86 61.97, 0 32 M0 165.87 C1.27 120.03, 1.27 75.89, 0 32 M0 32 C1.55 12, 11.76 0.09, 32 0 M0 32 C-0.61 11.83, 9.89 1.12, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(505.96721588965 639.3418427989836) rotate(0 35.65997314453125 12.5)"><text x="35.65997314453125" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Cache2</text></g><g stroke-linecap="round" transform="translate(449.9061521067001 789.1493346391142) rotate(0 88.23450257863317 98.93473203061865)"><path d="M32 0 C71.46 1.54, 109.82 -2.13, 144.47 0 M32 0 C62.78 -1.4, 93.25 -0.27, 144.47 0 M144.47 0 C165.9 1.33, 174.54 8.97, 176.47 32 M144.47 0 C165.33 -0.57, 177.78 9.77, 176.47 32 M176.47 32 C178.26 78.11, 178.04 126.57, 176.47 165.87 M176.47 32 C178.2 69.46, 176.99 106.36, 176.47 165.87 M176.47 165.87 C176.21 186.9, 165.33 199.02, 144.47 197.87 M176.47 165.87 C176.62 185.83, 166.53 198.02, 144.47 197.87 M144.47 197.87 C118.07 197.49, 95.72 197.49, 32 197.87 M144.47 197.87 C113.82 197.28, 82.24 197.1, 32 197.87 M32 197.87 C11.01 196.08, 1.85 187.53, 0 165.87 M32 197.87 C12.54 197.51, -1.28 186.5, 0 165.87 M0 165.87 C1.45 126.97, 1.36 91.36, 0 32 M0 165.87 C0.09 136.84, -0.13 106.51, 0 32 M0 32 C-0.53 11.68, 9.99 0.98, 32 0 M0 32 C-0.43 10.42, 12.03 -1.53, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(502.7906790993958 875.5840666697328) rotate(0 35.3499755859375 12.5)"><text x="35.3499755859375" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Cache3</text></g><g stroke-linecap="round" transform="translate(405.3858404560326 271.75254999381747) rotate(0 142.30464072877368 373.63253574362363)"><path d="M32 0 C97.3 1.86, 166.24 -0.61, 252.61 0 M252.61 0 C274.78 -1.94, 283.37 12.64, 284.61 32 M284.61 32 C287.51 172.57, 286.65 313.55, 284.61 715.27 M284.61 715.27 C285.24 738.18, 273.56 745.86, 252.61 747.27 M252.61 747.27 C175.88 748.45, 102.31 749.19, 32 747.27 M32 747.27 C10.51 747.3, 0.41 735.44, 0 715.27 M0 715.27 C-0.67 526.2, -0.42 336.19, 0 32 M0 32 C-1.17 9.07, 11.05 -0.69, 32 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(453.2261885292569 227.83819881637072) rotate(0 88.29993438720703 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Main Cache Nodes</text></g><g stroke-linecap="round" transform="translate(393.49859197011574 10) rotate(0 145.44398147474806 87.3079068483107)"><path d="M32 0 C117.98 1.76, 206.32 0.42, 258.89 0 M32 0 C113.57 -1.55, 194.87 -2.45, 258.89 0 M258.89 0 C280.64 1.94, 289.97 11.01, 290.89 32 M258.89 0 C279.7 -0.87, 292.05 8.44, 290.89 32 M290.89 32 C289.96 64.9, 289.88 97.5, 290.89 142.62 M290.89 32 C291.13 71.93, 290.98 110.46, 290.89 142.62 M290.89 142.62 C292.37 164.26, 278.53 175.4, 258.89 174.62 M290.89 142.62 C289.24 166.25, 278.59 172.88, 258.89 174.62 M258.89 174.62 C195.63 173.85, 131.72 172.23, 32 174.62 M258.89 174.62 C173.83 173.33, 91.04 173.76, 32 174.62 M32 174.62 C9.42 175.66, -0.19 163.76, 0 142.62 M32 174.62 C9.48 176.07, 0.22 164.6, 0 142.62 M0 142.62 C-0.26 111.35, -1.8 77.93, 0 32 M0 142.62 C-0.43 99.07, -0.01 53.23, 0 32 M0 32 C0.99 10.47, 12.03 -1.67, 32 0 M0 32 C-1.1 10.32, 10.83 1.34, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(467.41262807132864 84.8079068483107) rotate(0 71.52994537353516 12.5)"><text x="71.52994537353516" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Hot Key Cache</text></g><g stroke-linecap="round"><g transform="translate(125.42365736491604 480.18729427874285) rotate(0 126.08349956569958 -185.54887740823978)"><path d="M-1.09 0.91 C41.09 -60.64, 209.81 -307.95, 251.93 -369.97 M0.53 0.34 C42.65 -61.46, 209.18 -309.78, 250.86 -371.51" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(125.42365736491604 480.18729427874285) rotate(0 126.08349956569958 -185.54887740823978)"><path d="M243.64 -342.39 C246.76 -348.56, 248.57 -354.91, 250.86 -371.51 M243.64 -342.39 C246.42 -349.97, 247.1 -359.32, 250.86 -371.51" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(125.42365736491604 480.18729427874285) rotate(0 126.08349956569958 -185.54887740823978)"><path d="M226.61 -353.84 C233.09 -357.56, 238.31 -361.61, 250.86 -371.51 M226.61 -353.84 C234.24 -357.98, 239.83 -364.03, 250.86 -371.51" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(82.99521224820899 270.7109589806519) rotate(0 71.19994354248047 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Read hot keys</text></g><g stroke-linecap="round"><g transform="translate(127.75449040137039 496.7362088375683) rotate(0 126.70991094424659 -0.9031978016259927)"><path d="M0.6 -0.17 C42.91 -0.39, 211.19 -1.66, 253.51 -1.89 M-0.54 -1.3 C41.65 -1.29, 210.13 -0.59, 252.61 -0.39" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(127.75449040137039 496.7362088375683) rotate(0 126.70991094424659 -0.9031978016259927)"><path d="M224.37 9.75 C231.75 7.02, 239.51 5.97, 252.61 -0.39 M224.37 9.75 C234.29 6.84, 241.84 3.89, 252.61 -0.39" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(127.75449040137039 496.7362088375683) rotate(0 126.70991094424659 -0.9031978016259927)"><path d="M224.46 -10.78 C231.72 -7.97, 239.46 -3.48, 252.61 -0.39 M224.46 -10.78 C234.55 -7.12, 242.08 -3.5, 252.61 -0.39" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(220.98781185954215 539.0990992751251) rotate(0 80.96993255615234 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Read other keys</text></g></svg></span></span></div></div><div class="MuiGrid-root MuiGrid-item mui-1wxaqej"><span class="MuiTypography-root MuiTypography-caption mui-17cupi8">Dedicated Hot Key Cache</span></div></div></div></div><h6 class="MuiTypography-root MuiTypography-body1 mui-1quhbks" id="challenges-4">Challenges</h6><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Managing consistency between the main cache and hot key cache adds complexity. We need sophisticated monitoring to identify hot keys and mechanisms to promote/demote keys between tiers. There's also additional operational overhead in maintaining a separate caching infrastructure. The system needs careful tuning to determine when keys should be promoted or demoted.</div></div></div></div></div></div></div><div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation0 MuiAccordion-root MuiAccordion-rounded MuiAccordion-gutters mui-nhbct3"><div class="MuiButtonBase-root MuiAccordionSummary-root MuiAccordionSummary-gutters mui-guv1gb" tabindex="0" role="button" aria-expanded="false" aria-controls="panel1bh-content" id="panel1bh-header"><div class="MuiAccordionSummary-content MuiAccordionSummary-contentGutters mui-l0jafl"><p class="MuiTypography-root MuiTypography-body1 mui-h8owmt">Good Solution: Read Replicas</p></div><div class="MuiAccordionSummary-expandIconWrapper mui-awtdfi"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium mui-10dohqv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ExpandMoreIcon"><path d="M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"></path></svg></div></div><div class="MuiCollapse-root MuiCollapse-vertical MuiCollapse-hidden mui-a0y2e3" style="min-height: 0px;"><div class="MuiCollapse-wrapper MuiCollapse-vertical mui-hboir5"><div class="MuiCollapse-wrapperInner MuiCollapse-vertical mui-8atqhb"><div aria-labelledby="panel1bh-header" id="panel1bh-content" role="region" class="MuiAccordion-region"><div class="MuiAccordionDetails-root mui-u7qq7e"><h6 class="MuiTypography-root MuiTypography-body1 mui-1quhbks" id="approach-5">Approach</h6><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">We talked about this in high availability with replication. As a refresher, this is where we create multiple copies of the same data across different nodes. It makes it easy to distribute read requests across the replicas.</div><h6 class="MuiTypography-root MuiTypography-body1 mui-1quhbks" id="challenges-5">Challenges</h6><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">While read replicas can effectively distribute read load, they come with significant overhead in terms of storage and network bandwidth since entire nodes need to be replicated. This approach also requires careful management of replication lag and consistency between primary and replica nodes. Additionally, the operational complexity increases as you need to maintain and monitor multiple copies of the same data, handle failover scenarios, and ensure proper synchronization across all replicas. This solution may be overkill if only a small subset of keys are actually experiencing high load.</div></div></div></div></div></div></div><div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation0 MuiAccordion-root MuiAccordion-rounded MuiAccordion-gutters mui-11r69q9"><div class="MuiButtonBase-root MuiAccordionSummary-root MuiAccordionSummary-gutters mui-3ujfba" tabindex="0" role="button" aria-expanded="false" aria-controls="panel1bh-content" id="panel1bh-header"><div class="MuiAccordionSummary-content MuiAccordionSummary-contentGutters mui-l0jafl"><p class="MuiTypography-root MuiTypography-body1 mui-h8owmt">Great Solution: Copies of Hot Keys</p></div><div class="MuiAccordionSummary-expandIconWrapper mui-awtdfi"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium mui-10dohqv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ExpandMoreIcon"><path d="M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"></path></svg></div></div><div class="MuiCollapse-root MuiCollapse-vertical MuiCollapse-hidden mui-a0y2e3" style="min-height: 0px;"><div class="MuiCollapse-wrapper MuiCollapse-vertical mui-hboir5"><div class="MuiCollapse-wrapperInner MuiCollapse-vertical mui-8atqhb"><div aria-labelledby="panel1bh-header" id="panel1bh-content" role="region" class="MuiAccordion-region"><div class="MuiAccordionDetails-root mui-u7qq7e"><h6 class="MuiTypography-root MuiTypography-body1 mui-1quhbks" id="approach-6">Approach</h6><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Unlike read replicas which copy entire nodes, this approach selectively copies only the specific keys that are experiencing high read traffic. The system creates multiple copies of hot keys across different nodes to distribute read load, making it a more targeted solution for handling specific traffic hotspots.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Here's how it works:</div><ol style="list-style: outside decimal;">
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">First, the system monitors key access patterns to detect hot keys that are frequently read</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">When a key becomes "hot", instead of having just one copy as <span class="MuiBox-root mui-1vu004u">user:123</span>, the system creates multiple copies with different suffixes:
<ul class="MuiList-root MuiList-padding mui-sedpvs">
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0"><span class="MuiBox-root mui-1vu004u">user:123#1</span> -&gt; Node A stores a copy</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0"><span class="MuiBox-root mui-1vu004u">user:123#2</span> -&gt; Node B stores a copy</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0"><span class="MuiBox-root mui-1vu004u">user:123#3</span> -&gt; Node C stores a copy</div></li>
</ul>
</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">These copies get distributed to different nodes via consistent hashing</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">For reads, clients randomly choose one of the suffixed keys, spreading read load across multiple nodes</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">For writes, the system must update all copies to maintain consistency</div></li>
</ol><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">For example, if "product:iphone" becomes a hot key during a flash sale with 100,000 reads/second but only 1 write/second:</div><ul class="MuiList-root MuiList-padding mui-sedpvs">
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">Without copies: A single node handles all 100,000 reads/second</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">With 4 copies: Each copy handles ~25,000 reads/second, but writes need to update all 4 copies</div></li>
</ul><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">This approach is specifically designed for read-heavy hot keys. If you have a key that's hot for both reads and writes, this approach can actually make things worse due to the overhead of maintaining consistency across copies.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag"><div class="MuiBox-root mui-10khgmf" style="cursor: pointer;"><div class="MuiGrid-root MuiGrid-container MuiGrid-direction-xs-column mui-1tdxmx0"><div class="MuiGrid-root MuiGrid-item mui-tolxbf"><div class="relative w-full"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeSmall mui-wksd04" tabindex="0" type="button" aria-label="zoom-in"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium mui-10dohqv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ZoomInIcon"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"></path><path d="M12 10h-2v2H9v-2H7V9h2V7h1v2h2z"></path></svg><span class="MuiTouchRipple-root mui-w0pj6f"></span></button><span class="w-full h-full"><span class="block"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 538.6282529435364 723.8406847362485">
  <!-- svg-source:excalidraw -->
  <!-- payload-type:application/vnd.excalidraw+json --><!-- payload-version:2 -->
  <defs>
    <style class="style-fonts">
      
      
      
    </style>
    
  </defs>
  <rect x="0" y="0" width="538.6282529435364" height="723.8406847362485" fill="#ffffff"></rect><g stroke-linecap="round" transform="translate(10 305.5076688281918) rotate(0 46.552734375 44.41406250000003)"><path d="M22.21 0 C34.47 -0.19, 42.74 0.65, 70.9 0 M22.21 0 C36.14 -0.23, 50.94 -0.2, 70.9 0 M70.9 0 C84.29 -1.55, 91.71 8.42, 93.11 22.21 M70.9 0 C85.68 1.38, 95.27 6.64, 93.11 22.21 M93.11 22.21 C94.13 31.16, 93.07 41.88, 93.11 66.62 M93.11 22.21 C93.15 39.18, 92.87 55.03, 93.11 66.62 M93.11 66.62 C95.03 81.7, 84.99 89.32, 70.9 88.83 M93.11 66.62 C93.99 82.17, 87.39 87.05, 70.9 88.83 M70.9 88.83 C59.08 90.24, 51.36 90.68, 22.21 88.83 M70.9 88.83 C59.02 88.43, 46.11 88.28, 22.21 88.83 M22.21 88.83 C6.79 89.9, 0.25 80.32, 0 66.62 M22.21 88.83 C9.48 90.68, 1.37 81.64, 0 66.62 M0 66.62 C-1.03 55.2, 0.52 40.42, 0 22.21 M0 66.62 C1.03 57, 1.23 47.9, 0 22.21 M0 22.21 C0.78 7.75, 7.47 1.77, 22.21 0 M0 22.21 C2.07 5.44, 6.59 -2.26, 22.21 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(34.3408203125 337.4217313281918) rotate(0 22.2119140625 12.5)"><text x="22.2119140625" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">client</text></g><g stroke-linecap="round"><g transform="translate(112.61267447310081 351.3851366200695) rotate(0 105.83942795287871 -107.74146205601738)"><path d="M0.22 -0.11 C35.4 -35.98, 175.58 -180.29, 210.78 -216.29 M-1.12 -1.22 C34.45 -36.86, 177.74 -179.52, 213.02 -215.18" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(112.61267447310081 351.3851366200695) rotate(0 105.83942795287871 -107.74146205601738)"><path d="M12.54 -27.47 C8.7 -21.39, 4.13 -12.75, 0.22 -0.11 M12.54 -27.47 C8.95 -21.63, 5.95 -13.67, 0.22 -0.11" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(112.61267447310081 351.3851366200695) rotate(0 105.83942795287871 -107.74146205601738)"><path d="M27.24 -13.15 C19.46 -11, 10.83 -6.32, 0.22 -0.11 M27.24 -13.15 C20 -10.89, 13.41 -6.42, 0.22 -0.11" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(112.61267447310081 351.3851366200695) rotate(0 105.83942795287871 -107.74146205601738)"><path d="M200.37 -187.98 C203.92 -197.03, 206.25 -203.47, 213.02 -215.18 M200.37 -187.98 C202.62 -195.33, 205.72 -200.68, 213.02 -215.18" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(112.61267447310081 351.3851366200695) rotate(0 105.83942795287871 -107.74146205601738)"><path d="M185.84 -202.47 C193.28 -207.54, 199.63 -209.98, 213.02 -215.18 M185.84 -202.47 C191.71 -206.21, 198.35 -208.03, 213.02 -215.18" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(346.28100402642485 10) rotate(0 88.2345025786332 98.93473203061865)"><path d="M32 0 C66.47 0.42, 102.53 1.75, 144.47 0 M32 0 C59.13 1.38, 87.64 1.47, 144.47 0 M144.47 0 C167.68 -0.66, 175.23 11.07, 176.47 32 M144.47 0 C165.19 1.08, 174.61 10.52, 176.47 32 M176.47 32 C179.41 62.98, 178.38 92.73, 176.47 165.87 M176.47 32 C177.4 70.31, 178.14 108.45, 176.47 165.87 M176.47 165.87 C177.93 185.66, 163.93 197.8, 144.47 197.87 M176.47 165.87 C176.78 185.16, 167.35 198.49, 144.47 197.87 M144.47 197.87 C102.14 198.5, 55.4 196.95, 32 197.87 M144.47 197.87 C120.96 197.92, 98.1 199.28, 32 197.87 M32 197.87 C11.86 198.06, -0.41 188.74, 0 165.87 M32 197.87 C12.18 197.08, 1.14 188.2, 0 165.87 M0 165.87 C-0.53 136.51, 0.06 106.07, 0 32 M0 165.87 C-0.49 136.17, 0.38 103.84, 0 32 M0 32 C-0.71 8.7, 10.94 0.63, 32 0 M0 32 C2.29 10.85, 8.78 -0.04, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(367.6555517710736 96.43473203061865) rotate(0 66.85995483398438 12.5)"><text x="66.85995483398438" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">cache shard 1</text></g><g stroke-linecap="round" transform="translate(352.15924778627004 265.05136285512634) rotate(0 88.2345025786332 98.93473203061868)"><path d="M32 0 C62.28 -1.92, 93.12 -1.91, 144.47 0 M32 0 C72.41 -1.01, 110.32 -0.47, 144.47 0 M144.47 0 C165.27 0.94, 174.85 10.54, 176.47 32 M144.47 0 C164.11 1.64, 175 12.95, 176.47 32 M176.47 32 C176.8 78.54, 177.38 120.53, 176.47 165.87 M176.47 32 C177.72 74.66, 176.05 118.82, 176.47 165.87 M176.47 165.87 C176.74 185.43, 167.14 198.41, 144.47 197.87 M176.47 165.87 C178.52 186.03, 166.05 199.54, 144.47 197.87 M144.47 197.87 C106.08 196.67, 72.36 197.54, 32 197.87 M144.47 197.87 C117.54 198.87, 89.21 199.54, 32 197.87 M32 197.87 C11.98 197.18, 0.99 188.07, 0 165.87 M32 197.87 C9.06 195.63, -1.49 185.09, 0 165.87 M0 165.87 C-0.6 116.61, 1.18 65.86, 0 32 M0 165.87 C-1.56 112.85, -1.07 62.12, 0 32 M0 32 C1.99 10.83, 9.02 -0.03, 32 0 M0 32 C-1.09 10.15, 11.43 1.68, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(369.123799498204 351.486094885745) rotate(0 71.26995086669919 12.499999999999972)"><text x="71.26995086669922" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">cache shard 2</text></g><g stroke-linecap="round" transform="translate(349.993618917478 515.9712206750112) rotate(0 88.2345025786332 98.93473203061865)"><path d="M32 0 C58.8 0.76, 84.76 2.67, 144.47 0 M32 0 C61.74 0.24, 91.2 -0.29, 144.47 0 M144.47 0 C164.33 1.43, 175.19 12.65, 176.47 32 M144.47 0 C166.57 1.11, 176.59 10.31, 176.47 32 M176.47 32 C177.14 85.78, 177.29 139.49, 176.47 165.87 M176.47 32 C175.35 60.94, 175.88 91.93, 176.47 165.87 M176.47 165.87 C178.25 186.19, 166.01 199.32, 144.47 197.87 M176.47 165.87 C177.05 185.47, 164.61 195.8, 144.47 197.87 M144.47 197.87 C113.08 199.82, 85.5 199.2, 32 197.87 M144.47 197.87 C110.32 198.39, 75.34 199.16, 32 197.87 M32 197.87 C9.27 195.92, -1.29 185.37, 0 165.87 M32 197.87 C12.36 196.45, 2.16 185.56, 0 165.87 M0 165.87 C1.54 122.31, -1.94 74.44, 0 32 M0 165.87 C0.81 138.97, -1 111.89, 0 32 M0 32 C-0.95 10.22, 11.33 1.46, 32 0 M0 32 C2.06 8.53, 8.62 -1.34, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(367.2681681880057 602.4059527056298) rotate(0 70.95995330810544 12.5)"><text x="70.95995330810547" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">cache shard 3</text></g><g stroke-linecap="round"><g transform="translate(127.05581079399894 354.4950307632291) rotate(0 103.14104964115737 8.39531911108537)"><path d="M1.13 -0.4 C35.39 2.32, 171.4 14.08, 205.54 17.03 M0.26 -1.65 C34.91 0.62, 173.73 12.21, 207.86 15.04" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(127.05581079399894 354.4950307632291) rotate(0 103.14104964115737 8.39531911108537)"><path d="M30.09 -8.24 C20.82 -6.86, 13.23 -3.81, 1.13 -0.4 M30.09 -8.24 C19.24 -4.82, 9.29 -1.83, 1.13 -0.4" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(127.05581079399894 354.4950307632291) rotate(0 103.14104964115737 8.39531911108537)"><path d="M28.35 12.21 C19.48 7.46, 12.41 4.4, 1.13 -0.4 M28.35 12.21 C18.27 8.53, 8.93 4.44, 1.13 -0.4" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(127.05581079399894 354.4950307632291) rotate(0 103.14104964115737 8.39531911108537)"><path d="M178.92 22.94 C186.86 19.06, 196.57 17.41, 207.86 15.04 M178.92 22.94 C188.29 20.93, 198.42 18.47, 207.86 15.04" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(127.05581079399894 354.4950307632291) rotate(0 103.14104964115737 8.39531911108537)"><path d="M180.61 2.48 C188.17 4.74, 197.38 9.2, 207.86 15.04 M180.61 2.48 C189.23 7.57, 198.78 12.2, 207.86 15.04" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(121.89161887610999 373.0099676854304) rotate(0 104.40234997133302 123.2147633865003)"><path d="M-0.74 0.24 C33.82 41.47, 173.72 205.97, 208.49 246.99 M1.07 -0.67 C35.34 40.24, 172.51 203.78, 207.37 245.17" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(121.89161887610999 373.0099676854304) rotate(0 104.40234997133302 123.2147633865003)"><path d="M25.31 15.11 C15.5 8.56, 5.77 1.61, -0.74 0.24 M25.31 15.11 C17.13 11.93, 10.46 7.05, -0.74 0.24" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(121.89161887610999 373.0099676854304) rotate(0 104.40234997133302 123.2147633865003)"><path d="M9.66 28.38 C6.06 16.7, 2.49 4.52, -0.74 0.24 M9.66 28.38 C6.17 21.19, 4.09 12.42, -0.74 0.24" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(121.89161887610999 373.0099676854304) rotate(0 104.40234997133302 123.2147633865003)"><path d="M181.38 230.18 C191.98 235.72, 202.75 240.53, 207.37 245.17 M181.38 230.18 C188.26 235.39, 196.86 239.27, 207.37 245.17" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(121.89161887610999 373.0099676854304) rotate(0 104.40234997133302 123.2147633865003)"><path d="M197.09 216.98 C201.45 227.62, 206.04 237.64, 207.37 245.17 M197.09 216.98 C199.26 226.17, 203.25 233.94, 207.37 245.17" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(390.4180051557044 126.71910923044521) rotate(0 43.869964599609375 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#e03131" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">hot key 1</text></g><g transform="translate(395.29918458718095 382.8754588676536) rotate(0 43.869964599609375 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#e03131" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">hot key 1</text></g><g transform="translate(394.4829833320594 410.3621212014241) rotate(0 48.27996063232422 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1971c2" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">hot key 2</text></g><g transform="translate(391.7780605283968 157.36362280458525) rotate(0 48.27996063232422 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1971c2" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">hot key 2</text></g><g transform="translate(393.7307980253559 638.9675328640219) rotate(0 48.27996063232422 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1971c2" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">hot key 2</text></g></svg></span></span></div></div><div class="MuiGrid-root MuiGrid-item mui-1wxaqej"><span class="MuiTypography-root MuiTypography-caption mui-17cupi8">Copies of Hot Keys</span></div></div></div></div><h6 class="MuiTypography-root MuiTypography-body1 mui-1quhbks" id="challenges-6">Challenges</h6><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">The main challenge is keeping all copies in sync when data changes. When updating a hot key, we need to update all copies of that key across different nodes. While we could try to update all copies simultaneously (atomic updates), this adds significant complexity. However, most distributed caching systems, including ours, are designed to be eventually consistent - meaning it's acceptable if copies are briefly out of sync as long as they converge to the same value. This makes the consistency challenge much more manageable since we don't need perfect synchronization.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">There's also overhead in monitoring to detect hot keys and managing the lifecycle of copies - when to create them and when to remove them if a key is no longer hot. The approach works best when hot keys are primarily read-heavy with minimal writes.</div></div></div></div></div></div></div></div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">The key takeaway for your interviewer is demonstrating that you understand hot keys are a real operational concern that can't be ignored. By proactively discussing these mitigation strategies, you show that you've thought through the practical challenges of running a distributed cache at scale and have concrete approaches for addressing them. This kind of operational awareness is what separates theoretical knowledge from practical system design experience.</div><h3 class="MuiTypography-root MuiTypography-h4 mui-hkpafq" id="5-what-happens-if-you-have-a-hot-key-that-is-being-written-to-a-lot">5) What happens if you have a hot key that is being written to a lot?</h3><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Hot writes are a similar problem to hot reads, but they're a bit more complex and have a different set of trade-offs.</div><div class="my-6 flex flex-col gap-4"><div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation0 MuiAccordion-root MuiAccordion-rounded MuiAccordion-gutters mui-11r69q9"><div class="MuiButtonBase-root MuiAccordionSummary-root MuiAccordionSummary-gutters mui-3ujfba" tabindex="0" role="button" aria-expanded="false" aria-controls="panel1bh-content" id="panel1bh-header"><div class="MuiAccordionSummary-content MuiAccordionSummary-contentGutters mui-l0jafl"><p class="MuiTypography-root MuiTypography-body1 mui-h8owmt">Great Solution: Write Batching</p></div><div class="MuiAccordionSummary-expandIconWrapper mui-awtdfi"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium mui-10dohqv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ExpandMoreIcon"><path d="M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"></path></svg></div></div><div class="MuiCollapse-root MuiCollapse-vertical MuiCollapse-hidden mui-a0y2e3" style="min-height: 0px;"><div class="MuiCollapse-wrapper MuiCollapse-vertical mui-hboir5"><div class="MuiCollapse-wrapperInner MuiCollapse-vertical mui-8atqhb"><div aria-labelledby="panel1bh-header" id="panel1bh-content" role="region" class="MuiAccordion-region"><div class="MuiAccordionDetails-root mui-u7qq7e"><h6 class="MuiTypography-root MuiTypography-body1 mui-1quhbks" id="approach-7">Approach</h6><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Write batching addresses hot writes by collecting multiple write operations over a short time window and applying them as a single atomic update. Instead of processing each write individually as it arrives, the client buffers writes for a brief period (typically 50-100ms) and then consolidates them into a single operation. This approach is particularly effective for counters, metrics, and other scenarios where the final state matters more than tracking each individual update.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Consider a viral video receiving 10,000 view updates per second. Rather than executing 10,000 separate operations to set new values (e.g. views=1, views=2, views=3, etc), write batching might collect these updates for 100ms, then execute a single operation to set the final value 1,000 higher. This reduces the write pressure on the cache node by an order of magnitude while still maintaining reasonable accuracy. The trade-off is a small delay in write visibility, but for many use cases, this delay is acceptable given the substantial performance benefits.</div><h6 class="MuiTypography-root MuiTypography-body1 mui-1quhbks" id="challenges-7">Challenges</h6><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">The main challenge with write batching is managing the trade-off between batching delay and write visibility. Longer batching windows reduce system load but increase the time until writes are visible. There's also the complexity of handling failures during the batching window - if the batch processor fails, you need mechanisms to recover or replay the buffered writes. Additionally, batching introduces slight inconsistency in read operations, as there's always some amount of pending writes in the buffer. This approach works best for metrics and counters where eventual consistency is acceptable, but may not be suitable for scenarios requiring immediate write visibility.</div></div></div></div></div></div></div><div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation0 MuiAccordion-root MuiAccordion-rounded MuiAccordion-gutters mui-11r69q9"><div class="MuiButtonBase-root MuiAccordionSummary-root MuiAccordionSummary-gutters mui-3ujfba" tabindex="0" role="button" aria-expanded="false" aria-controls="panel1bh-content" id="panel1bh-header"><div class="MuiAccordionSummary-content MuiAccordionSummary-contentGutters mui-l0jafl"><p class="MuiTypography-root MuiTypography-body1 mui-h8owmt">Great Solution: Sharding Hot Key With Suffixes</p></div><div class="MuiAccordionSummary-expandIconWrapper mui-awtdfi"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium mui-10dohqv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ExpandMoreIcon"><path d="M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"></path></svg></div></div><div class="MuiCollapse-root MuiCollapse-vertical MuiCollapse-hidden mui-a0y2e3" style="min-height: 0px;"><div class="MuiCollapse-wrapper MuiCollapse-vertical mui-hboir5"><div class="MuiCollapse-wrapperInner MuiCollapse-vertical mui-8atqhb"><div aria-labelledby="panel1bh-header" id="panel1bh-content" role="region" class="MuiAccordion-region"><div class="MuiAccordionDetails-root mui-u7qq7e"><h6 class="MuiTypography-root MuiTypography-body1 mui-1quhbks" id="approach-8">Approach</h6><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Key sharding takes a different approach to handling hot writes by splitting a single hot key into multiple sub-keys distributed across different nodes. This is the one we talk about in many other Hello Interview breakdowns.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Instead of having a single counter or value that receives all writes, the system spreads writes across multiple shards using a suffix strategy. For example, a hot counter key "views:video123" might be split into 10 shards: "views:video123:1" through "views:video123:10". When a write arrives, the system randomly selects one of these shards to update.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">This approach effectively distributes write load across multiple nodes in the cluster. For our viral video example with 10,000 writes per second, using 10 shards would reduce the per-shard write load to roughly 1,000 operations per second. When reading the total value, the system simply needs to sum the values from all shards. This technique is particularly powerful because it works with any operation that can be decomposed and recomposed, not just simple counters.</div><h6 class="MuiTypography-root MuiTypography-body1 mui-1quhbks" id="challenges-8">Challenges</h6><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">The primary challenge with key sharding is the increased complexity of read operations, which now need to aggregate data from multiple shards. This can increase read latency and resource usage, effectively trading write performance for read performance. There's also the challenge of maintaining consistency across shards during failure scenarios or rebalancing operations. The number of shards needs to be carefully chosen - too few won't adequately distribute the load, while too many will make reads unnecessarily complex. Finally, this approach may not be suitable for operations that can't be easily decomposed, such as operations that need to maintain strict ordering or atomicity across all updates.</div></div></div></div></div></div></div></div><h3 class="MuiTypography-root MuiTypography-h4 mui-hkpafq" id="6-how-do-we-ensure-our-cache-is-performant">6) How do we ensure our cache is performant?</h3><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Our single-node design started off simple and snappyâ€”lookups and writes were <span class="MuiBox-root mui-1vu004u">O(1)</span> and served straight out of memory. But as we grow our system into a large, distributed cache spanning dozens or even hundreds of nodes, the problem changes. Suddenly, performance isnâ€™t just about how fast a hash table runs in memory. Itâ€™s about how quickly clients can find the right node, how efficiently multiple requests are bundled together, and how we avoid unnecessary network chatter.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Once we start scaling out, we can no longer rely solely on local performance optimizations. Even if each individual node is blazing fast, the interaction between nodes and clients, and the overhead of network hops, can introduce significant latency. Itâ€™s not unusual for a request that was once served in microseconds to slow down when it has to traverse the network multiple times, deal with connection setups, or handle many small requests individually.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">The good news is, we already solved this problem with each of our previous solutions. Request batching, which helped us with our hot writes, is also an effective general technique for reducing latency since it reduces the number of round trips between the client and server.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Consistent hashing, which we talked about in our sharding solution, is also an effective general technique for reducing latency since it means we don't need to query a central routing service to find out which node has our data -- saving us a round trip.</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">The only other thing I may consider mentioning in an interview if asking this question is connection pooling. Constantly tearing down and re-establishing network connections between the client and servers is a recipe for wasted time. Instead of spinning up a fresh connection for every request, clients should maintain a pool of open, persistent connections. This ensures thereâ€™s always a ready-to-use channel for requests, removing expensive round-trip handshakes and drastically reducing tail latencies (like those p95 and p99 response times that can make or break user experience).</div><h2 class="MuiTypography-root MuiTypography-h3 mui-1rzqq5q" id="tying-it-all-together">Tying it all together</h2><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Ok, tying it all together, on each node, we'll have two data structures:</div><ol style="list-style: outside decimal;">
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">A hash table for storing our key-value pairs</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">A linked list for our LRU eviction policy</div></li>
</ol><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">When it comes to scaling, it depends on which of the above approaches you choose, as you can end up with a slightly different design. Assuming you opted for:</div><ol style="list-style: outside decimal;">
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">Asynchronous replication for high availability and handling hot key reads.</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">Consistent hashing for sharding and routing.</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">Random suffixes for distributing hot key writes across nodes.</div></li>
<li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding mui-ioa8ei"><div class="MuiBox-root mui-0">Write batching and connection pooling for decreasing network latency/overhead.</div></li>
</ol><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">Your final design might look something like this:</div><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag"><div class="MuiBox-root mui-10khgmf" style="cursor: pointer;"><div class="MuiGrid-root MuiGrid-container MuiGrid-direction-xs-column mui-1tdxmx0"><div class="MuiGrid-root MuiGrid-item mui-tolxbf"><div class="relative w-full"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeSmall mui-wksd04" tabindex="0" type="button" aria-label="zoom-in"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium mui-10dohqv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ZoomInIcon"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"></path><path d="M12 10h-2v2H9v-2H7V9h2V7h1v2h2z"></path></svg><span class="MuiTouchRipple-root mui-w0pj6f"></span></button><span class="w-full h-full"><span class="block"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1229.2849974479177 1247.6346685976928">
  <!-- svg-source:excalidraw -->
  <!-- payload-type:application/vnd.excalidraw+json --><!-- payload-version:2 -->
  <defs>
    <style class="style-fonts">
      
      
      
    </style>
    
  </defs>
  <rect x="0" y="0" width="1229.2849974479177" height="1247.6346685976928" fill="#ffffff"></rect><g stroke-linecap="round" transform="translate(10 551.6678819712731) rotate(0 107.67736503012077 70.84125310622198)"><path d="M32 0 C65.87 -1.34, 95.99 -1.94, 183.35 0 M32 0 C77.69 -0.77, 123.39 0.05, 183.35 0 M183.35 0 C204.74 -1.75, 217.34 10.35, 215.35 32 M183.35 0 C204.62 -1.87, 216.5 10.57, 215.35 32 M215.35 32 C214.15 58.2, 214.86 81.57, 215.35 109.68 M215.35 32 C214.76 53.27, 214.55 73.8, 215.35 109.68 M215.35 109.68 C214.32 131.53, 203.68 140.17, 183.35 141.68 M215.35 109.68 C213.94 133.29, 203.77 141.3, 183.35 141.68 M183.35 141.68 C151.98 139.64, 117.45 141.29, 32 141.68 M183.35 141.68 C124.14 142.41, 64.93 142.07, 32 141.68 M32 141.68 C10.86 140.31, -1.98 129.71, 0 109.68 M32 141.68 C12.3 140.22, 1.74 131.19, 0 109.68 M0 109.68 C-2.23 87.07, -1.63 67.08, 0 32 M0 109.68 C-1.2 94.02, -1.03 77.89, 0 32 M0 32 C-1.54 9.38, 12.31 -0.01, 32 0 M0 32 C-1.77 10.39, 9.1 2.05, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(17.637448037933268 585.0091350774951) rotate(0 100.0399169921875 37.5)"><text x="100.0399169921875" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Client</text><text x="100.0399169921875" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">- Batch writes</text><text x="100.0399169921875" y="50" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">w/ connection pooling</text></g><g stroke-linecap="round"><g transform="translate(240.30861929911202 618.6831630572626) rotate(0 221.01345995259095 -0.5281193171612699)"><path d="M-0.22 -0.76 C73.61 -1.16, 368.27 -1.58, 442.18 -1.66 M-1.79 1.46 C71.96 1.13, 367.16 -0.2, 441.31 -0.43" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(240.30861929911202 618.6831630572626) rotate(0 221.01345995259095 -0.5281193171612699)"><path d="M413.16 9.94 C418.39 7.82, 425.22 7.12, 441.31 -0.43 M413.16 9.94 C421.79 6.74, 428.41 3.48, 441.31 -0.43" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(240.30861929911202 618.6831630572626) rotate(0 221.01345995259095 -0.5281193171612699)"><path d="M413.08 -10.58 C418.46 -7.92, 425.31 -3.82, 441.31 -0.43 M413.08 -10.58 C421.86 -7.86, 428.51 -5.2, 441.31 -0.43" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(314.34309517046336 636.3755935857089) rotate(0 150.75985717773438 50)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#868e96" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">- consistent hashing </text><text x="0" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#868e96" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">to determine the right node</text><text x="0" y="50" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#868e96" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">- random suffix to spread hot</text><text x="0" y="75" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#868e96" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">key load across nodes</text></g><g stroke-linecap="round" transform="translate(782.2289762604241 241.59771389886595) rotate(0 74.2627792438891 64.24239053769313)"><path d="M32 0 C55.2 0.18, 72.87 -0.46, 116.53 0 M32 0 C51.92 -0.17, 72.03 0.38, 116.53 0 M116.53 0 C137.66 0.87, 149.34 10.85, 148.53 32 M116.53 0 C139.88 -1.22, 148.85 8.56, 148.53 32 M148.53 32 C148.68 47.76, 148.02 65.85, 148.53 96.48 M148.53 32 C148.21 55.3, 148.57 78.97, 148.53 96.48 M148.53 96.48 C148.79 119.8, 139.34 130.34, 116.53 128.48 M148.53 96.48 C147.41 119.42, 135.62 129.79, 116.53 128.48 M116.53 128.48 C85.94 129.65, 49.99 128.89, 32 128.48 M116.53 128.48 C92.03 128.5, 68.41 129.16, 32 128.48 M32 128.48 C11.35 128.75, -1.15 116.56, 0 96.48 M32 128.48 C12.69 127.85, -1.86 117.84, 0 96.48 M0 96.48 C-1.69 74.11, 2.04 50.77, 0 32 M0 96.48 C1.53 80.7, 0.14 64.62, 0 32 M0 32 C-1.38 8.84, 9.67 0.23, 32 0 M0 32 C0.73 9.84, 11.49 -0.35, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(830.6417799183757 293.34010443655905) rotate(0 25.8499755859375 12.5)"><text x="25.8499755859375" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Node1</text></g><g stroke-linecap="round" transform="translate(988.6258277764721 154.85295133676095) rotate(0 74.2627792438891 64.24239053769313)"><path d="M32 0 C48.01 -1.35, 66.01 -1.52, 116.53 0 M32 0 C58.21 0.31, 83.44 -0.36, 116.53 0 M116.53 0 C138.68 -1.54, 149.71 10.36, 148.53 32 M116.53 0 C139.68 0.81, 146.8 9.6, 148.53 32 M148.53 32 C146.91 46.11, 149.05 60.68, 148.53 96.48 M148.53 32 C147.21 55.93, 147.54 80, 148.53 96.48 M148.53 96.48 C146.94 119.3, 139.31 128.54, 116.53 128.48 M148.53 96.48 C147.84 118.36, 137.4 127.91, 116.53 128.48 M116.53 128.48 C88.05 127.72, 62.45 128.06, 32 128.48 M116.53 128.48 C89.14 128.81, 59.62 128.35, 32 128.48 M32 128.48 C9.42 130.16, 1.21 116.4, 0 96.48 M32 128.48 C11.73 129.17, 1.95 117.94, 0 96.48 M0 96.48 C0.46 81.08, -0.52 62.88, 0 32 M0 96.48 C-0.42 80.02, -0.27 62.84, 0 32 M0 32 C0.02 10.37, 12.64 -1.87, 32 0 M0 32 C0.97 8.75, 8.99 0.74, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1002.4286460828612 194.09534187445408) rotate(0 60.4599609375 25)"><text x="60.4599609375" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Node1 Read </text><text x="60.4599609375" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Replica</text></g><g stroke-linecap="round" transform="translate(993.8920405418803 327.7400469163349) rotate(0 74.2627792438891 64.24239053769313)"><path d="M32 0 C57.14 1.36, 79.6 1.63, 116.53 0 M32 0 C49.88 0.92, 70.15 1.5, 116.53 0 M116.53 0 C138.9 -0.33, 148.67 11.24, 148.53 32 M116.53 0 C140.01 0.39, 146.97 10.88, 148.53 32 M148.53 32 C150.62 52.15, 147.6 70.11, 148.53 96.48 M148.53 32 C148.2 49.81, 147.66 67.79, 148.53 96.48 M148.53 96.48 C149.01 117.06, 139.53 129.17, 116.53 128.48 M148.53 96.48 C150.62 118.92, 137.35 130.76, 116.53 128.48 M116.53 128.48 C91.32 127.75, 68.17 130.1, 32 128.48 M116.53 128.48 C84.14 128.66, 50.12 126.72, 32 128.48 M32 128.48 C12.39 126.75, 0.07 117.69, 0 96.48 M32 128.48 C10.6 128.87, -1.66 117.72, 0 96.48 M0 96.48 C-0.91 73.63, 0.89 52.84, 0 32 M0 96.48 C-0.2 78.6, -1.09 62.56, 0 32 M0 32 C-0.56 11.38, 9.91 0.28, 32 0 M0 32 C1.74 11.46, 8.85 -2.11, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1007.6948588482694 366.98243745402806) rotate(0 60.4599609375 25)"><text x="60.4599609375" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Node1 Read </text><text x="60.4599609375" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Replica</text></g><g stroke-linecap="round" transform="translate(785.0255591031439 586.4658899585888) rotate(0 74.2627792438891 64.24239053769311)"><path d="M32 0 C64.99 -1.72, 96.16 -0.01, 116.53 0 M32 0 C53.73 0.09, 76.68 -0.63, 116.53 0 M116.53 0 C136 -0.5, 146.98 10.21, 148.53 32 M116.53 0 C137.42 2.23, 149.14 10.23, 148.53 32 M148.53 32 C149.02 54.9, 148.88 77.51, 148.53 96.48 M148.53 32 C147.55 45.83, 147.82 62.26, 148.53 96.48 M148.53 96.48 C146.78 115.91, 138.61 129.3, 116.53 128.48 M148.53 96.48 C149.21 116.01, 139.48 126.27, 116.53 128.48 M116.53 128.48 C88.48 129.71, 60.73 128.85, 32 128.48 M116.53 128.48 C92.55 129.38, 68.87 129.55, 32 128.48 M32 128.48 C9.77 127.43, -1.77 118.65, 0 96.48 M32 128.48 C11.75 127, -0.05 117.33, 0 96.48 M0 96.48 C-1.66 82.48, -1.57 66.72, 0 32 M0 96.48 C-0.6 80.05, 0.4 64.58, 0 32 M0 32 C1.14 9.67, 9.77 0.21, 32 0 M0 32 C0.86 11.78, 10.98 2, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(829.0283667283807 638.208280496282) rotate(0 30.259971618652344 12.5)"><text x="30.259971618652344" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Node2</text></g><g stroke-linecap="round" transform="translate(991.4224106191916 499.7211273964838) rotate(0 74.2627792438891 64.24239053769313)"><path d="M32 0 C50.49 -0.38, 70.15 -0.84, 116.53 0 M32 0 C55.81 0.42, 80.72 0.44, 116.53 0 M116.53 0 C137.47 1.94, 149.06 10.28, 148.53 32 M116.53 0 C138.76 1.91, 148.47 10.62, 148.53 32 M148.53 32 C147.04 52.7, 148.72 76.62, 148.53 96.48 M148.53 32 C147.6 44.45, 148.85 59.22, 148.53 96.48 M148.53 96.48 C149.12 116.25, 139.27 126.56, 116.53 128.48 M148.53 96.48 C149.23 117.75, 138.72 128.36, 116.53 128.48 M116.53 128.48 C86.87 128.91, 59.07 127.37, 32 128.48 M116.53 128.48 C86.47 128.53, 56.42 129.47, 32 128.48 M32 128.48 C11.61 127.2, -0.04 117.39, 0 96.48 M32 128.48 C9.41 128.87, -0.37 116.04, 0 96.48 M0 96.48 C-0.5 72.1, -0.79 45.44, 0 32 M0 96.48 C0.15 78.04, -0.87 60.71, 0 32 M0 32 C0.75 11.63, 10.94 1.74, 32 0 M0 32 C-0.14 12.71, 12.02 2.04, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1000.8152328928659 538.9635179341769) rotate(0 64.86995697021484 25)"><text x="64.86995697021484" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Node2 Read </text><text x="64.86995697021484" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Replica</text></g><g stroke-linecap="round" transform="translate(996.6886233846001 672.6082229760577) rotate(0 74.2627792438891 64.24239053769314)"><path d="M32 0 C56.08 1.3, 78.86 -1.56, 116.53 0 M32 0 C55.04 1.16, 78.74 0, 116.53 0 M116.53 0 C138.64 1.66, 148.48 10.63, 148.53 32 M116.53 0 C139.04 -0.21, 150.55 9.03, 148.53 32 M148.53 32 C146.77 44.89, 150.12 56.34, 148.53 96.48 M148.53 32 C149.07 44.39, 149.47 57.39, 148.53 96.48 M148.53 96.48 C149.13 117.76, 138.61 128.37, 116.53 128.48 M148.53 96.48 C149.57 117.89, 137.91 127.96, 116.53 128.48 M116.53 128.48 C90.46 126.34, 63.73 127.11, 32 128.48 M116.53 128.48 C96.09 128.19, 74.69 128.62, 32 128.48 M32 128.48 C9.57 128.82, -0.32 116.27, 0 96.48 M32 128.48 C12.75 126.81, 2.15 116.7, 0 96.48 M0 96.48 C-0.03 75.88, 1.44 53.81, 0 32 M0 96.48 C0.66 80.84, 0.42 65.11, 0 32 M0 32 C-0.13 12.45, 11.84 1.78, 32 0 M0 32 C0.64 8.88, 11.28 -0.94, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1006.0814456582743 711.8506135137509) rotate(0 64.86995697021484 25)"><text x="64.86995697021484" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Node2 Read </text><text x="64.86995697021484" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Replica</text></g><g stroke-linecap="round" transform="translate(792.4759154118087 934.4323140815244) rotate(0 74.2627792438891 64.2423905376931)"><path d="M32 0 C62.25 0.82, 93.43 -0.51, 116.53 0 M32 0 C53.05 0.97, 73.5 0.8, 116.53 0 M116.53 0 C136.67 0.44, 147.44 9.99, 148.53 32 M116.53 0 C138.43 -2.14, 147.98 10.84, 148.53 32 M148.53 32 C149.77 47.75, 149.09 59.99, 148.53 96.48 M148.53 32 C149.59 56.57, 149.19 81.9, 148.53 96.48 M148.53 96.48 C150.11 118.69, 136.67 127.91, 116.53 128.48 M148.53 96.48 C149.75 115.94, 135.59 127.67, 116.53 128.48 M116.53 128.48 C93.76 127.23, 72.73 126.24, 32 128.48 M116.53 128.48 C97.66 128.32, 78.22 128.02, 32 128.48 M32 128.48 C11.46 128.27, 1.29 119.11, 0 96.48 M32 128.48 C12.31 127.6, -2.01 120.05, 0 96.48 M0 96.48 C0.71 74.48, -1.74 48.91, 0 32 M0 96.48 C-0.76 71.71, -0.43 46.07, 0 32 M0 32 C1.26 12.44, 9.02 1.86, 32 0 M0 32 C-1.53 8.58, 10.91 -2.11, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(837.1587233422213 986.1747046192176) rotate(0 29.579971313476562 12.5)"><text x="29.579971313476562" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">NodeN</text></g><g stroke-linecap="round" transform="translate(998.8727669278564 847.6875515194193) rotate(0 74.2627792438891 64.2423905376931)"><path d="M32 0 C62.31 0.49, 93.37 0.69, 116.53 0 M32 0 C59.75 0.07, 88.16 -0.49, 116.53 0 M116.53 0 C138.36 -1.86, 148.05 10.82, 148.53 32 M116.53 0 C136.3 -2.12, 150.57 12.78, 148.53 32 M148.53 32 C150.61 54.99, 149.02 77.11, 148.53 96.48 M148.53 32 C149.52 49.86, 148.13 66.57, 148.53 96.48 M148.53 96.48 C149.59 116.18, 135.89 127.77, 116.53 128.48 M148.53 96.48 C147.32 116.05, 136.97 126.36, 116.53 128.48 M116.53 128.48 C93.68 129.59, 74 128.6, 32 128.48 M116.53 128.48 C94.12 127.87, 71.57 128.62, 32 128.48 M32 128.48 C12.09 127.71, -1.75 119.76, 0 96.48 M32 128.48 C12.07 130.23, -1.33 119.19, 0 96.48 M0 96.48 C2.22 74.39, -0.25 48.88, 0 32 M0 96.48 C0.62 75.18, -0.83 53.03, 0 32 M0 32 C-1.33 8.85, 10.88 -1.83, 32 0 M0 32 C-1.96 8.51, 10.83 -1.56, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1008.9455895067065 886.9299420571125) rotate(0 64.18995666503906 25)"><text x="64.18995666503906" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">NodeN Read </text><text x="64.18995666503906" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Replica</text></g><g stroke-linecap="round" transform="translate(1004.1389796932649 1020.8335085559719) rotate(0 74.2627792438891 64.2423905376931)"><path d="M32 0 C60.32 -0.05, 87.57 -1.5, 116.53 0 M32 0 C59.48 -0.65, 86.22 0.36, 116.53 0 M116.53 0 C136.5 -1.84, 150.3 12.51, 148.53 32 M116.53 0 C138.75 1.33, 146.28 12.64, 148.53 32 M148.53 32 C147.97 55.6, 148.91 79.57, 148.53 96.48 M148.53 32 C148.67 53.33, 147.16 75.94, 148.53 96.48 M148.53 96.48 C147.48 116.28, 137.09 126.64, 116.53 128.48 M148.53 96.48 C147.45 115.57, 135.65 126.84, 116.53 128.48 M116.53 128.48 C82.44 129.58, 48.36 129.67, 32 128.48 M116.53 128.48 C92.78 128.64, 66.74 130, 32 128.48 M32 128.48 C11.89 130, -1.15 119.01, 0 96.48 M32 128.48 C12.14 127.04, -1.14 119.91, 0 96.48 M0 96.48 C1.09 72.67, 0.24 50.04, 0 32 M0 96.48 C-0.14 70.52, 0.64 45.46, 0 32 M0 32 C-1.7 8.79, 10.81 -1.36, 32 0 M0 32 C-0.56 10.59, 9.93 1.43, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1014.2118022721149 1060.0758990936652) rotate(0 64.18995666503906 25)"><text x="64.18995666503906" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">NodeN Read </text><text x="64.18995666503906" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Replica</text></g><g stroke-linecap="round"><g transform="translate(948.002656645052 308.7682979042995) rotate(0 15.20811059749201 -36.645075003531275)"><path d="M-0.24 0.29 C4.91 -11.64, 24.56 -60.04, 29.83 -72.33 M-1.83 -0.6 C3.82 -12.79, 26.74 -62.02, 32.23 -73.95" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(948.002656645052 308.7682979042995) rotate(0 15.20811059749201 -36.645075003531275)"><path d="M29.69 -44.06 C30.89 -51.32, 32.54 -55.01, 32.23 -73.95 M29.69 -44.06 C31.25 -51.82, 30.77 -61.04, 32.23 -73.95" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(948.002656645052 308.7682979042995) rotate(0 15.20811059749201 -36.645075003531275)"><path d="M11.07 -52.69 C16.14 -58.1, 21.71 -59.97, 32.23 -73.95 M11.07 -52.69 C17.95 -58.11, 22.86 -64.84, 32.23 -73.95" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(946.6112763137921 325.95658708342694) rotate(0 20.175014803268596 23.71818099566309)"><path d="M-0.58 -0.7 C6.28 7.11, 33.43 38.91, 40.1 46.99 M1.31 1.55 C8.09 9.51, 32.26 40.95, 39.02 48.3" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(946.6112763137921 325.95658708342694) rotate(0 20.175014803268596 23.71818099566309)"><path d="M13.1 33.19 C17.39 36.07, 23.25 38.18, 39.02 48.3 M13.1 33.19 C21.94 38.38, 29.99 43.79, 39.02 48.3" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(946.6112763137921 325.95658708342694) rotate(0 20.175014803268596 23.71818099566309)"><path d="M28.88 20.07 C29.87 25.62, 32.43 30.48, 39.02 48.3 M28.88 20.07 C32.5 29.5, 35.36 39.22, 39.02 48.3" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(941.0781126708748 221.34420078195535) rotate(0 35.6419868577392 -88.80565858471661)"><path d="M0.16 -0.91 C-1.29 -21.44, -21.64 -93.24, -8.45 -122.77 C4.74 -152.3, 64.48 -169.12, 79.31 -178.07 M-1.21 1.22 C-2.79 -19.21, -22.85 -92.01, -9.04 -121.71 C4.76 -151.42, 66.65 -167.54, 81.63 -177" stroke="#868e96" stroke-width="2" fill="none"></path></g><g transform="translate(941.0781126708748 221.34420078195535) rotate(0 35.6419868577392 -88.80565858471661)"><path d="M-14.13 -27.29 C-10.94 -17.64, -6.31 -12.04, 0.16 -0.91 M-14.13 -27.29 C-10.21 -19.81, -7.38 -14.52, 0.16 -0.91" stroke="#868e96" stroke-width="2" fill="none"></path></g><g transform="translate(941.0781126708748 221.34420078195535) rotate(0 35.6419868577392 -88.80565858471661)"><path d="M6.17 -30.31 C2.79 -19.65, 0.84 -13.08, 0.16 -0.91 M6.17 -30.31 C4.78 -21.85, 2.31 -15.77, 0.16 -0.91" stroke="#868e96" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(991.5372437800704 10) rotate(0 80.62992858886719 12.5)"><text x="80.62992858886719" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#868e96" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Async replication</text></g><g stroke-linecap="round"><g transform="translate(942.2945835835039 649.1536641957053) rotate(0 15.20811059749201 -36.645075003531275)"><path d="M0.18 -1.19 C5.13 -13.34, 25.49 -60.88, 30.41 -73.07 M-1.18 0.81 C3.55 -11.72, 23.9 -62.68, 29.45 -75.07" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(942.2945835835039 649.1536641957053) rotate(0 15.20811059749201 -36.645075003531275)"><path d="M28.01 -45.11 C26.59 -55.87, 29.46 -67.89, 29.45 -75.07 M28.01 -45.11 C27.43 -50.85, 27.58 -57.88, 29.45 -75.07" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(942.2945835835039 649.1536641957053) rotate(0 15.20811059749201 -36.645075003531275)"><path d="M9.09 -53.04 C14.44 -60.99, 24.09 -70.16, 29.45 -75.07 M9.09 -53.04 C12.61 -57.24, 16.79 -62.58, 29.45 -75.07" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(940.9032032522441 666.3419533748328) rotate(0 20.175014803268596 23.71818099566309)"><path d="M-0.01 0.22 C6.56 8.15, 32.71 38.37, 39.58 46.4 M-1.48 -0.7 C5.46 7.44, 34.83 39.51, 41.88 47.39" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(940.9032032522441 666.3419533748328) rotate(0 20.175014803268596 23.71818099566309)"><path d="M15.35 33.39 C23.94 36.51, 30.2 43.59, 41.88 47.39 M15.35 33.39 C24.51 38.57, 35.81 43.21, 41.88 47.39" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(940.9032032522441 666.3419533748328) rotate(0 20.175014803268596 23.71818099566309)"><path d="M30.56 19.61 C34.22 27.07, 35.69 38.49, 41.88 47.39 M30.56 19.61 C33.84 30.14, 39.34 40.03, 41.88 47.39" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(956.6588738105263 1013.9157392995346) rotate(0 15.20811059749201 -36.645075003531275)"><path d="M-0.14 -0.1 C4.83 -12.33, 24.93 -61.42, 30.18 -73.53 M-1.68 -1.2 C3.09 -13.24, 23.65 -59.84, 29.1 -72.12" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(956.6588738105263 1013.9157392995346) rotate(0 15.20811059749201 -36.645075003531275)"><path d="M27.1 -42.18 C27.62 -52.37, 28.05 -60.27, 29.1 -72.12 M27.1 -42.18 C28.03 -53.35, 29.03 -62.28, 29.1 -72.12" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(956.6588738105263 1013.9157392995346) rotate(0 15.20811059749201 -36.645075003531275)"><path d="M8.33 -50.47 C14.98 -57.93, 21.55 -63.11, 29.1 -72.12 M8.33 -50.47 C15.66 -58.63, 23.1 -64.72, 29.1 -72.12" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(955.2674934792665 1031.104028478662) rotate(0 20.175014803268596 23.71818099566309)"><path d="M-0.24 -0.24 C6.66 7.77, 34.6 40.18, 41.25 47.96 M-1.83 -1.41 C5.01 6.25, 33.44 38.01, 40.77 46.11" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(955.2674934792665 1031.104028478662) rotate(0 20.175014803268596 23.71818099566309)"><path d="M14.29 32.01 C21.52 37.63, 30.41 39, 40.77 46.11 M14.29 32.01 C20.4 35.75, 26.7 38.16, 40.77 46.11" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(955.2674934792665 1031.104028478662) rotate(0 20.175014803268596 23.71818099566309)"><path d="M29.55 18.29 C32.37 27.83, 36.86 33.15, 40.77 46.11 M29.55 18.29 C32.37 24.85, 35.38 30.23, 40.77 46.11" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(861.7413390349111 787.383634344805) rotate(0 0.00004999999998744897 0.00004999999998744897)" stroke="none"><path fill="#1e1e1e" d="M 3.14,-3.14 Q 3.14,-3.14 3.55,-2.55 3.97,-1.97 4.18,-1.28 4.40,-0.59 4.38,0.11 4.36,0.83 4.11,1.51 3.86,2.18 3.41,2.74 2.96,3.30 2.36,3.69 1.75,4.07 1.05,4.25 0.36,4.42 -0.35,4.36 -1.07,4.30 -1.73,4.02 -2.39,3.74 -2.92,3.26 -3.46,2.78 -3.81,2.15 -4.16,1.53 -4.30,0.82 -4.43,0.11 -4.34,-0.59 -4.24,-1.30 -3.92,-1.94 -3.60,-2.59 -3.09,-3.09 -2.59,-3.60 -1.94,-3.92 -1.30,-4.24 -0.59,-4.34 0.12,-4.43 0.82,-4.30 1.53,-4.16 2.15,-3.81 2.78,-3.46 3.26,-2.92 3.74,-2.39 4.02,-1.73 4.31,-1.07 4.36,-0.35 4.42,0.36 4.25,1.05 4.07,1.75 3.69,2.36 3.30,2.96 2.74,3.41 2.18,3.86 1.51,4.11 0.83,4.36 0.11,4.38 -0.60,4.40 -1.28,4.18 -1.97,3.97 -2.55,3.55 -3.14,3.13 -3.14,3.14 -3.14,3.14 -3.47,2.71 -3.80,2.29 -4.02,1.80 -4.24,1.32 -4.33,0.79 -4.43,0.26 -4.40,-0.26 -4.36,-0.80 -4.20,-1.31 -4.04,-1.82 -3.77,-2.28 -3.49,-2.73 -3.11,-3.11 -2.73,-3.49 -2.28,-3.77 -1.82,-4.05 -1.31,-4.20 -0.80,-4.36 -0.26,-4.40 0.26,-4.43 0.79,-4.33 1.32,-4.24 1.80,-4.02 2.29,-3.80 2.71,-3.47 3.14,-3.14 3.14,-3.14 L 3.14,-3.14 Z"></path></g><g transform="translate(860.7646264561174 825.3972235612282) rotate(0 0.00004999999998744897 0.00004999999998744897)" stroke="none"><path fill="#1e1e1e" d="M 3.14,-3.14 Q 3.14,-3.14 3.55,-2.55 3.97,-1.97 4.18,-1.28 4.40,-0.59 4.38,0.11 4.36,0.83 4.11,1.51 3.86,2.18 3.41,2.74 2.96,3.30 2.36,3.69 1.75,4.07 1.05,4.25 0.36,4.42 -0.35,4.36 -1.07,4.30 -1.73,4.02 -2.39,3.74 -2.92,3.26 -3.46,2.78 -3.81,2.15 -4.16,1.53 -4.30,0.82 -4.43,0.11 -4.34,-0.59 -4.24,-1.30 -3.92,-1.94 -3.60,-2.59 -3.09,-3.09 -2.59,-3.60 -1.94,-3.92 -1.30,-4.24 -0.59,-4.34 0.12,-4.43 0.82,-4.30 1.53,-4.16 2.15,-3.81 2.78,-3.46 3.26,-2.92 3.74,-2.39 4.02,-1.73 4.31,-1.07 4.36,-0.35 4.42,0.36 4.25,1.05 4.07,1.75 3.69,2.36 3.30,2.96 2.74,3.41 2.18,3.86 1.51,4.11 0.83,4.36 0.11,4.38 -0.60,4.40 -1.28,4.18 -1.97,3.97 -2.55,3.55 -3.14,3.13 -3.14,3.14 -3.14,3.14 -3.47,2.71 -3.80,2.29 -4.02,1.80 -4.24,1.32 -4.33,0.79 -4.43,0.26 -4.40,-0.26 -4.36,-0.80 -4.20,-1.31 -4.04,-1.82 -3.77,-2.28 -3.49,-2.73 -3.11,-3.11 -2.73,-3.49 -2.28,-3.77 -1.82,-4.05 -1.31,-4.20 -0.80,-4.36 -0.26,-4.40 0.26,-4.43 0.79,-4.33 1.32,-4.24 1.80,-4.02 2.29,-3.80 2.71,-3.47 3.14,-3.14 3.14,-3.14 L 3.14,-3.14 Z"></path></g><g transform="translate(859.4734045770017 863.2475746012078) rotate(0 0.00004999999998744897 0.00004999999998744897)" stroke="none"><path fill="#1e1e1e" d="M 3.14,-3.14 Q 3.14,-3.14 3.55,-2.55 3.97,-1.97 4.18,-1.28 4.40,-0.59 4.38,0.11 4.36,0.83 4.11,1.51 3.86,2.18 3.41,2.74 2.96,3.30 2.36,3.69 1.75,4.07 1.05,4.25 0.36,4.42 -0.35,4.36 -1.07,4.30 -1.73,4.02 -2.39,3.74 -2.92,3.26 -3.46,2.78 -3.81,2.15 -4.16,1.53 -4.30,0.82 -4.43,0.11 -4.34,-0.59 -4.24,-1.30 -3.92,-1.94 -3.60,-2.59 -3.09,-3.09 -2.59,-3.60 -1.94,-3.92 -1.30,-4.24 -0.59,-4.34 0.12,-4.43 0.82,-4.30 1.53,-4.16 2.15,-3.81 2.78,-3.46 3.26,-2.92 3.74,-2.39 4.02,-1.73 4.31,-1.07 4.36,-0.35 4.42,0.36 4.25,1.05 4.07,1.75 3.69,2.36 3.30,2.96 2.74,3.41 2.18,3.86 1.51,4.11 0.83,4.36 0.11,4.38 -0.60,4.40 -1.28,4.18 -1.97,3.97 -2.55,3.55 -3.14,3.13 -3.14,3.14 -3.14,3.14 -3.47,2.71 -3.80,2.29 -4.02,1.80 -4.24,1.32 -4.33,0.79 -4.43,0.26 -4.40,-0.26 -4.36,-0.80 -4.20,-1.31 -4.04,-1.82 -3.77,-2.28 -3.49,-2.73 -3.11,-3.11 -2.73,-3.49 -2.28,-3.77 -1.82,-4.05 -1.31,-4.20 -0.80,-4.36 -0.26,-4.40 0.26,-4.43 0.79,-4.33 1.32,-4.24 1.80,-4.02 2.29,-3.80 2.71,-3.47 3.14,-3.14 3.14,-3.14 L 3.14,-3.14 Z"></path></g><g stroke-linecap="round" transform="translate(725.1869081894173 96.3876389905015) rotate(0 247.0490446292502 570.6235148035956)"><path d="M32 0 C128.8 -1.45, 225.99 -1.6, 462.1 0 M462.1 0 C483.56 1.4, 493.7 8.81, 494.1 32 M494.1 32 C498.26 289.43, 498.6 546.02, 494.1 1109.25 M494.1 1109.25 C493.48 1130.8, 484.52 1140.84, 462.1 1141.25 M462.1 1141.25 C293.89 1140.4, 123.3 1141.9, 32 1141.25 M32 1141.25 C12.33 1140.97, 1.16 1130.87, 0 1109.25 M0 1109.25 C1.4 851.86, 1.22 593.46, 0 32 M0 32 C1.61 12.52, 10.33 -0.86, 32 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g></svg></span></span></div></div><div class="MuiGrid-root MuiGrid-item mui-1wxaqej"><span class="MuiTypography-root MuiTypography-caption mui-17cupi8">Final Design</span></div></div></div></div><h2 class="MuiTypography-root MuiTypography-h3 mui-1rzqq5q" id="what-is-expected-at-each-level"><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover mui-pvpazu" href="https://www.hellointerview.com/blog/the-system-design-interview-what-is-expected-at-each-level" target="_blank" rel="noopener noreferrer" style="color: rgb(99, 115, 129); cursor: pointer; font-weight: 600; text-decoration: underline;">What is Expected at Each Level?</a></h2><h3 class="MuiTypography-root MuiTypography-h4 mui-hkpafq" id="mid-level">Mid-level</h3><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">For mid-level candidates, we'll typically spend more time on the high-level design section (aka the low-level design) and less time on the scale section. I expect that they can reason about the right combination of data structures to achieve our latency requirements and that they can problem-solve their way to basic answers about scalability and availability. For example, understanding the need for replication and figuring out the different ways that could be implemented.</div><h3 class="MuiTypography-root MuiTypography-h4 mui-hkpafq" id="senior">Senior</h3><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">For senior candidates, I expect that the low-level design portion is relatively straightforward and that we instead spend most of our time talking about scale. I want to see their ability to weigh tradeoffs and make decisions given the requirements of our system. They should know basic strategies for handling hot reads/writes and be able to talk about things like consistent hashing as if they are second nature.</div><h3 class="MuiTypography-root MuiTypography-h4 mui-hkpafq" id="staff">Staff</h3><div class="MuiTypography-root MuiTypography-body1 mui-1p1f0ag">I don't typically ask this of staff engineers because, by the time you are staff, these concepts likely come naturally, which means it isn't the best question to evaluate a staff engineer.</div></div>
</body>
</html>